(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{158:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n(0),c=n.n(r),a=n(89),i=n(1),s=c.a.createContext();function o(e){var t=e.children,n="";if(window){var r=window.location.pathname;r.endsWith("/")||(r+="/"),r.includes("/admin/")&&(n=r.split("/admin/")[0])}return n+="/admin",console.log("LocationBackend",n),Object(i.jsx)(s.Provider,{value:n,children:Object(i.jsx)(a.BrowserRouter,{basename:n,children:t})})}},468:function(e,t,n){e.exports={resolve:{react:n(0),axios:n(301),formik:n(42),moment:n(114),yup:n(85),"phroper-admin":n(702),"framer-motion":n(72),"react-datepicker":n(305),"react-dom":n(49),"react-router-dom":n(89),"@chakra-ui/react":n(40),"@chakra-ui/icons":n(217),"@emotion/react":n(80),"@emotion/styled":n(313)}}},59:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(16),c=n.n(r),a=n(14),i=n(27),s=n(301),o=n.n(s),u=n(0),l=n(84),j=n(158);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(u.useContext)(l.b),r=Object(u.useContext)(j.a);e=r+e;var s=Object(u.useMemo)((function(){var r=function(){var e=Object(i.a)(c.a.mark((function e(r,i,s,u,l){var j,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j={},u&&"object"==typeof u&&Object.keys(u).forEach((function(e){"boolean"===typeof u[e]?j[e]=u[e]?1:0:null===u[e]?j[e+"_null"]=1:j[e]=u[e]})),e.next=5,o()({method:s,url:r,data:i,params:j,headers:t||(null===n||void 0===n?void 0:n.jwt)?Object(a.a)({Authorization:"Bearer "+(t||(null===n||void 0===n?void 0:n.jwt))},l):Object(a.a)({},l)});case 5:return b=e.sent,e.abrupt("return",b.data);case 9:if(e.prev=9,e.t0=e.catch(0),"401"===e.t0.code&&n.logout(),!e.t0.response||!e.t0.response.data||"object"!==typeof e.t0.response.data){e.next=14;break}throw new Error(e.t0.response.data.message);case 14:throw new Error("Server is not available.");case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n,r,c,a){return e.apply(this,arguments)}}();return{list:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,null,"GET",n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),get:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+n,null,"GET"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,n,"POST"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=Object(i.a)(c.a.mark((function t(n){var a,i=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:null,t.abrupt("return",r(e+"/"+(null==a?n.id:a),n,"PUT"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+("object"===typeof n?n.id:n),null,"DELETE"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),send:function(){var t=Object(i.a)(c.a.mark((function t(n,a){var i,s,o,u=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:"GET",s=u.length>3&&void 0!==u[3]?u[3]:null,o=u.length>4&&void 0!==u[4]?u[4]:{},t.abrupt("return",r(e+"/"+n,a,i,s,o));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),[e,n,t]);return s}},60:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),c=n.n(r).a.createContext()},607:function(e,t,n){},674:function(e,t){},676:function(e,t){},696:function(e,t,n){},697:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(49),i=n.n(a),s=n(84),o=n(345),u=n(452),l=n(222),j=n(223),b=n(346),d=n(89),f=n(60),h=n(339),O=n(303),m=n(59),p=n(82),x=n(1),v=c.a.createContext();function g(e){var t=e.children,n=Object(m.a)("/content-schema/models"),c=Object(p.a)(n.list,null),a=Object(r.useContext)(s.b);Object(r.useEffect)(c.run,[a.user]);var i=c.isLoading||!c.error&&a.user&&!c.result;return Object(x.jsxs)(x.Fragment,{children:[i&&Object(x.jsx)(h.b,{w:"100vw",h:"100vh",children:Object(x.jsx)(O.a,{})}),!i&&Object(x.jsx)(v.Provider,{value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?c.result&&c.result.find((function(t){return t.key===e})):c.result},children:t})]})}function y(e){var t=e.children,n=Object(r.useContext)(s.b),c=Object(r.useContext)(f.a),a=Object(r.useContext)(v)();return Object(x.jsxs)(o.a,{bg:"gray.100",minH:"100vh",w:"100%",overflow:"visible",children:[Object(x.jsxs)(o.a,{position:"fixed",left:0,px:3,w:"250px",top:0,h:"100%",bg:"brand.600",color:"white",overflow:"auto",children:[Object(x.jsx)(o.a,{fontSize:40,mb:6,w:"100%",textAlign:"center",children:Object(x.jsx)(d.Link,{to:"/",children:c.components["Layout::title"]})}),!n.user&&Object(x.jsxs)(u.a,{mb:6,children:[Object(x.jsx)(l.a,{mr:4}),Object(x.jsx)(u.e,{flex:1,alignItems:"flex-start",children:Object(x.jsx)(j.a,{as:d.Link,to:"/login",variant:"link",colorScheme:"white",onClick:n.logout,children:"login"})})]}),n.user&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(u.a,{mb:6,children:[Object(x.jsx)(l.a,{mr:4}),Object(x.jsxs)(u.e,{flex:1,alignItems:"flex-start",children:[Object(x.jsx)(b.a,{fontSize:20,children:n.user.username}),Object(x.jsx)(j.a,{variant:"link",colorScheme:"white",onClick:n.logout,children:"logout"})]})]}),a&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{fontSize:24,mb:2,children:"Content types"}),Object(x.jsx)(u.e,{pl:4,mb:2,alignItems:"flex-start",children:null===a||void 0===a?void 0:a.filter((function(e){return e.visible})).map((function(e){return Object(x.jsx)(d.Link,{to:"/content-type/".concat(e.key),children:e.name},e.key)}))})]}),c.menus&&c.menus.length>0&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{fontSize:24,mb:2,children:"Plugins"}),Object(x.jsx)(u.e,{pl:4,mb:2,alignItems:"flex-start",children:c.menus.map((function(e){return Object(x.jsx)(d.Link,{to:"".concat(e.to),children:e.text},e.to)}))})]})]})]}),Object(x.jsx)(o.a,{ml:250,px:4,children:t})]})}var w=n(347),k=n(349),C=Object(w.a)({colors:{brand:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"}}});function S(e){var t=e.children,n=Object(r.useContext)(f.a).components["Layout::ChakraProvider"]||k.a;return Object(x.jsx)(n,{theme:C,children:t})}var E=n(158),F=n(14),M=n(19),L=n(16),P=n.n(L),D=n(27),A=n(371),T=n(178),Y=n(90),z=n(372),_=n(373),H=n(42),I=n(85);function R(){return Object(x.jsx)(o.a,{pt:"10vh",children:Object(x.jsxs)(A.a,{minH:10,p:0,bgColor:"gray.200",children:[Object(x.jsx)(b.a,{fontSize:32,p:2,bg:"brand.500",color:"white",mb:4,children:"Login"}),Object(x.jsx)(o.a,{p:4,children:Object(x.jsx)(q,{})})]})})}function q(){var e=Object(r.useContext)(s.b),t=Object(M.k)();return Object(x.jsx)(H.Formik,{validationSchema:I.object().shape({username:I.string().required("Username is required"),password:I.string().required("Password is required")}),initialValues:{username:"",password:""},onSubmit:function(){var n=Object(D.a)(P.a.mark((function n(r,c){var a,i;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=c.setErrors,n.prev=1,n.next=4,e.login(r.username,r.password);case 4:for(i=t.location.state;i&&i.redirect&&"/login"===i.redirect.pathname;)i=i.redirect.state;i&&i.redirect?t.push(i.redirect.pathname,i.redirect.state):t.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),a({password:n.t0.message});case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}(),children:Object(x.jsx)(H.Form,{children:Object(x.jsxs)(u.b,{spacing:4,children:[t.location.state&&t.location.state.error&&Object(x.jsxs)(T.a,{status:"error",children:[Object(x.jsx)(T.c,{}),Object(x.jsx)(T.b,{children:t.location.state.error})]}),Object(x.jsxs)(Y.a,{children:[Object(x.jsx)(z.a,{children:"Username"}),Object(x.jsx)(H.Field,{as:_.a,bgColor:"white",type:"text",name:"username"}),Object(x.jsx)(H.ErrorMessage,{name:"username",component:b.a,color:"red"})]}),Object(x.jsxs)(Y.a,{children:[Object(x.jsx)(z.a,{children:"Password"}),Object(x.jsx)(H.Field,{as:_.a,bgColor:"white",type:"password",name:"password"}),Object(x.jsx)(H.ErrorMessage,{name:"password",component:b.a,color:"red"})]}),Object(x.jsx)(o.a,{textAlign:"right",pt:2,children:Object(x.jsx)(H.FormikConsumer,{children:function(e){var t=e.isSubmitting;return Object(x.jsx)(j.a,{isLoading:t,type:"submit",variant:"solid",colorScheme:"brand",children:"Log in"})}})})]})})})}var B=n(399);var V=n(227),W=n(3),J=n(73),N=n(374),U=n(41);function G(e){var t=e.message,n=e.children,r=e.onClick,a=e.acceptText,i=void 0===a?"Ok":a,s=e.cancelText,o=void 0===s?"Cancel":s,l=e.headerText,b=void 0===l?"":l,d=Object(J.a)(e,["message","children","onClick","acceptText","cancelText","headerText"]),f=c.a.useState(!1),h=Object(W.a)(f,2),O=h[0],m=h[1],p=function(){return m(!1)},v=c.a.useRef();return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(j.a,Object(F.a)(Object(F.a)({colorScheme:"brand"},d),{},{onClick:function(){return m(!0)},children:n})),Object(x.jsx)(N.a,{isOpen:O,leastDestructiveRef:v,onClose:p,children:Object(x.jsx)(U.i,{children:Object(x.jsxs)(N.d,{children:[b&&Object(x.jsx)(U.h,{fontSize:"lg",fontWeight:"bold",children:b}),Object(x.jsx)(U.b,{children:t}),Object(x.jsx)(U.g,{children:Object(x.jsxs)(u.a,{w:"100%",justifyContent:"space-between",children:[Object(x.jsx)(j.a,{ref:v,onClick:p,children:o}),Object(x.jsx)(j.a,{colorScheme:"brand",onClick:function(){p(),r&&r.apply(void 0,arguments)},ml:3,children:i})]})})]})})})]})}var K=n(398),Q=n(379);var X=n(305),Z=n.n(X),$=(n(606),n(607),function(e){var t=e.onChange,n=e.isClearable,r=void 0!==n&&n,c=e.showPopperArrow,a=void 0!==c&&c,i=e.value,s=Object(J.a)(e,["onChange","isClearable","showPopperArrow","value"]);return Object(x.jsx)(o.a,{children:Object(x.jsx)(Z.a,Object(F.a)({type:"date",selected:"string"===typeof i?new Date(i):i,onChange:t,isClearable:r,showPopperArrow:a},s))})}),ee={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm",timestamp:"yyyy-MM-dd HH:mm:ss"};var te=Object(H.connect)((function(e){var t=e.formik,n=e.schema,r=e.name,c=e.value;return Object(x.jsx)($,{name:r,onChange:function(e){return t.setFieldValue(r,e)},timeFormat:"HH:mm",dateFormat:ee[n.type],showTimeSelect:"date"!==n.type,value:c})})),ne=n(20),re=n(390),ce=n(391),ae=n(392),ie=n(389);function se(e){var t=e.schema,n=e.isCreating,c=e.prefix;t=Object(r.useMemo)((function(){return t&&c?Object(F.a)(Object(F.a)({},t),{},{key:"".concat(c,".").concat(t.key)}):t}),[t,c]);var a=Object(r.useMemo)((function(){var e={};return Object.keys(t.fields).forEach((function(n){e[n]=c?Object(F.a)(Object(F.a)({},t.fields[n]),{},{key:"".concat(c,".").concat(t.fields[n].key)}):t.fields[n]})),e}),[t,c]);console.log("EmbeddedEditor",a);var i=t.grid||se.grid;return Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(".concat(Math.min(2,i[0]),", 1fr)"),"2xl":"repeat(".concat(Math.min(3,i[0]),", 1fr)")},flex:1,gap:6,mb:6,children:Object.keys(a).map((function(e){return Object(x.jsx)(oe,{schema:a[e],isCreating:n},e)}))})}function oe(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=me[e.schema.type])&&void 0!==t?t:me.default;return n?Object(x.jsx)(n,Object(F.a)({},e)):null}function ue(e){var t=e.formik,n=e.schema,r=(e.onChange,e.isCreating);console.log("EmbeddedSchemaArray",n);var c=n.key,a=t.values[c];return a=Array.isArray(a)?a:[],Object(x.jsxs)(o.a,{pl:3,borderLeft:"1px solid",borderColor:"brand.500",children:[Object(x.jsx)(ie.a,{allowToggle:!0,children:a.map((function(e,i){return Object(x.jsxs)(ie.d,{children:[Object(x.jsx)("h2",{children:Object(x.jsxs)(ie.b,{children:[Object(x.jsxs)(u.a,{w:"100%",justify:"space-between",children:[Object(x.jsx)(o.a,{flex:"1",textAlign:"left",children:n.display&&e&&"object"===typeof e?e[n.display]:i+1}),Object(x.jsxs)(o.a,{mr:2,children:[Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ne.a)(a.slice(0,i-1)),[a[i],a[i-1]],Object(ne.a)(a.slice(i+1))))},colorScheme:"brand",variant:"ghost",disabled:0===i,children:Object(x.jsx)(re.a,{})}),Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ne.a)(a.slice(0,i)),Object(ne.a)(a.slice(i+1))))},colorScheme:"brand",variant:"ghost",children:Object(x.jsx)(ce.a,{})}),Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ne.a)(a.slice(0,i)),[a[i+1],a[i]],Object(ne.a)(a.slice(i+2))))},colorScheme:"brand",variant:"ghost",disabled:i===a.length-1,children:Object(x.jsx)(ae.a,{})})]})]}),Object(x.jsx)(ie.c,{})]})}),Object(x.jsx)(ie.e,{pb:4,children:Object(x.jsx)(se,{schema:n,isCreating:r,prefix:"".concat(n.key,"[").concat(i,"]")})})]},i)}))}),Object(x.jsx)(j.a,{w:"100%",colorScheme:"brand",variant:"ghost",fontSize:"3xl",onClick:function(){return t.setFieldValue("".concat(c,"[").concat(a.length,"]"),null)},children:"+"})]})}function le(e){var t=e.schema,n=e.isCreating;return Object(x.jsx)(o.a,{pl:3,flex:1,borderLeft:"1px solid",borderColor:"brand.500",children:Object(x.jsx)(se,{schema:t,isCreating:n,prefix:t.key})})}se.grid=[3,1],ue.grid=se.grid,le.grid=se.grid;var je=n(393);var be=n(395),de=n(396);function fe(e){var t=e.name,n=e.value,c=e.onChange,a=Object(r.useState)(!1),i=Object(W.a)(a,2),s=i[0],u=i[1],l=Object(m.a)("/../api/file-upload"),b=Object(p.a)();Object(r.useEffect)((function(){var e=n&&"object"==typeof n?n.id:n;e?b.run(l.get(e)):b.setResult(null)}),[n]);var d=Object(r.useCallback)(function(){var e=Object(D.a)(P.a.mark((function e(n){var r,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),n.preventDefault(),u(!1),!n.dataTransfer.items||1!==n.dataTransfer.items.length||"file"!==n.dataTransfer.items[0].kind){e.next=10;break}return(r=new FormData).append("file",n.dataTransfer.files[0]),e.next=8,b.run(l.send("upload",r,"POST",{"Content-Type":"multipart/form-data"}));case 8:a=e.sent,c&&c({target:{value:a.id,name:t}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[u,t,c,b,l]);return Object(x.jsx)(be.a,{bg:"gray.800",borderRadius:4,overflow:"hidden",borderColor:"gray.500",ratio:16/9,children:Object(x.jsxs)(o.a,{children:[b.result&&b.result.filename&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",children:Object(x.jsx)(de.a,{src:b.result.filename})}),Object(x.jsx)(H.ErrorMessage,{name:t,children:function(e){return Object(x.jsx)(o.a,{w:"100%",h:"100%",bg:"brand.800",color:"white",p:4,children:e,position:"absolute"})}}),b.isLoading&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",children:Object(x.jsx)(O.a,{size:"lg",color:"white"})}),s&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",bg:s?"#88888866":null,children:Object(x.jsx)(re.a,{color:"white",fontSize:100})}),Object(x.jsx)(o.a,{w:"100%",h:"100%",onDragOver:function(e){e.preventDefault(),u(!0)},onDragLeave:function(){return u(!1)},onDrop:d,position:"absolute",display:"flex",flexDir:"row-reverse",children:n&&Object(x.jsx)(o.b,{size:"1.75em",m:1.5,overflow:"hidden",children:Object(x.jsx)(j.a,{colorScheme:"brand",onClick:function(){return c&&c({target:{value:null,name:t}})},children:Object(x.jsx)(ce.a,{})})})})]})})}fe.grid=[1,2];var he=n(397);function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(H.connect)((function(n){var r=n.schema,c=n.isCreating,a=Object(J.a)(n,["schema","isCreating"]),i=c?r.auto:r.readonly;if(r.auto&&r.readonly)return null;var s=r.grid&&(Array.isArray(r.grid)?r.grid:[r.grid,1])||e&&e.grid||[1,1];return e&&Object(x.jsx)(V.b,{colSpan:{sm:1,lg:Math.min(2,s[0]),"2xl":Math.min(3,s[0])},rowSpan:{sm:1,lg:Math.min(2,s[1]),"2xl":Math.min(3,s[1])},h:"100%",children:Object(x.jsxs)(Y.a,{minW:"20%",h:"100%",display:"flex",flexDir:"column",children:[Object(x.jsx)(z.a,{children:r.name}),Object(x.jsx)(H.Field,Object(F.a)(Object(F.a)({as:e,name:r.key,placeholder:r.name,disabled:i,schema:r,required:!i&&r.required&&(!r.private||c)},a),t||{}))]})})}))}var me={default:Oe(_.a),email:Oe(_.a,{type:"email"}),password:Oe(_.a,{type:"password"}),textarea:Oe(K.a,{resize:"none"}),bool:Oe((function(e){var t=e.formik,n=e.name,r=Object(J.a)(e,["formik","name"]);return console.log("renderbool"),Object(x.jsx)(Q.a,Object(F.a)(Object(F.a)({size:"lg",colorScheme:"brand"},r),{},{log:console.log(t),isChecked:t.values&&t.values[n],onChange:function(){return t.setFieldValue(n,!(t.values&&t.values[n]))}}))})),enum:Oe((function(e){var t=e.schema,n=(e.placeholder,Object(J.a)(e,["schema","placeholder"]));return Object(x.jsx)(je.b,Object(F.a)(Object(F.a)({},n),{},{children:t.values.map((function(e){return Object(x.jsx)("option",{value:e,children:e})}))}))})),relation_one:Oe((function(e){var t=e.schema,n=(e.placeholder,e.value),c=Object(J.a)(e,["schema","placeholder","value"]),a=Object(r.useContext)(v),i=Object(r.useMemo)((function(){return a(t.model)}),[a,t]),s=Object(p.a)(Object(m.a)("/content-manager/".concat(t.model).concat(n?"?".concat(i.primary,"_sort=").concat(n):"")).list);Object(r.useEffect)(s.run,[t]),n&&"object"===typeof n&&(n=n[t.primary]);var o=s.result,u=Object(r.useMemo)((function(){return i&&o&&Array.isArray(o)&&o.map((function(e){return Object(x.jsx)("option",{value:e[i.primary],children:e[i.display]},e[i.primary])}))}),[i,o]);return s.isLoading?Object(x.jsx)(he.a,{h:8}):Object(x.jsxs)(je.b,Object(F.a)(Object(F.a)({value:n||""},c),{},{children:[Object(x.jsx)("option",{value:"",children:"-"}),u]}))})),relation_many:!1,file:Oe(fe),file_multi:Oe((function(e){var t=e.formik,n=e.schema,r=(e.onChange,n.key);console.log(t);var c=t.values[r];return c=Array.isArray(c)?c:[],Object(x.jsx)(Y.a,{minW:"20%",children:Object(x.jsx)(ie.a,{allowMultiple:!0,children:Object(x.jsxs)(ie.d,{children:[Object(x.jsx)("h2",{children:Object(x.jsx)(ie.b,{children:Object(x.jsx)(ie.c,{})})}),Object(x.jsxs)(ie.e,{pb:4,children:[Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:c.map((function(e,n){return Object(x.jsx)(fe,{value:e,name:"".concat(r,"[").concat(n,"]"),onChange:function(e){return t.setFieldValue(e.target.name,e.target.value)}},n)}))}),Object(x.jsx)(j.a,{onClick:function(){return t.setFieldValue("".concat(r,"[").concat(c.length,"]"),null)},children:"New"})]})]})})})})),embedded_object:Oe(le),embedded_array:Oe(ue),date:Oe(te),datetime:Oe(te),timestamp:Oe(te)};function pe(e){var t=e.schema,n=e.isCreating,r=e.contentHandler,c=e.contentApi,a=e.id,i=Object(M.k)();return Object(x.jsxs)(u.e,{p:4,bg:"white",flex:1,alignItems:"stretch",children:[Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:Object.keys(t.fields).map((function(e){return Object(x.jsx)(xe,{schema:t.fields[e],isCreating:n},e)}))}),Object(x.jsxs)(u.a,{w:"100%",justifyContent:"space-between",children:[!n&&Object(x.jsx)(G,{type:"button",colorScheme:"brand",headerText:"Deleting",message:"Are you sure? This action can not be undone!",onClick:function(){return r.run(Object(D.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.delete(a);case 2:i.goBack();case 3:case"end":return e.stop()}}),e)}))))},children:"Delete"}),Object(x.jsx)(j.a,{type:"submit",colorScheme:"green",children:"Save"})]})]})}function xe(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=me[e.schema.type])&&void 0!==t?t:me.default;return n?Object(x.jsx)(n,Object(F.a)({},e)):null}var ve=n(114),ge=n.n(ve);function ye(e){var t=e.schema;return Object(x.jsxs)(o.a,{minW:"350px",p:4,bg:"white",children:[Object(x.jsx)(b.a,{fontWeight:"bold",fontSize:20,children:"Information"}),Object.keys(t.fields).map((function(e){return Object(x.jsx)(we,{schema:t.fields[e],name:t.fields[e].key},e)}))]})}var we=Object(H.connect)((function(e){var t=e.name,n=(e.value,e.formik),r=e.schema,c=Object(J.a)(e,["name","value","formik","schema"]),a=n.values&&n.values[t];return r.auto&&r.readonly&&!1!==r.visible?Object(x.jsxs)(Y.a,{children:[Object(x.jsx)(z.a,{children:r.name}),Object(x.jsx)(b.a,Object(F.a)(Object(F.a)({},c),{},{children:a&&"date"===r.type?ge()(new Date(a)).format("YYYY-MM-DD"):a&&"datetime"===r.type||a&&"timestamp"===r.type?ge()(new Date(a)).format("YYYY-MM-DD HH:mm:ss"):a&&"object"===typeof a?a[r.model_display]:null!=a?a:"-"}))]}):null}));function ke(e){var t=e.isCreating,n=e.schema,c=Object(M.k)(),a=Object(M.m)(),i=a.model,s=a.id,l=Object(r.useContext)(f.a),d=Object(m.a)("/content-manager/".concat(i)),h=Object(p.a)((function(){return d.get(s)}),{});Object(r.useEffect)((function(){t||h.run()}),[t,s]);var O=Object(B.c)();Object(r.useEffect)((function(){h.error&&(O({title:"Server error",description:h.error,status:"error",duration:9e3,isClosable:!0}),h.setError(null))}),[h.error,h.resetError,O]);var v={isCreating:t,history:c,schema:n,id:s,model:i,toast:O,contentHandler:h,contentApi:d};return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(o.a,{children:[Object(x.jsx)(b.a,{fontSize:40,mb:4,children:h.result&&!t?"".concat(h.result[n.display]," (").concat(n.name,")"):n.name}),Object(x.jsx)(Ce,Object(F.a)(Object(F.a)({},v),{},{children:Object(x.jsxs)(u.e,{flex:1,alignItems:"stretch",children:[Object(x.jsx)(u.a,{mb:4,children:Object(x.jsx)(j.a,{colorScheme:"brand",onClick:function(){return c.goBack()},variant:"link",children:"Back"})}),Object.keys(l.components).filter((function(e){return e.startsWith("EditorAddon::")&&l.components[e]&&l.components[e].pos_before})).map((function(e){var t=l.components[e];return Object(x.jsx)(t,Object(F.a)({},v),e)})),Object(x.jsxs)(u.b,{direction:{sm:"column",xl:"row"},alignItems:{base:"stretch"},children:[Object(x.jsx)(pe,Object(F.a)({},v)),!t&&Object(x.jsx)(ye,Object(F.a)({},v))]}),Object.keys(l.components).filter((function(e){return e.startsWith("EditorAddon::")&&l.components[e]&&!l.components[e].pos_before})).map((function(e){var t=l.components[e];return Object(x.jsx)(t,Object(F.a)({},v),e)}))]})}))]})})}function Ce(e){var t=e.children,n=e.isCreating,c=e.schema,a=e.id,i=e.contentHandler,s=e.contentApi,o=Object(M.k)(),u=Object(r.useMemo)((function(){var e={};return Object.values(c.fields).forEach((function(t){null==t.default||t.auto||(e[t.key]=t.default)})),e}),[c]),l=function(e){if(!e)return null;var t={};return Object.keys(e.fields).forEach((function(n){var r=null;switch(e.fields[n].type){case"file_multi":r=I.array(I.lazy((function(e){switch(typeof e){case"object":return I.object({id:I.number().required()});default:return I.number().required()}})))}r&&(t[n]=r)})),I.object(t)}(c);return Object(x.jsx)(H.Formik,{initialValues:n?u:i.result,enableReinitialize:!0,validationSchema:l,onSubmit:function(){var e=Object(D.a)(P.a.mark((function e(t){var r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.run(n?s.create(t):s.update(t,a));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:n&&o.replace("./"+r[c.primary]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:(n||!i.isLoading)&&Object(x.jsx)(H.Form,{children:t})},i.result&&i.result[c.primary])}var Se=n(404),Ee=n(402),Fe=n(403),Me=n(401);function Le(e){var t=e.page,n=e.max,r=e.onSelect,c=e.colorScheme;t=parseInt(t);var a=n<10?n:10,i=t-a/2<0?0:t+a/2>n?n-a:t-a/2;return 1===n&&1===t?null:Object(x.jsxs)(u.a,{mx:"auto",justifyContent:"center",w:"100%",children:[Object(x.jsx)(Me.a,{colorScheme:c,icon:Object(x.jsx)(Ee.a,{}),variant:"ghost",onClick:function(){return r(1)},disabled:t<=1}),Array.apply(null,Array(a)).map((function(e,n){return Object(x.jsx)(j.a,{colorScheme:c,variant:n+i+1===t?"solid":"ghost",onClick:function(){return r(n+i+1)},children:n+i+1},n)})),Object(x.jsx)(Me.a,{colorScheme:c,icon:Object(x.jsx)(Fe.a,{}),variant:"ghost",onClick:function(){return r(n)},disabled:t>=n})]})}var Pe={timestamp:function(e){return e?ge()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},datetime:function(e){return e?ge()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},date:function(e){return e?ge()(new Date(e)).format("YYYY-MM-DD"):"-"},password:!1,relation_many:!1,file:!1,json:!1,bool:function(e){return e?"true":"false"},default:function(e,t){return e&&"object"===typeof e&&t.display?null!=e[t.display]?String(e[t.display]):"-":null==e?"-":String(e)},embedded_array:!1,file_multi:!1,relation_multi:!1};function De(e){var t=e.schema,n=Object(M.m)().model,c=Object(M.k)(),a=new URLSearchParams(c.location.search).get("page")||1,i=Object(m.a)("/content-manager/".concat(n)),s=Object(r.useState)(0),l=Object(W.a)(s,2),d=l[0],h=l[1],O=Object(p.a)(i.list,[]),v=Object(r.useContext)(f.a);Object(r.useEffect)((function(){Object(D.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.runError(O.runStatus(i.get("count")));case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:h(t),O.run(i.list({_limit:100,_start:100*(a-1)}));case 7:case"end":return e.stop()}}),e)})))()}),[a,t]);var g={model:n,history:c,page:a,contentApi:i,contentHandler:O,plugins:v},y=Object(r.useMemo)((function(){return t&&t.listing&&Array.isArray(t.listing)?t.listing:t&&t.listing?[t.listing]:Object.keys(t.fields).filter((function(e){return!1!==Pe[t.fields[e].type]&&!t.fields[e].private&&t.fields[e].visible&&t.fields[e].listed}))}),[t]);return Object(x.jsxs)(o.a,{children:[Object(x.jsx)(b.a,{fontSize:40,mb:4,children:t.name}),Object(x.jsxs)(he.a,{isLoaded:!O.isLoading,children:[Object.keys(v.components).filter((function(e){return e.startsWith("ListAddon::")&&v.components[e]&&v.components[e].pos_before})).map((function(e){var t=v.components[e];return Object(x.jsx)(t,Object(F.a)({},g),e)})),Object(x.jsx)(Le,{page:a,max:Math.ceil(d/100)||1,colorScheme:"brand",onSelect:function(e){return c.push("?page="+e)}}),Object(x.jsx)(u.a,{mb:6,children:t.editable&&Object(x.jsx)(j.a,{colorScheme:"brand","aria-label":"Search database",onClick:function(){return c.push(c.location.pathname+"/create")},variant:"link",children:"New"})}),Object(x.jsxs)(Se.a,{mb:6,children:[Object(x.jsx)(Se.g,{children:Object(x.jsx)(Se.h,{children:y.map((function(e){return Object(x.jsx)(Se.f,{children:e},e)}))})}),Object(x.jsx)(Se.c,{children:O.result&&O.result.map((function(e,n){return Object(x.jsx)(Se.h,{onClick:function(){return t.editable&&c.push(c.location.pathname+"/"+e[t.primary])},children:y.map((function(n){return Object(x.jsx)(Se.d,{children:t.fields[n]&&(Pe[t.fields[n].type]||Pe.default)(e[n],t.fields[n])},n)}))},e[t.primary]||n)}))})]}),Object(x.jsx)(Le,{page:a,max:Math.ceil(d/100)||1,colorScheme:"brand",onSelect:function(e){return c.push("?page="+e)}}),Object.keys(v.components).filter((function(e){return e.startsWith("ListAddon::")&&v.components[e]&&!v.components[e].pos_before})).map((function(e){var t=v.components[e];return Object(x.jsx)(t,Object(F.a)({},g),e)}))]})]})}function Ae(e){var t=e.match,n=Object(M.m)().model,c=Object(r.useContext)(v),a=Object(r.useMemo)((function(){return c(n)}),[c,n]);return a&&Object(x.jsxs)(M.g,{children:[Object(x.jsx)(M.d,{path:"".concat(t.path,"/create"),children:Object(x.jsx)(ke,{isCreating:!0,schema:a},a.key)}),Object(x.jsx)(M.d,{path:"".concat(t.path,"/:id"),children:Object(x.jsx)(ke,{isCreating:!1,schema:a},a.key)}),Object(x.jsx)(M.d,{path:t.path,exact:!0,children:Object(x.jsx)(De,{schema:a},a.key)})]})}function Te(){var e=Object(r.useContext)(s.b),t=Object(r.useContext)(f.a);return Object(x.jsxs)(M.g,{children:[Object(x.jsx)(M.d,{path:"/login",component:R}),Object(x.jsx)(M.d,{path:"/content-type/:model",component:Ae}),Object(x.jsx)(x.Fragment,{children:t.routes.map((function(e,t){return Object(r.createElement)(M.d,Object(F.a)(Object(F.a)({},e),{},{key:e.path}))}))}),!e.user&&Object(x.jsx)(M.d,{children:Object(x.jsx)(M.c,{to:"/login"})})]})}var Ye=n(9),ze=n(325),_e=n(468),He={components:{"Layout::title":"Phroper","Layout::ChakraProvider":null}},Ie=Object(ze.createRequires)(_e.resolve),Re=Object(ze.createRemoteComponent)({requires:Ie});function qe(e){var t=e.children,n=Object(r.useState)(null),a=Object(W.a)(n,2),i=a[0],s=a[1],u=Object(r.useState)([He]),l=Object(W.a)(u,2),j=l[0],b=l[1],d=Object(m.a)("/plugin-handler");Object(r.useEffect)((function(){d.list().then((function(e){return s(e)})).catch((function(e){return s([])}))}),[]);var h=Object(r.useContext)(E.a),O=Object(r.useCallback)((function(e){return b((function(t){return[].concat(Object(ne.a)(t),[e])}))}),[b]),p=Object(r.useCallback)((function(e){return b((function(t){return t.filter((function(t){return t!==e}))}))}),[b]),v=Object(r.useMemo)((function(){var e=[],t=[],n={};return j.forEach((function(r){r.routes&&r.routes.forEach((function(t){return e.push(t)})),r.menus&&r.menus.forEach((function(e){return t.push(e)})),r.components&&Object.keys(r.components).forEach((function(e){return n[e]=r.components[e]}))})),{routes:e,menus:t,components:n,registerPlugin:O,unregisterPlugin:p,pluginIds:i}}),[j,O,i,p]),g=Object(r.useState)(null),y=Object(W.a)(g,2),w=y[0],k=y[1],C=Object(r.useState)({}),S=Object(W.a)(C,2),M=S[0],L=S[1],P=i&&i.reduce((function(e,t){return e&&M[t]}),!0),D=Object(r.useMemo)((function(){return i&&i.map((function(e){return Object(x.jsx)(Re,{url:h+"/plugin-handler/"+e,render:function(t){var n=t.err,r=t.Component;return n?(console.error("Plugin loading error",e,n),setTimeout((function(){k((function(t){return Object(F.a)(Object(F.a)({},t||{}),{},Object(Ye.a)({},e,n))}))}),0),null):(setTimeout((function(){L((function(t){return t[e]?t:Object(F.a)(Object(F.a)({},t),{},Object(Ye.a)({},e,!0))}))}),0),Object(x.jsx)(r,{id:e}))}},e)}))}),[i,h]);return Object(x.jsxs)(f.a.Provider,{value:v,children:[Object(x.jsx)(o.a,{display:"none",children:D}),w&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h1",{children:"Plugin loading errors"}),Object.keys(w).map((function(e){return Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsxs)("h2",{children:["[",e,"]"]}),Object(x.jsx)("pre",{children:w[e].stack})]},e)}))]}),P&&!w&&t]})}var Be=function(){return Object(x.jsx)(E.b,{children:Object(x.jsx)(qe,{children:Object(x.jsx)(S,{children:Object(x.jsx)(s.a,{children:Object(x.jsx)(g,{children:Object(x.jsx)(y,{children:Object(x.jsx)(Te,{})})})})})})})},Ve=(n(696),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,710)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))});i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(Be,{})}),document.getElementById("root")),Ve()},702:function(e,t,n){"use strict";n.r(t),n.d(t,"PluginContext",(function(){return a.a})),n.d(t,"usePluginRegister",(function(){return s})),n.d(t,"useRequest",(function(){return r.a})),n.d(t,"useRequestRunner",(function(){return c.a}));var r=n(59),c=n(82),a=n(60),i=n(0);function s(e){var t=Object(i.useContext)(a.a),n=t.registerPlugin,r=t.unregisterPlugin;Object(i.useEffect)((function(){return n(e),function(){return r(e)}}),[e,n,r])}},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(16),c=n.n(r),a=n(14),i=n(27),s=n(3),o=n(0);function u(e){var t=Object(o.useState)(e),n=Object(s.a)(t,2),r=n[0],c=n[1],a=Object(o.useRef)(!1),i=Object(o.useCallback)((function(e){a.current&&c(e)}),[c,a]);return Object(o.useEffect)((function(){return a.current=!0,function(){a.current=!1}}),[a]),[r,i]}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=u({error:null,result:t,isLoading:!1,isSuccess:!1}),r=Object(s.a)(n,2),l=r[0],j=r[1],b=Object(o.useCallback)(Object(i.a)(c.a.mark((function e(){var t,n=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,"function"!==typeof t){e.next=6;break}return e.next=5,t();case 5:t=e.sent;case 6:if(!(t instanceof Promise)){e.next=10;break}return e.next=9,t;case 9:t=e.sent;case 10:return e.abrupt("return",t);case 13:return e.prev=13,e.t0=e.catch(1),j((function(t){return Object(a.a)(Object(a.a)({},t),{},{error:e.t0.message})})),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),[j]),d=Object(o.useCallback)(Object(i.a)(c.a.mark((function e(){var t,n,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:null,e.prev=1,n=null,"function"!==typeof t){e.next=9;break}return e.next=6,t();case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t;case 11:n=e.sent;case 12:return j((function(e){return Object(a.a)(Object(a.a)({},e),{},{result:n})})),e.abrupt("return",n);case 16:throw e.prev=16,e.t0=e.catch(1),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),[j]),f=Object(o.useRef)(null),h=Object(o.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t instanceof Promise?t:Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),f.current=n,e.prev=2,j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!0,isSuccess:!1})})),e.next=6,n;case 6:return r=e.sent,j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,isSuccess:!0})})),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(2),f.current===n&&(f.current=null),j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,isSuccess:!1})})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),[j,f]),O=Object(o.useCallback)(Object(i.a)(c.a.mark((function t(){var n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=r.length>0&&void 0!==r[0]?r[0]:null)&&(n=e),t.abrupt("return",b((function(){return h((function(){return d(n)}))})));case 3:case"end":return t.stop()}}),t)}))),[e,d,b,h]);return{isLoading:l.isLoading,result:l.result,error:l.error,isSuccess:l.isSuccess,isDisplayable:!l.isLoading&&!l.error,run:O,runError:b,runResult:d,runStatus:h,setError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return j((function(t){return Object(a.a)(Object(a.a)({},t),{},{error:e instanceof Error?e.message:e})}))},setResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return j((function(t){return Object(a.a)(Object(a.a)({},t),{},{result:e})}))}}}},84:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(16),c=n.n(r),a=n(27),i=n(3),s=n(0),o=n.n(s),u=n(14),l=function(e,t){var n=Object(s.useMemo)((function(){var n=t;try{localStorage.getItem(e)?n=JSON.parse(localStorage.getItem(e)):localStorage.setItem(e,JSON.stringify(t))}catch(r){localStorage.setItem(e,JSON.stringify(t))}return n}),[]),r=Object(s.useState)({isInitialized:!0,value:n}),c=Object(i.a)(r,2),a=c[0],o=c[1];return[a.value,function(t){Object.is(a.value,t)||(t="function"===typeof t?t(a.value):t,localStorage.setItem(e,JSON.stringify(t)),o(Object(u.a)(Object(u.a)({},a),{},{value:t})))}]},j=n(59),b=n(1),d=o.a.createContext({});function f(e){var t=e.children,n=l("auth-state",{user:null,jwt:null}),r=Object(i.a)(n,2),o=r[0],u=r[1],f=Object(j.a)("/../api/auth",o.jwt),h=Object(s.useCallback)((function(){u({user:null,jwt:null})}),[u]),O=function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(),e.next=3,f.send("login",{username:t,password:n},"POST");case 3:r=e.sent,u({user:r.user,jwt:r.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(),e.next=3,f.send("register",{username:t.username,password:t.password,name:t.name,email:t.email},"POST");case 3:n=e.sent,u({user:n.user,jwt:n.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(d.Provider,{value:{user:o.user,jwt:o.jwt,login:O,logout:h,register:m},children:t})}}},[[697,1,2]]]);
//# sourceMappingURL=main.e841cb2a.chunk.js.map