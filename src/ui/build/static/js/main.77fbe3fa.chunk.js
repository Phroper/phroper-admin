(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{238:function(e,t,n){e.exports={resolve:{react:n(0),axios:n(299),formik:n(42),moment:n(108),yup:n(81),"phroper-admin":n(699),"framer-motion":n(70),"react-datepicker":n(302),"react-dom":n(49),"react-router-dom":n(89),"@chakra-ui/react":n(40),"@chakra-ui/icons":n(214),"@emotion/react":n(78),"@emotion/styled":n(311)}}},504:function(e,t,n){},612:function(e,t){},614:function(e,t){},692:function(e,t,n){},693:function(e,t,n){},694:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(49),i=n.n(a),s=n(394),o=n(16),u=n.n(o),l=n(27),j=n(3),d=n(14),b=function(e,t){var n=Object(r.useMemo)((function(){var n=t;try{localStorage.getItem(e)?n=JSON.parse(localStorage.getItem(e)):localStorage.setItem(e,JSON.stringify(t))}catch(r){localStorage.setItem(e,JSON.stringify(t))}return n}),[]),c=Object(r.useState)({isInitialized:!0,value:n}),a=Object(j.a)(c,2),i=a[0],s=a[1];return[i.value,function(t){Object.is(i.value,t)||(t="function"===typeof t?t(i.value):t,localStorage.setItem(e,JSON.stringify(t)),s(Object(d.a)(Object(d.a)({},i),{},{value:t})))}]},f=n(299),h=n.n(f),m=n(89),O=n(1),p=c.a.createContext();function x(e){var t=e.children,n="";if(window){var r=window.location.pathname;r.endsWith("/")||(r+="/"),r.includes("/admin/")&&(n=r.split("/admin/")[0])}return n+="/admin",console.log("LocationBackend",n),Object(O.jsx)(p.Provider,{value:n,children:Object(O.jsx)(m.BrowserRouter,{basename:n,children:t})})}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(r.useContext)(g),c=Object(r.useContext)(p);e=c+e;var a=Object(r.useMemo)((function(){var r=function(){var e=Object(l.a)(u.a.mark((function e(r,c,a,i){var s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h()({method:a,url:r,data:c,headers:t||(null===n||void 0===n?void 0:n.jwt)?Object(d.a)({Authorization:"Bearer "+(t||(null===n||void 0===n?void 0:n.jwt))},i):Object(d.a)({},i)});case 3:return s=e.sent,e.abrupt("return",s.data);case 7:if(e.prev=7,e.t0=e.catch(0),"401"===e.t0.code&&n.logout(),!e.t0.response||!e.t0.response.data||"object"!==typeof e.t0.response.data){e.next=12;break}throw new Error(e.t0.response.data.message);case 12:throw new Error("Server is not available.");case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r,c){return e.apply(this,arguments)}}();return{list:function(){var t=Object(l.a)(u.a.mark((function t(){var n,c=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>0&&void 0!==c[0]?c[0]:null,t.abrupt("return",r(e+(n?"?page=".concat(n):""),null,"GET"));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),get:function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+n,null,"GET"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,n,"POST"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=Object(l.a)(u.a.mark((function t(n){var c,a=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=a.length>1&&void 0!==a[1]?a[1]:null,t.abrupt("return",r(e+"/"+(null==c?n.id:c),n,"PUT"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+("object"===typeof n?n.id:n),null,"DELETE"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),send:function(){var t=Object(l.a)(u.a.mark((function t(n,c){var a,i,s=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:"GET",i=s.length>3&&void 0!==s[3]?s[3]:{},t.abrupt("return",r(e+"/"+n,c,a,i));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),[e,n,t]);return a}var g=c.a.createContext({});function y(e){var t=e.children,n=b("auth-state",{user:null,jwt:null}),c=Object(j.a)(n,2),a=c[0],i=c[1],s=v("/../api/auth",a.jwt),o=Object(r.useCallback)((function(){i({user:null,jwt:null})}),[i]),d=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.next=3,s.send("login",{username:t,password:n},"POST");case 3:r=e.sent,i({user:r.user,jwt:r.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.next=3,s.send("register",{username:t.username,password:t.password,name:t.name,email:t.email},"POST");case 3:n=e.sent,i({user:n.user,jwt:n.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsx)(g.Provider,{value:{user:a.user,jwt:a.jwt,login:d,logout:o,register:f},children:t})}var w=n(336),k=n(301),C=n(342),S=n(455),E=n(219),M=n(343),D=n(220),F=n(90);function P(e){var t=Object(r.useState)(e),n=Object(j.a)(t,2),c=n[0],a=n[1],i=Object(r.useRef)(!1),s=Object(r.useCallback)((function(e){i.current&&a(e)}),[a,i]);return Object(r.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[i]),[c,s]}function L(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=P({error:null,result:t,isLoading:!1,isSuccess:!1}),c=Object(j.a)(n,2),a=c[0],i=c[1],s=Object(r.useCallback)(Object(l.a)(u.a.mark((function e(){var t,n=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,"function"!==typeof t){e.next=6;break}return e.next=5,t();case 5:t=e.sent;case 6:if(!(t instanceof Promise)){e.next=10;break}return e.next=9,t;case 9:t=e.sent;case 10:return console.log("error",t),e.abrupt("return",t);case 14:return e.prev=14,e.t0=e.catch(1),i((function(t){return Object(d.a)(Object(d.a)({},t),{},{error:e.t0.message})})),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[1,14]])}))),[i]),o=Object(r.useCallback)(Object(l.a)(u.a.mark((function e(){var t,n,r=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:null,e.prev=1,n=null,"function"!==typeof t){e.next=9;break}return e.next=6,t();case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t;case 11:n=e.sent;case 12:return i((function(e){return Object(d.a)(Object(d.a)({},e),{},{result:n})})),e.abrupt("return",n);case 16:throw e.prev=16,e.t0=e.catch(1),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),[i]),b=Object(r.useRef)(null),f=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=t instanceof Promise?t:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),b.current=n,e.prev=3,i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!0,isSuccess:!1})})),e.next=7,n;case 7:return r=e.sent,i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!1,isSuccess:!0})})),console.log("error",r),e.abrupt("return",r);case 13:throw e.prev=13,e.t0=e.catch(3),b.current===n&&(b.current=null),i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!1,isSuccess:!1})})),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),[i,b]),h=Object(r.useCallback)(Object(l.a)(u.a.mark((function t(){var n,r=arguments;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=r.length>0&&void 0!==r[0]?r[0]:null)&&(n=e),t.abrupt("return",s((function(){return f((function(){return o(n)}))})));case 3:case"end":return t.stop()}}),t)}))),[e,o,s,f]);return{isLoading:a.isLoading,result:a.result,error:a.error,isSuccess:a.isSuccess,isDisplayable:!a.isLoading&&!a.error,run:h,runError:s,runResult:o,runStatus:f,setError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(d.a)(Object(d.a)({},t),{},{error:e instanceof Error?e.message:e})}))},setResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(d.a)(Object(d.a)({},t),{},{result:e})}))}}}function T(e){var t,n=e.children,c=L(v("/content-schema/models").list),a=Object(r.useContext)(g),i=Object(r.useContext)(F.a);return Object(r.useEffect)(c.run,[a.user]),Object(O.jsxs)(O.Fragment,{children:[c.isLoading&&Object(O.jsx)(w.b,{w:"100vw",h:"100vh",children:Object(O.jsx)(k.a,{})}),Object(O.jsxs)(C.a,{bg:"gray.100",minH:"100vh",w:"100%",overflow:"visible",children:[Object(O.jsxs)(C.a,{position:"fixed",left:0,px:3,w:"250px",top:0,minH:"100%",bg:"red.600",color:"white",children:[Object(O.jsx)(C.a,{fontSize:40,mb:6,w:"100%",textAlign:"center",children:Object(O.jsx)(m.Link,{to:"/",children:"Phroper"})}),a.user&&Object(O.jsxs)(S.a,{mb:6,children:[Object(O.jsx)(E.a,{mr:4}),Object(O.jsxs)(S.e,{flex:1,alignItems:"flex-start",children:[Object(O.jsx)(M.a,{fontSize:20,children:a.user.username}),Object(O.jsx)(D.a,{variant:"link",colorScheme:"white",onClick:a.logout,children:"logout"})]})]}),c.isSuccess&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(M.a,{fontSize:24,mb:2,children:"Content types"}),Object(O.jsx)(S.e,{pl:4,mb:2,alignItems:"flex-start",children:null===(t=c.result)||void 0===t?void 0:t.filter((function(e){return e.visible})).map((function(e){return Object(O.jsx)(m.Link,{to:"/content-type/".concat(e.key),children:e.name},e.key)}))})]}),i.menus&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(M.a,{fontSize:24,mb:2,children:"Plugins"}),Object(O.jsx)(S.e,{pl:4,mb:2,alignItems:"flex-start",children:i.menus.map((function(e){return Object(O.jsx)(m.Link,{to:"".concat(e.to),children:e.text},e.to)}))})]})]}),Object(O.jsx)(C.a,{ml:250,px:4,children:n})]})]})}n(504);var A=n(19),Y=n(365),z=n(175),H=n(85),R=n(366),I=n(367),_=n(42),q=n(81);function V(){return Object(O.jsx)(C.a,{pt:"10vh",children:Object(O.jsxs)(Y.a,{minH:10,p:0,bgColor:"gray.200",children:[Object(O.jsx)(M.a,{fontSize:32,p:2,bg:"red.500",color:"white",mb:4,children:"Login"}),Object(O.jsx)(C.a,{p:4,children:Object(O.jsx)(B,{})})]})})}function B(){var e=Object(r.useContext)(g),t=Object(A.k)();return Object(O.jsx)(_.Formik,{validationSchema:q.object().shape({username:q.string().required("Username is required"),password:q.string().required("Password is required")}),initialValues:{username:"",password:""},onSubmit:function(){var n=Object(l.a)(u.a.mark((function n(r,c){var a,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=c.setErrors,n.prev=1,n.next=4,e.login(r.username,r.password);case 4:for(i=t.location.state;i&&i.redirect&&"/login"===i.redirect.pathname;)i=i.redirect.state;i&&i.redirect?t.push(i.redirect.pathname,i.redirect.state):t.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),a({password:n.t0.message});case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}(),children:Object(O.jsx)(_.Form,{children:Object(O.jsxs)(S.b,{spacing:4,children:[t.location.state&&t.location.state.error&&Object(O.jsxs)(z.a,{status:"error",children:[Object(O.jsx)(z.c,{}),Object(O.jsx)(z.b,{children:t.location.state.error})]}),Object(O.jsxs)(H.a,{children:[Object(O.jsx)(R.a,{children:"Username"}),Object(O.jsx)(_.Field,{as:I.a,bgColor:"white",type:"text",name:"username"}),Object(O.jsx)(_.ErrorMessage,{name:"username",component:M.a,color:"red"})]}),Object(O.jsxs)(H.a,{children:[Object(O.jsx)(R.a,{children:"Password"}),Object(O.jsx)(_.Field,{as:I.a,bgColor:"white",type:"password",name:"password"}),Object(O.jsx)(_.ErrorMessage,{name:"password",component:M.a,color:"red"})]}),Object(O.jsx)(C.a,{textAlign:"right",pt:2,children:Object(O.jsx)(_.FormikConsumer,{children:function(e){var t=e.isSubmitting;return Object(O.jsx)(D.a,{isLoading:t,type:"submit",variant:"solid",colorScheme:"red",children:"Log in"})}})})]})})})}var J=n(171),N=n(238),W=Object(J.createRequires)(N.resolve);Object(J.createRemoteComponent)({requires:W});function U(){return null}var G=c.a.createContext();function K(e){var t=e.children,n=L(v("/content-schema/models").list,null),c=Object(r.useContext)(g);return Object(r.useEffect)(n.run,[c.user]),Object(O.jsxs)(O.Fragment,{children:[n.isLoading&&Object(O.jsx)(w.b,{w:"100vw",h:"100vh",children:Object(O.jsx)(k.a,{})}),!n.isLoading&&Object(O.jsx)(G.Provider,{value:function(e){return n.result&&n.result.find((function(t){return t.key===e}))},children:t})]})}var Q=n(430);var X=n(224),Z=n(71),$=n(419),ee=n(41);function te(e){var t=e.message,n=e.children,r=e.onClick,a=e.acceptText,i=void 0===a?"Ok":a,s=e.cancelText,o=void 0===s?"Cancel":s,u=e.headerText,l=void 0===u?"":u,b=Object(Z.a)(e,["message","children","onClick","acceptText","cancelText","headerText"]),f=c.a.useState(!1),h=Object(j.a)(f,2),m=h[0],p=h[1],x=function(){return p(!1)},v=c.a.useRef();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(D.a,Object(d.a)(Object(d.a)({colorScheme:"red"},b),{},{onClick:function(){return p(!0)},children:n})),Object(O.jsx)($.a,{isOpen:m,leastDestructiveRef:v,onClose:x,children:Object(O.jsx)(ee.i,{children:Object(O.jsxs)($.d,{children:[l&&Object(O.jsx)(ee.h,{fontSize:"lg",fontWeight:"bold",children:l}),Object(O.jsx)(ee.b,{children:t}),Object(O.jsx)(ee.g,{children:Object(O.jsxs)(S.a,{w:"100%",justifyContent:"space-between",children:[Object(O.jsx)(D.a,{ref:v,onClick:x,children:o}),Object(O.jsx)(D.a,{colorScheme:"red",onClick:function(){x(),r&&r.apply(void 0,arguments)},ml:3,children:i})]})})]})})})]})}var ne=n(428),re=n(426);var ce=n(302),ae=n.n(ce),ie=(n(691),n(692),function(e){var t=e.onChange,n=e.isClearable,r=void 0!==n&&n,c=e.showPopperArrow,a=void 0!==c&&c,i=e.value,s=Object(Z.a)(e,["onChange","isClearable","showPopperArrow","value"]);return Object(O.jsx)(C.a,{children:Object(O.jsx)(ae.a,Object(d.a)({type:"date",selected:"string"===typeof i?new Date(i):i,onChange:t,isClearable:r,showPopperArrow:a},s))})}),se={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm",timestamp:"yyyy-MM-dd HH:mm:ss"};var oe=Object(_.connect)((function(e){var t=e.formik,n=e.schema,r=e.name,c=e.value;return Object(O.jsx)(ie,{name:r,onChange:function(e){return t.setFieldValue(r,e)},timeFormat:"HH:mm",dateFormat:se[n.type],showTimeSelect:"date"!==n.type,value:c})})),ue=n(20),le=n(433),je=n(432),de=n(434),be=n(398);function fe(e){var t=e.schema,n=e.isCreating,c=e.prefix;t=Object(r.useMemo)((function(){return t&&c?Object(d.a)(Object(d.a)({},t),{},{key:"".concat(c,".").concat(t.key)}):t}),[t,c]);var a=Object(r.useMemo)((function(){var e={};return Object.keys(t.fields).forEach((function(n){e[n]=c?Object(d.a)(Object(d.a)({},t.fields[n]),{},{key:"".concat(c,".").concat(t.fields[n].key)}):t.fields[n]})),e}),[t,c]);console.log("EmbeddedEditor",a);var i=t.grid||fe.grid;return Object(O.jsx)(X.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(".concat(Math.min(2,i[0]),", 1fr)"),"2xl":"repeat(".concat(Math.min(3,i[0]),", 1fr)")},flex:1,gap:6,mb:6,children:Object.keys(a).map((function(e){return Object(O.jsx)(he,{schema:a[e],isCreating:n},e)}))})}function he(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=ke[e.schema.type])&&void 0!==t?t:ke.default;return n?Object(O.jsx)(n,Object(d.a)({},e)):null}function me(e){var t=e.formik,n=e.schema,r=(e.onChange,e.isCreating);console.log("EmbeddedSchemaArray",n);var c=n.key,a=t.values[c];return a=Array.isArray(a)?a:[],Object(O.jsxs)(C.a,{pl:3,borderLeft:"1px solid",borderColor:"red.500",children:[Object(O.jsx)(be.a,{allowToggle:!0,children:a.map((function(e,i){return Object(O.jsxs)(be.d,{children:[Object(O.jsx)("h2",{children:Object(O.jsxs)(be.b,{children:[Object(O.jsxs)(S.a,{w:"100%",justify:"space-between",children:[Object(O.jsx)(C.a,{flex:"1",textAlign:"left",children:n.display&&e&&"object"===typeof e?e[n.display]:i+1}),Object(O.jsxs)(C.a,{mr:2,children:[Object(O.jsx)(D.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ue.a)(a.slice(0,i-1)),[a[i],a[i-1]],Object(ue.a)(a.slice(i+1))))},colorScheme:"red",variant:"ghost",disabled:0===i,children:Object(O.jsx)(le.a,{})}),Object(O.jsx)(D.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ue.a)(a.slice(0,i)),Object(ue.a)(a.slice(i+1))))},colorScheme:"red",variant:"ghost",children:Object(O.jsx)(je.a,{})}),Object(O.jsx)(D.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ue.a)(a.slice(0,i)),[a[i+1],a[i]],Object(ue.a)(a.slice(i+2))))},colorScheme:"red",variant:"ghost",disabled:i===a.length-1,children:Object(O.jsx)(de.a,{})})]})]}),Object(O.jsx)(be.c,{})]})}),Object(O.jsx)(be.e,{pb:4,children:Object(O.jsx)(fe,{schema:n,isCreating:r,prefix:"".concat(n.key,"[").concat(i,"]")})})]},i)}))}),Object(O.jsx)(D.a,{w:"100%",colorScheme:"red",variant:"ghost",fontSize:"3xl",onClick:function(){return t.setFieldValue("".concat(c,"[").concat(a.length,"]"),null)},children:"+"})]})}function Oe(e){var t=e.schema,n=e.isCreating;return Object(O.jsx)(C.a,{pl:3,flex:1,borderLeft:"1px solid",borderColor:"red.500",children:Object(O.jsx)(fe,{schema:t,isCreating:n,prefix:t.key})})}fe.grid=[3,1],me.grid=fe.grid,Oe.grid=fe.grid;var pe=n(422);var xe=n(411),ve=n(410);function ge(e){var t=e.name,n=e.value,c=e.onChange,a=Object(r.useState)(!1),i=Object(j.a)(a,2),s=i[0],o=i[1],d=v("/../api/file-upload"),b=L();Object(r.useEffect)((function(){var e=n&&"object"==typeof n?n.id:n;e?b.run(d.get(e)):b.setResult(null)}),[n]);var f=Object(r.useCallback)(function(){var e=Object(l.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),n.preventDefault(),o(!1),!n.dataTransfer.items||1!==n.dataTransfer.items.length||"file"!==n.dataTransfer.items[0].kind){e.next=10;break}return(r=new FormData).append("file",n.dataTransfer.files[0]),e.next=8,b.run(d.send("upload",r,"POST",{"Content-Type":"multipart/form-data"}));case 8:a=e.sent,c&&c({target:{value:a.id,name:t}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,t,c,b,d]);return Object(O.jsx)(xe.a,{bg:"gray.800",borderRadius:4,overflow:"hidden",borderColor:"gray.500",ratio:16/9,children:Object(O.jsxs)(C.a,{children:[b.result&&b.result.filename&&Object(O.jsx)(w.b,{position:"absolute",h:"100%",w:"100%",children:Object(O.jsx)(ve.a,{src:b.result.filename})}),Object(O.jsx)(_.ErrorMessage,{name:t,children:function(e){return Object(O.jsx)(C.a,{w:"100%",h:"100%",bg:"red.800",color:"white",p:4,children:e,position:"absolute"})}}),b.isLoading&&Object(O.jsx)(w.b,{position:"absolute",h:"100%",w:"100%",children:Object(O.jsx)(k.a,{size:"lg",color:"white"})}),s&&Object(O.jsx)(w.b,{position:"absolute",h:"100%",w:"100%",bg:s?"#88888866":null,children:Object(O.jsx)(le.a,{color:"white",fontSize:100})}),Object(O.jsx)(C.a,{w:"100%",h:"100%",onDragOver:function(e){e.preventDefault(),o(!0)},onDragLeave:function(){return o(!1)},onDrop:f,position:"absolute",display:"flex",flexDir:"row-reverse",children:n&&Object(O.jsx)(C.b,{size:"1.75em",m:1.5,overflow:"hidden",children:Object(O.jsx)(D.a,{colorScheme:"red",onClick:function(){return c&&c({target:{value:null,name:t}})},children:Object(O.jsx)(je.a,{})})})})]})})}ge.grid=[1,2];var ye=n(424);function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(_.connect)((function(n){var r=n.schema,c=n.isCreating,a=Object(Z.a)(n,["schema","isCreating"]),i=c?r.auto:r.readonly;if(r.auto&&r.readonly)return null;var s=r.grid&&(Array.isArray(r.grid)?r.grid:[r.grid,1])||e&&e.grid||[1,1];return e&&Object(O.jsx)(X.b,{colSpan:{sm:1,lg:Math.min(2,s[0]),"2xl":Math.min(3,s[0])},rowSpan:{sm:1,lg:Math.min(2,s[1]),"2xl":Math.min(3,s[1])},h:"100%",children:Object(O.jsxs)(H.a,{minW:"20%",h:"100%",display:"flex",flexDir:"column",children:[Object(O.jsx)(R.a,{children:r.name}),Object(O.jsx)(_.Field,Object(d.a)(Object(d.a)({as:e,name:r.key,placeholder:r.name,disabled:i,schema:r,required:!i&&r.required&&(!r.private||c)},a),t||{}))]})})}))}var ke={default:we(I.a),email:we(I.a,{type:"email"}),password:we(I.a,{type:"password"}),textarea:we(ne.a,{resize:"none"}),bool:we((function(e){var t=e.formik,n=e.name,r=Object(Z.a)(e,["formik","name"]);return console.log("renderbool"),Object(O.jsx)(re.a,Object(d.a)(Object(d.a)({size:"lg",colorScheme:"red"},r),{},{log:console.log(t),isChecked:t.values&&t.values[n],onChange:function(){return t.setFieldValue(n,!(t.values&&t.values[n]))}}))})),enum:we((function(e){var t=e.schema,n=(e.placeholder,Object(Z.a)(e,["schema","placeholder"]));return Object(O.jsx)(pe.b,Object(d.a)(Object(d.a)({},n),{},{children:t.values.map((function(e){return Object(O.jsx)("option",{value:e,children:e})}))}))})),relation_one:we((function(e){var t=e.schema,n=(e.placeholder,e.value),c=Object(Z.a)(e,["schema","placeholder","value"]),a=Object(r.useContext)(G),i=Object(r.useMemo)((function(){return a(t.model)}),[a,t]),s=L(v("/content-manager/".concat(t.model).concat(n?"?".concat(i.primary,"_sort=").concat(n):"")).list);Object(r.useEffect)(s.run,[t]),n&&"object"===typeof n&&(n=n[t.primary]);var o=s.result,u=Object(r.useMemo)((function(){return i&&o&&Array.isArray(o)&&o.map((function(e){return Object(O.jsx)("option",{value:e[i.primary],children:e[i.display]},e[i.primary])}))}),[i,o]);return s.isLoading?Object(O.jsx)(ye.a,{h:8}):Object(O.jsxs)(pe.b,Object(d.a)(Object(d.a)({value:n||""},c),{},{children:[Object(O.jsx)("option",{value:"",children:"-"}),u]}))})),relation_many:!1,file:we(ge),file_multi:we((function(e){var t=e.formik,n=e.schema,r=(e.onChange,n.key);console.log(t);var c=t.values[r];return c=Array.isArray(c)?c:[],Object(O.jsx)(H.a,{minW:"20%",children:Object(O.jsx)(be.a,{allowMultiple:!0,children:Object(O.jsxs)(be.d,{children:[Object(O.jsx)("h2",{children:Object(O.jsx)(be.b,{children:Object(O.jsx)(be.c,{})})}),Object(O.jsxs)(be.e,{pb:4,children:[Object(O.jsx)(X.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:c.map((function(e,n){return Object(O.jsx)(ge,{value:e,name:"".concat(r,"[").concat(n,"]"),onChange:function(e){return t.setFieldValue(e.target.name,e.target.value)}},n)}))}),Object(O.jsx)(D.a,{onClick:function(){return t.setFieldValue("".concat(r,"[").concat(c.length,"]"),null)},children:"New"})]})]})})})})),embedded_object:we(Oe),embedded_array:we(me),date:we(oe),datetime:we(oe),timestamp:we(oe)};function Ce(e){var t=e.schema,n=e.isCreating,r=e.contentHandler,c=e.contentApi,a=e.id,i=Object(A.k)();return Object(O.jsxs)(C.a,{p:4,bg:"white",flex:1,children:[Object(O.jsx)(X.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:Object.keys(t.fields).map((function(e){return Object(O.jsx)(Se,{schema:t.fields[e],isCreating:n},e)}))}),Object(O.jsxs)(S.a,{w:"100%",justifyContent:"space-between",children:[!n&&Object(O.jsx)(te,{type:"button",colorScheme:"red",headerText:"Deleting",message:"Are you sure? This action can not be undone!",onClick:function(){return r.run(Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.delete(a);case 2:i.goBack();case 3:case"end":return e.stop()}}),e)}))))},children:"Delete"}),Object(O.jsx)(D.a,{type:"submit",colorScheme:"green",children:"Save"})]})]})}function Se(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=ke[e.schema.type])&&void 0!==t?t:ke.default;return n?Object(O.jsx)(n,Object(d.a)({},e)):null}var Ee=n(108),Me=n.n(Ee);function De(e){var t=e.schema;return Object(O.jsxs)(C.a,{minW:"350px",p:4,bg:"white",children:[Object(O.jsx)(M.a,{fontWeight:"bold",fontSize:20,children:"Information"}),Object.keys(t.fields).map((function(e){return Object(O.jsx)(Fe,{schema:t.fields[e],name:t.fields[e].key},e)}))]})}var Fe=Object(_.connect)((function(e){var t=e.name,n=(e.value,e.formik),r=e.schema,c=Object(Z.a)(e,["name","value","formik","schema"]),a=n.values&&n.values[t];return r.auto&&r.readonly&&!1!==r.visible?Object(O.jsxs)(H.a,{children:[Object(O.jsx)(R.a,{children:r.name}),Object(O.jsx)(M.a,Object(d.a)(Object(d.a)({},c),{},{children:a&&"date"===r.type?Me()(new Date(a)).format("YYYY-MM-DD"):a&&"datetime"===r.type||a&&"timestamp"===r.type?Me()(new Date(a)).format("YYYY-MM-DD HH:mm:ss"):a&&"object"===typeof a?a[r.model_display]:null!=a?a:"-"}))]}):null}));function Pe(e){var t=e.isCreating,n=e.schema,c=Object(A.m)(),a=c.model,i=c.id,s=Object(A.k)(),o=v("/content-manager/".concat(a)),u=Object(Q.c)(),l=L((function(){return o.get(i)}),[]);Object(r.useEffect)((function(){l.error&&(u({title:"Server error",description:l.error,status:"error",duration:9e3,isClosable:!0}),l.setError(null))}),[l.error,l.resetError,u]),Object(r.useEffect)((function(){t||l.run()}),[t,i]);var j={isCreating:t,history:s,schema:n,id:i,contentHandler:l,contentApi:o};return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(C.a,{children:[Object(O.jsx)(M.a,{fontSize:40,mb:4,children:l.result&&!t?"".concat(l.result[n.display]," (").concat(n.name,")"):n.name}),Object(O.jsxs)(Le,Object(d.a)(Object(d.a)({},j),{},{children:[Object(O.jsx)(S.a,{mb:6,children:Object(O.jsx)(D.a,{colorScheme:"red",onClick:function(){return s.goBack()},variant:"link",children:"Back"})}),Object(O.jsxs)(S.b,{flex:1,direction:{sm:"column",xl:"row"},alignItems:{sm:"stretch",xl:"flex-start"},children:[Object(O.jsx)(Ce,Object(d.a)({},j)),!t&&Object(O.jsx)(De,Object(d.a)({},j))]})]}))]})})}function Le(e){var t=e.children,n=e.isCreating,c=e.schema,a=e.id,i=e.contentHandler,s=e.contentApi,o=Object(A.k)(),j=Object(r.useMemo)((function(){var e={};return Object.values(c.fields).forEach((function(t){null==t.default||t.auto||(e[t.key]=t.default)})),e}),[c]),d=function(e){if(!e)return null;var t={};return Object.keys(e.fields).forEach((function(n){var r=null;switch(e.fields[n].type){case"file_multi":r=q.array(q.lazy((function(e){switch(typeof e){case"object":return q.object({id:q.number().required()});default:return q.number().required()}})))}r&&(t[n]=r)})),q.object(t)}(c);return Object(O.jsx)(_.Formik,{initialValues:n?j:i.result,enableReinitialize:!0,validationSchema:d,onSubmit:function(){var e=Object(l.a)(u.a.mark((function e(t){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.run(n?s.create(t):s.update(t,a));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:n&&o.replace("./"+r[c.primary]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:(n||!i.isLoading)&&Object(O.jsx)(_.Form,{children:t})},i.result&&i.result[c.primary])}var Te=n(414),Ae=n(436),Ye=n(435),ze=n(400);function He(e){var t=e.page,n=e.max,r=e.onSelect,c=e.colorScheme;t=parseInt(t);var a=n<10?n:10,i=t-a/2<0?0:t+a/2>n?n-a:t-a/2;return 1===n&&1===t?null:Object(O.jsxs)(S.a,{mx:"auto",justifyContent:"center",w:"100%",children:[Object(O.jsx)(ze.a,{colorScheme:c,icon:Object(O.jsx)(Ae.a,{}),variant:"ghost",onClick:function(){return r(1)},disabled:t<=1}),Array.apply(null,Array(a)).map((function(e,n){return Object(O.jsx)(D.a,{colorScheme:c,variant:n+i+1===t?"solid":"ghost",onClick:function(){return r(n+i+1)},children:n+i+1},n)})),Object(O.jsx)(ze.a,{colorScheme:c,icon:Object(O.jsx)(Ye.a,{}),variant:"ghost",onClick:function(){return r(n)},disabled:t>=n})]})}var Re={timestamp:function(e){return e?Me()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},datetime:function(e){return e?Me()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},date:function(e){return e?Me()(new Date(e)).format("YYYY-MM-DD"):"-"},password:!1,relation_many:!1,file:!1,json:!1,bool:function(e){return e?"true":"false"},default:function(e,t){return e&&"object"===typeof e&&t.display?null!=e[t.display]?String(e[t.display]):"-":null==e?"-":String(e)},embedded_array:!1,file_multi:!1,relation_multi:!1};function Ie(e){var t=e.schema,n=Object(A.m)().model,c=Object(A.k)(),a=new URLSearchParams(c.location.search).get("page")||1,i=v("/content-manager/".concat(n)),s=Object(r.useState)(0),o=Object(j.a)(s,2),d=o[0],b=o[1],f=L(i.list,[]);Object(r.useEffect)((function(){Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.runError(f.runStatus(i.get("count")));case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:b(t),f.run(i.send("?_limit=100&_start=".concat(100*(a-1))));case 7:case"end":return e.stop()}}),e)})))()}),[a,t]);var h=Object(r.useMemo)((function(){return t&&t.listing&&Array.isArray(t.listing)?t.listing:t&&t.listing?[t.listing]:Object.keys(t.fields).filter((function(e){return!1!==Re[t.fields[e].type]&&!t.fields[e].private&&t.fields[e].visible&&t.fields[e].listed}))}),[t]);return Object(O.jsxs)(C.a,{children:[Object(O.jsx)(M.a,{fontSize:40,mb:4,children:t.name}),Object(O.jsxs)(ye.a,{isLoaded:!f.isLoading,children:[Object(O.jsx)(He,{page:a,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return c.push("?page="+e)}}),Object(O.jsx)(S.a,{mb:6,children:t.editable&&Object(O.jsx)(D.a,{colorScheme:"red","aria-label":"Search database",onClick:function(){return c.push(c.location.pathname+"/create")},variant:"link",children:"New"})}),Object(O.jsxs)(Te.a,{mb:6,children:[Object(O.jsx)(Te.g,{children:Object(O.jsx)(Te.h,{children:h.map((function(e){return Object(O.jsx)(Te.f,{children:e},e)}))})}),Object(O.jsx)(Te.c,{children:f.result&&f.result.map((function(e,n){return Object(O.jsx)(Te.h,{onClick:function(){return t.editable&&c.push(c.location.pathname+"/"+e[t.primary])},children:h.map((function(n){return Object(O.jsx)(Te.d,{children:t.fields[n]&&(Re[t.fields[n].type]||Re.default)(e[n],t.fields[n])},n)}))},e[t.primary]||n)}))})]}),Object(O.jsx)(He,{page:a,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return c.push("?page="+e)}})]})]})}function _e(e){var t=e.match,n=Object(A.m)().model,c=Object(r.useContext)(G),a=Object(r.useMemo)((function(){return c(n)}),[c,n]);return a&&Object(O.jsxs)(A.g,{children:[Object(O.jsx)(A.d,{path:"".concat(t.path,"/create"),children:Object(O.jsx)(Pe,{isCreating:!0,schema:a},a.key)}),Object(O.jsx)(A.d,{path:"".concat(t.path,"/:id"),children:Object(O.jsx)(Pe,{isCreating:!1,schema:a},a.key)}),Object(O.jsx)(A.d,{path:t.path,exact:!0,children:Object(O.jsx)(Ie,{schema:a},a.key)})]})}function qe(){var e=Object(r.useContext)(g),t=Object(r.useContext)(F.a);return Object(O.jsxs)(A.g,{children:[Object(O.jsx)(A.d,{exact:!0,path:"/",component:U}),Object(O.jsx)(A.d,{path:"/login",component:V}),!e.user&&Object(O.jsx)(A.d,{children:Object(O.jsx)(A.c,{to:"/login"})}),Object(O.jsx)(A.d,{path:"/content-type/:model",component:_e}),Object(O.jsx)(O.Fragment,{children:t.routes.map((function(e,t){return Object(r.createElement)(A.d,Object(d.a)(Object(d.a)({},e),{},{key:e.path}))}))})]})}var Ve=Object(J.createRequires)(N.resolve),Be=Object(J.createRemoteComponent)({requires:Ve});function Je(e){var t=e.children,n=Object(r.useState)([]),c=Object(j.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)([]),o=Object(j.a)(s,2),u=o[0],l=o[1];console.log(a);var d=v("/plugin-handler");Object(r.useEffect)((function(){d.list().then((function(e){return i(e)})).catch((function(e){}))}),[]);var b=Object(r.useContext)(p),f=Object(r.useCallback)((function(e){return l((function(t){return[].concat(Object(ue.a)(t),[e])}))}),[l]),h=Object(r.useCallback)((function(e){return l((function(t){return t.filter((function(t){return t!==e}))}))}),[l]),m=Object(r.useMemo)((function(){var e=[],t=[],n={};return u.forEach((function(r){r.routes&&r.routes.forEach((function(t){return e.push(t)})),r.menus&&r.menus.forEach((function(e){return t.push(e)})),r.components&&Object.keys(r.components).forEach((function(e){return n[e]=r.components[e]}))})),{routes:e,menus:t,components:n,registerPlugin:f,unregisterPlugin:h}}),[u,f,h]);return Object(O.jsxs)(F.a.Provider,{value:m,children:[Object(O.jsx)(C.a,{display:"none",children:a.map((function(e){return Object(O.jsx)(Be,{url:b+"/plugin-handler/"+e,id:e},e)}))}),t]})}var Ne=function(){return Object(O.jsx)(x,{children:Object(O.jsx)(Je,{children:Object(O.jsx)(s.a,{children:Object(O.jsx)(y,{children:Object(O.jsx)(K,{children:Object(O.jsx)(T,{children:Object(O.jsx)(qe,{})})})})})})})},We=(n(693),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,707)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))});i.a.render(Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(Ne,{})}),document.getElementById("root")),We()},699:function(e,t,n){"use strict";n.r(t),n.d(t,"PluginContext",(function(){return r.a})),n.d(t,"usePluginRegister",(function(){return a}));var r=n(90),c=n(0);function a(e){var t=Object(c.useContext)(r.a),n=t.registerPlugin,a=t.unregisterPlugin;console.log("register plugin",e),Object(c.useEffect)((function(){return n(e),function(){return a(e)}}),[e,n,a])}},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),c=n.n(r).a.createContext()}},[[694,1,2]]]);
//# sourceMappingURL=main.77fbe3fa.chunk.js.map