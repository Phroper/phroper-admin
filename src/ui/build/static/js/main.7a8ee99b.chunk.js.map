{"version":3,"sources":["app/LocationBackend.js","components/AlertButton.js","remote-component.config.js","utils/useRequest.js","app/plugin-system/PluginContext.js","app/SchemaBackend.js","layout/index.js","app/ChakraProvider.js","pages/Login.js","components/EntryEditor/Fields/DatePickerBase/index.js","components/EntryEditor/Fields/DatePicker.js","components/EntryEditor/Fields/EmbeddedEditor.js","components/EntryEditor/Fields/EmbeddedArray.js","components/EntryEditor/Fields/EmbeddedObject.js","components/EntryEditor/Fields/FileOne.js","components/EntryEditor/Fields/Json.js","components/EntryEditor/Fields/index.js","components/EntryEditor/Fields/Bool.js","components/EntryEditor/Fields/Enum.js","components/EntryEditor/Fields/RelationOne.js","components/EntryEditor/Fields/FileMulti.js","components/EntryEditor/EditorForm.js","components/EntryEditor/EditorInfo.js","components/EntryEditor/index.js","utils/GenerateYup.js","components/Pagination.js","components/ListEntries.js","components/ContentType.js","app/PageRouting.js","app/plugin-system/basePlugin.js","app/plugin-system/PluginBackend.js","app/index.js","reportWebVitals.js","index.js","app/plugin-system/usePluginRegister.js","utils/useSafeState.js","utils/useRequestRunner.js","utils/useLocalStorage.js","auth/auth.js"],"names":["LocationContext","React","createContext","LocationBackend","children","basename","window","pn","location","pathname","endsWith","includes","split","console","log","Provider","value","AlertButton","message","onClick","acceptText","cancelText","headerText","props","useState","isOpen","setIsOpen","onClose","cancelRef","useRef","colorScheme","leastDestructiveRef","fontSize","fontWeight","w","justifyContent","ref","ml","module","exports","resolve","react","require","axios","formik","moment","yup","useRequest","apiUrl","jwt","auth","useContext","AuthConext","basePath","handler","useMemo","send","url","body","method","query","headers","a","finalQuery","Object","keys","forEach","k","data","params","Authorization","response","code","logout","Error","list","get","id","create","update","delete","PluginContext","SchemaContext","SchemaBackend","schemaApi","schemaHandler","useRequestRunner","useEffect","run","displayLoading","isLoading","error","user","result","h","key","find","x","Layout","plugins","schemas","bg","minH","minW","position","left","px","top","color","overflow","zIndex","shadow","mb","textAlign","to","components","mr","flex","alignItems","as","Link","variant","username","pl","filter","model","visible","map","name","menus","length","menu","text","theme","extendTheme","colors","brand","50","100","200","300","400","500","600","700","800","900","ChakraProvider","Component","_ChakraProvider","Login","pt","p","bgColor","LoginForm","history","useHistory","validationSchema","shape","required","password","initialValues","onSubmit","setErrors","login","state","redirect","push","spacing","status","Input","type","component","Text","isSubmitting","DatePickerBase","onChange","isClearable","showPopperArrow","selected","Date","dateFormats","date","datetime","timestamp","connect","schema","v","setFieldValue","timeFormat","dateFormat","showTimeSelect","EmbeddedEditor","isCreating","prefix","fields","nf","grid","templateColumns","sm","lg","Math","min","gap","fn","SchemaField","EditComponent","FieldComponentMap","default","EmbeddedArray","values","Array","isArray","expandedIndex","setExpandedIndex","borderLeft","borderColor","allowToggle","index","i","justify","display","e","stopPropagation","slice","disabled","ArrowUp","Delete","ArrowDown","pb","EmbeddedObject","FileOne","dragOver","setDragOver","uploadsApi","uploadHandler","setResult","handleDrag","useCallback","event","preventDefault","dataTransfer","items","kind","formData","FormData","append","files","target","borderRadius","ratio","filename","src","msg","size","onDragOver","onDragLeave","onDrop","flexDir","m","Json","onBlur","onFocus","JSON","stringify","textValue","setTextValue","hasError","setHasError","setValue","timeout","setTimeout","nv","parse","ex","clearTimeout","onValueChange","padding","highlight","languages","json","style","fontFamily","background","transition","preClassName","ConnectSchemaField","addProps","auto","readonly","colSpan","rowSpan","placeholder","private","email","textarea","Textarea","resize","bool","isChecked","enum","relation_one","getSchema","modelSchema","contentHandler","primary","entities","optionList","relation_many","file","file_multi","allowMultiple","embedded_object","embedded_array","DatePicker","EditorForm","contentApi","goBack","EditorInfo","fs","f","InfoField","format","EntryEditor","useParams","toast","useToast","title","description","duration","isClosable","setError","resetError","editorContext","FormikWrapper","py","startsWith","pos_before","direction","xl","base","formikInitialValues","initVals","field","fieldSchema","test","GenerateYup","enableReinitialize","replace","Pagination","page","max","onSelect","parseInt","pagerCount","offset","mx","icon","ArrowLeft","apply","_","ArrowRight","displayFormatter","s","String","relation_multi","ListEntries","URLSearchParams","search","entryCount","setEntryCount","runError","runStatus","count","_limit","_start","listingContext","names","listing","n","listed","isLoaded","editable","aria-label","alignSelf","ceil","ContentType","match","path","exact","PageRouting","routes","r","without_login","render","basePlugin","requires","createRequires","RemoteComponent","createRemoteComponent","PluginBackend","pluginIds","setPluginIds","setPlugins","request","then","catch","registerPlugin","unregisterPlugin","pluginContextValue","plugin","errors","loadedPlugins","setLoadedPlugins","allPluginLoaded","reduce","prev","pluginRender","err","lp","Fragment","stack","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","document","getElementById","usePluginRegister","useSafeState","initialValue","setState","isAttachedRef","setStateSafe","current","defaultRequest","initialResult","isSuccess","Promise","runResult","runningRef","promise","requestFn","isDisplayable","useLocalStorage","_loadedState","localStorage","getItem","setItem","isInitialized","_setState","newState","is","AuthBackend","authState","setAuthState","tokenChecked","setTokenChecked","register"],"mappings":"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","file":"static/js/main.7a8ee99b.chunk.js","sourcesContent":["import React from \"react\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nexport const LocationContext = React.createContext();\n\nexport default function LocationBackend({ children }) {\n  let basename = \"\";\n  if (window) {\n    let pn = window.location.pathname;\n    if (!pn.endsWith(\"/\")) pn = pn + \"/\";\n\n    if (pn.includes(\"/admin/\")) basename = pn.split(\"/admin/\")[0];\n  }\n  basename += \"/admin\";\n\n  console.log(\"LocationBackend\", basename);\n\n  return (\n    <LocationContext.Provider value={basename}>\n      <Router basename={basename}>{children}</Router>\n    </LocationContext.Provider>\n  );\n}\n","import {\n  AlertDialog,\n  AlertDialogBody,\n  AlertDialogContent,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogOverlay,\n  Button,\n  HStack,\n} from \"@chakra-ui/react\";\nimport React from \"react\";\n\n/**\n * Button that displays an AlertDialog on click.\n * Calls onClick function only if dialog is accepted.\n *\n * @param {object} props\n * @param props.message Body of the Alert dialdog\n * @param props.headerText Header content of Alert dialog\n * @param [props.acceptText=\"Ok\"] Content of accept button\n * @param [props.cancelText=\"Cancel\"] Content of cancel button\n * @param {Function} props.onClick Accept callback of dialog\n */\nexport default function AlertButton({\n  message,\n  children,\n  onClick,\n  acceptText = \"Ok\",\n  cancelText = \"Cancel\",\n  headerText = \"\",\n  ...props\n}) {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const onClose = () => setIsOpen(false);\n  const cancelRef = React.useRef();\n\n  return (\n    <>\n      <Button colorScheme=\"brand\" {...props} onClick={() => setIsOpen(true)}>\n        {children}\n      </Button>\n\n      <AlertDialog\n        isOpen={isOpen}\n        leastDestructiveRef={cancelRef}\n        onClose={onClose}\n      >\n        <AlertDialogOverlay>\n          <AlertDialogContent>\n            {headerText && (\n              <AlertDialogHeader fontSize=\"lg\" fontWeight=\"bold\">\n                {headerText}\n              </AlertDialogHeader>\n            )}\n            <AlertDialogBody>{message}</AlertDialogBody>\n            <AlertDialogFooter>\n              <HStack w=\"100%\" justifyContent=\"space-between\">\n                <Button ref={cancelRef} onClick={onClose}>\n                  {cancelText}\n                </Button>\n                <Button\n                  colorScheme=\"brand\"\n                  onClick={(...p) => {\n                    onClose();\n                    if (onClick) onClick(...p);\n                  }}\n                  ml={3}\n                >\n                  {acceptText}\n                </Button>\n              </HStack>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialogOverlay>\n      </AlertDialog>\n    </>\n  );\n}\n","/**\n * Dependencies for Remote Components\n */\nmodule.exports = {\n  resolve: {\n    react: require(\"react\"),\n    axios: require(\"axios\"),\n    formik: require(\"formik\"),\n    moment: require(\"moment\"),\n    yup: require(\"yup\"),\n    \"phroper-admin\": require(\"./app/plugin-system/PluginImports\"),\n    \"framer-motion\": require(\"framer-motion\"),\n    \"react-datepicker\": require(\"react-datepicker\"),\n    \"react-dom\": require(\"react-dom\"),\n    \"react-router-dom\": require(\"react-router-dom\"),\n    \"@chakra-ui/react\": require(\"@chakra-ui/react\"),\n    \"@chakra-ui/icons\": require(\"@chakra-ui/icons\"),\n    \"@emotion/react\": require(\"@emotion/react\"),\n    \"@emotion/styled\": require(\"@emotion/styled\"),\n  },\n};\n","import axios from \"axios\";\nimport { useContext, useMemo } from \"react\";\nimport { AuthConext } from \"../auth/auth\";\nimport { LocationContext } from \"./../app/LocationBackend\";\n\nexport default function useRequest(apiUrl, jwt = null) {\n  const auth = useContext(AuthConext);\n  const basePath = useContext(LocationContext);\n  apiUrl = basePath + apiUrl;\n\n  const handler = useMemo(() => {\n    const send = async (url, body, method, query, headers) => {\n      try {\n        const finalQuery = {};\n        if (query && typeof query == \"object\")\n          Object.keys(query).forEach((k) => {\n            if (typeof query[k] === \"boolean\") finalQuery[k] = query[k] ? 1 : 0;\n            else if (query[k] === null) finalQuery[k + \"_null\"] = 1;\n            else finalQuery[k] = query[k];\n          });\n\n        const response = await axios({\n          method,\n          url,\n          data: body,\n          params: finalQuery,\n          headers:\n            jwt || auth?.jwt\n              ? { Authorization: \"Bearer \" + (jwt || auth?.jwt), ...headers }\n              : { ...headers },\n        });\n        return response.data;\n      } catch (err) {\n        if (err.code === \"401\") {\n          auth.logout();\n        }\n        if (\n          err.response &&\n          err.response.data &&\n          typeof err.response.data === \"object\"\n        ) {\n          throw new Error(err.response.data.message);\n        }\n        throw new Error(\"Server is not available.\");\n      }\n    };\n\n    return {\n      list: async (query) => send(apiUrl, null, \"GET\", query),\n      get: async (id, query) => send(apiUrl + \"/\" + id, null, \"GET\", query),\n      create: async (data) => send(apiUrl, data, \"POST\"),\n      update: async (data, id = null) =>\n        send(apiUrl + \"/\" + (id == null ? data.id : id), data, \"PUT\"),\n      delete: async (id) =>\n        send(\n          apiUrl + \"/\" + (typeof id === \"object\" ? id.id : id),\n          null,\n          \"DELETE\"\n        ),\n      send: async (url, data, method = \"GET\", query = null, headers = {}) =>\n        send(apiUrl + \"/\" + url, data, method, query, headers),\n    };\n  }, [apiUrl, auth, jwt]);\n\n  return handler;\n}\n","import React from \"react\";\n\nexport const PluginContext = React.createContext();\n","import { Center, Spinner } from \"@chakra-ui/react\";\nimport React, { useContext, useEffect } from \"react\";\nimport { AuthConext } from \"./../auth/auth\";\nimport useRequest from \"./../utils/useRequest\";\nimport useRequestRunner from \"./../utils/useRequestRunner\";\n\nexport const SchemaContext = React.createContext();\n\nexport default function SchemaBackend({ children }) {\n  const schemaApi = useRequest(`/content-schema/models`);\n  const schemaHandler = useRequestRunner(schemaApi.list, null);\n  const auth = useContext(AuthConext);\n  //eslint-disable-next-line\n  useEffect(() => auth.jwt && schemaHandler.run(), [auth.jwt]);\n\n  const displayLoading =\n    schemaHandler.isLoading ||\n    (!schemaHandler.error && auth.user && !schemaHandler.result);\n\n  return (\n    <>\n      {displayLoading && (\n        <Center w=\"100vw\" h=\"100vh\">\n          <Spinner></Spinner>\n        </Center>\n      )}\n      {!displayLoading && (\n        <SchemaContext.Provider\n          value={(key = null) =>\n            !key\n              ? schemaHandler.result\n              : schemaHandler.result &&\n                schemaHandler.result.find((x) => x.key === key)\n          }\n        >\n          {children}\n        </SchemaContext.Provider>\n      )}\n    </>\n  );\n}\n","import { Avatar, Box, Button, HStack, Text, VStack } from \"@chakra-ui/react\";\nimport React, { useContext } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { PluginContext } from \"../app/plugin-system/PluginContext\";\nimport { AuthConext } from \"../auth/auth\";\nimport { SchemaContext } from \"./../app/SchemaBackend\";\n\nexport default function Layout({ children }) {\n  const auth = useContext(AuthConext);\n  const plugins = useContext(PluginContext);\n  const schemas = useContext(SchemaContext)();\n\n  return (\n    <Box bg=\"gray.100\" minH=\"100%\" minW=\"100%\" w=\"fit-content\">\n      <Box\n        position=\"fixed\"\n        left={0}\n        px={3}\n        w=\"250px\"\n        top={0}\n        h=\"100%\"\n        bg=\"brand.600\"\n        color=\"white\"\n        overflow=\"auto\"\n        zIndex={100}\n        shadow=\"md\"\n      >\n        <Box fontSize={40} mb={6} w=\"100%\" textAlign=\"center\">\n          <Link to=\"/\">{plugins.components[\"Layout::title\"]}</Link>\n        </Box>\n\n        {!auth.user && (\n          <HStack mb={6}>\n            <Avatar mr={4} />\n            <VStack flex={1} alignItems=\"flex-start\">\n              <Button\n                as={Link}\n                to=\"/login\"\n                variant=\"link\"\n                colorScheme=\"white\"\n                onClick={auth.logout}\n              >\n                login\n              </Button>\n            </VStack>\n          </HStack>\n        )}\n        {auth.user && (\n          <>\n            <HStack mb={6}>\n              <Avatar mr={4} />\n              <VStack flex={1} alignItems=\"flex-start\">\n                <Text fontSize={20}>{auth.user.username}</Text>\n                <Button\n                  variant=\"link\"\n                  colorScheme=\"white\"\n                  onClick={auth.logout}\n                >\n                  logout\n                </Button>\n              </VStack>\n            </HStack>\n\n            {schemas && (\n              <>\n                <Text fontSize={24} mb={2}>\n                  Content types\n                </Text>\n                <VStack pl={4} mb={2} alignItems=\"flex-start\">\n                  {schemas\n                    ?.filter((model) => model.visible)\n                    .map((model) => (\n                      <Link key={model.key} to={`/content-type/${model.key}`}>\n                        {model.name}\n                      </Link>\n                    ))}\n                </VStack>\n              </>\n            )}\n            {plugins.menus && plugins.menus.length > 0 && (\n              <>\n                <Text fontSize={24} mb={2}>\n                  Plugins\n                </Text>\n                <VStack pl={4} mb={2} alignItems=\"flex-start\">\n                  {plugins.menus.map((menu) => (\n                    <Link key={menu.to} to={`${menu.to}`}>\n                      {menu.text}\n                    </Link>\n                  ))}\n                </VStack>\n              </>\n            )}\n          </>\n        )}\n      </Box>\n      <Box ml={250} px={4}>\n        {children}\n      </Box>\n    </Box>\n  );\n}\n","import {\n  ChakraProvider as _ChakraProvider,\n  extendTheme,\n} from \"@chakra-ui/react\";\nimport React, { useContext } from \"react\";\nimport { PluginContext } from \"./plugin-system/PluginContext\";\n\nconst theme = extendTheme({\n  colors: {\n    brand: {\n      50: \"#FFF5F5\",\n      100: \"#FED7D7\",\n      200: \"#FEB2B2\",\n      300: \"#FC8181\",\n      400: \"#F56565\",\n      500: \"#E53E3E\",\n      600: \"#C53030\",\n      700: \"#9B2C2C\",\n      800: \"#822727\",\n      900: \"#63171B\",\n    },\n  },\n});\n\nexport default function ChakraProvider({ children }) {\n  const plugins = useContext(PluginContext);\n  const Component =\n    plugins.components[\"Layout::ChakraProvider\"] || _ChakraProvider;\n  return <Component theme={theme}>{children}</Component>;\n}\n","import {\n  Alert,\n  AlertDescription,\n  AlertIcon,\n  Box,\n  Button,\n  Container,\n  FormControl,\n  FormLabel,\n  Input,\n  Stack,\n  Text,\n} from \"@chakra-ui/react\";\nimport { ErrorMessage, Field, Form, Formik, FormikConsumer } from \"formik\";\nimport React, { useContext } from \"react\";\nimport { useHistory } from \"react-router\";\nimport * as yup from \"yup\";\nimport { AuthConext } from \"../auth/auth\";\n\nexport default function Login() {\n  return (\n    <Box pt=\"10vh\">\n      <Container minH={10} p={0} bgColor=\"gray.200\">\n        <Text fontSize={32} p={2} bg=\"brand.500\" color=\"white\" mb={4}>\n          Login\n        </Text>\n        <Box p={4}>\n          <LoginForm />\n        </Box>\n      </Container>\n    </Box>\n  );\n}\n\nfunction LoginForm() {\n  const auth = useContext(AuthConext);\n  const history = useHistory();\n\n  return (\n    <Formik\n      validationSchema={yup.object().shape({\n        username: yup.string().required(\"Username is required\"),\n        password: yup.string().required(\"Password is required\"),\n      })}\n      initialValues={{\n        username: \"\",\n        password: \"\",\n      }}\n      onSubmit={async (props, { setErrors }) => {\n        try {\n          await auth.login(props.username, props.password);\n\n          let state = history.location.state;\n          while (\n            state &&\n            state.redirect &&\n            state.redirect.pathname === \"/login\"\n          )\n            state = state.redirect.state;\n\n          if (state && state.redirect)\n            history.push(state.redirect.pathname, state.redirect.state);\n          else history.push(\"/\");\n        } catch (err) {\n          setErrors({ password: err.message });\n        }\n      }}\n    >\n      <Form>\n        <Stack spacing={4}>\n          {history.location.state && history.location.state.error && (\n            <Alert status=\"error\">\n              <AlertIcon />\n              <AlertDescription>\n                {history.location.state.error}\n              </AlertDescription>\n            </Alert>\n          )}\n\n          <FormControl>\n            <FormLabel>Username</FormLabel>\n            <Field as={Input} bgColor=\"white\" type=\"text\" name=\"username\" />\n            <ErrorMessage name=\"username\" component={Text} color=\"red\" />\n          </FormControl>\n          <FormControl>\n            <FormLabel>Password</FormLabel>\n            <Field as={Input} bgColor=\"white\" type=\"password\" name=\"password\" />\n            <ErrorMessage name=\"password\" component={Text} color=\"red\" />\n          </FormControl>\n\n          <Box textAlign=\"right\" pt={2}>\n            <FormikConsumer>\n              {({ isSubmitting }) => (\n                <Button\n                  isLoading={isSubmitting}\n                  type=\"submit\"\n                  variant=\"solid\"\n                  colorScheme=\"brand\"\n                  children=\"Log in\"\n                />\n              )}\n            </FormikConsumer>\n          </Box>\n        </Stack>\n      </Form>\n    </Formik>\n  );\n}\n","import { Box } from \"@chakra-ui/react\";\nimport React from \"react\";\nimport ReactDatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport \"./date-picker.css\";\n\nconst DatePickerBase = ({\n  onChange,\n  isClearable = false,\n  showPopperArrow = false,\n  value,\n  ...props\n}) => {\n  return (\n    <Box>\n      <ReactDatePicker\n        type=\"date\"\n        selected={typeof value === \"string\" ? new Date(value) : value}\n        onChange={onChange}\n        isClearable={isClearable}\n        showPopperArrow={showPopperArrow}\n        {...props}\n      />\n    </Box>\n  );\n};\n\nexport default DatePickerBase;\n","import { connect } from \"formik\";\nimport DatePickerBase from \"./DatePickerBase/index\";\n\nconst dateFormats = {\n  date: \"yyyy-MM-dd\",\n  datetime: \"yyyy-MM-dd HH:mm\",\n  timestamp: \"yyyy-MM-dd HH:mm:ss\",\n};\n\nfunction DatePicker({ formik, schema, name, value }) {\n  return (\n    <DatePickerBase\n      name={name}\n      onChange={(v) => formik.setFieldValue(name, v)}\n      timeFormat=\"HH:mm\"\n      dateFormat={dateFormats[schema.type]}\n      showTimeSelect={schema.type !== \"date\"}\n      value={value}\n    />\n  );\n}\n\nexport default connect(DatePicker);\n","import { Grid } from \"@chakra-ui/react\";\nimport React, { useMemo } from \"react\";\nimport { FieldComponentMap } from \".\";\n\nexport default function EmbeddedEditor({ schema, isCreating, prefix }) {\n  schema = useMemo(\n    () =>\n      schema && prefix ? { ...schema, key: `${prefix}.${schema.key}` } : schema,\n    [schema, prefix]\n  );\n\n  const fields = useMemo(() => {\n    const nf = {};\n    Object.keys(schema.fields).forEach((k) => {\n      nf[k] = prefix\n        ? { ...schema.fields[k], key: `${prefix}.${schema.fields[k].key}` }\n        : schema.fields[k];\n    });\n    return nf;\n  }, [schema, prefix]);\n\n  console.log(\"EmbeddedEditor\", fields);\n\n  const grid = schema.grid || EmbeddedEditor.grid;\n\n  return (\n    <Grid\n      templateColumns={{\n        sm: \"repeat(1, 1fr)\",\n        lg: `repeat(${Math.min(2, grid[0])}, 1fr)`,\n        \"2xl\": `repeat(${Math.min(3, grid[0])}, 1fr)`,\n      }}\n      flex={1}\n      gap={6}\n      mb={6}\n    >\n      {Object.keys(fields).map((fn) => (\n        <SchemaField key={fn} schema={fields[fn]} isCreating={isCreating} />\n      ))}\n    </Grid>\n  );\n}\n\nfunction SchemaField(props) {\n  if (props.schema.visible === false) return null;\n  const EditComponent =\n    FieldComponentMap[props.schema.type] ?? FieldComponentMap.default;\n\n  if (EditComponent) return <EditComponent {...props} />;\n  return null;\n}\n\nEmbeddedEditor.grid = [3, 1];\n","import { ArrowDownIcon, ArrowUpIcon, DeleteIcon } from \"@chakra-ui/icons\";\nimport {\n  Accordion,\n  AccordionButton,\n  AccordionIcon,\n  AccordionItem,\n  AccordionPanel,\n  Box,\n  Button,\n  HStack,\n} from \"@chakra-ui/react\";\nimport { useState } from \"react\";\nimport EmbeddedEditor from \"./EmbeddedEditor\";\n\nexport default function EmbeddedArray({\n  formik,\n  schema,\n  onChange,\n  isCreating,\n}) {\n  console.log(\"EmbeddedSchemaArray\", schema);\n  const name = schema.key;\n\n  let value = formik.values[name];\n  value = Array.isArray(value) ? value : [];\n\n  const [expandedIndex, setExpandedIndex] = useState(-1);\n\n  return (\n    <Box pl={3} borderLeft=\"1px solid\" borderColor=\"brand.500\">\n      <Accordion\n        allowToggle\n        index={expandedIndex}\n        onChange={(index) => setExpandedIndex(index)}\n      >\n        {value.map((v, i) => (\n          <AccordionItem key={i}>\n            <h2>\n              <AccordionButton>\n                <HStack w=\"100%\" justify=\"space-between\">\n                  <Box flex=\"1\" textAlign=\"left\">\n                    {schema.display && v && typeof v === \"object\"\n                      ? v[schema.display]\n                      : i + 1}\n                  </Box>\n                  <Box mr={2}>\n                    <Button\n                      w=\"1em\"\n                      h=\"1em\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        formik.setFieldValue(name, [\n                          ...value.slice(0, i - 1),\n                          value[i],\n                          value[i - 1],\n                          ...value.slice(i + 1),\n                        ]);\n                      }}\n                      colorScheme=\"brand\"\n                      variant=\"ghost\"\n                      disabled={i === 0}\n                    >\n                      <ArrowUpIcon />\n                    </Button>\n                    <Button\n                      w=\"1em\"\n                      h=\"1em\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        formik.setFieldValue(name, [\n                          ...value.slice(0, i),\n                          ...value.slice(i + 1),\n                        ]);\n                      }}\n                      colorScheme=\"brand\"\n                      variant=\"ghost\"\n                    >\n                      <DeleteIcon />\n                    </Button>\n                    <Button\n                      w=\"1em\"\n                      h=\"1em\"\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        formik.setFieldValue(name, [\n                          ...value.slice(0, i),\n                          value[i + 1],\n                          value[i],\n                          ...value.slice(i + 2),\n                        ]);\n                      }}\n                      colorScheme=\"brand\"\n                      variant=\"ghost\"\n                      disabled={i === value.length - 1}\n                    >\n                      <ArrowDownIcon />\n                    </Button>\n                  </Box>\n                </HStack>\n                <AccordionIcon />\n              </AccordionButton>\n            </h2>\n            <AccordionPanel pb={4}>\n              <EmbeddedEditor\n                schema={schema}\n                isCreating={isCreating}\n                prefix={`${schema.key}[${i}]`}\n              />\n            </AccordionPanel>\n          </AccordionItem>\n        ))}\n      </Accordion>\n\n      <Button\n        w=\"100%\"\n        colorScheme=\"brand\"\n        variant=\"ghost\"\n        fontSize=\"3xl\"\n        onClick={() => {\n          formik.setFieldValue(`${name}[${value.length}]`, null);\n          setExpandedIndex(value.length);\n        }}\n      >\n        +\n      </Button>\n    </Box>\n  );\n}\n\nEmbeddedArray.grid = EmbeddedEditor.grid;\n","import { Box } from \"@chakra-ui/react\";\nimport React from \"react\";\nimport EmbeddedEditor from \"./EmbeddedEditor\";\n\nexport default function EmbeddedObject({ schema, isCreating }) {\n  return (\n    <Box pl={3} flex={1} borderLeft=\"1px solid\" borderColor=\"brand.500\">\n      <EmbeddedEditor\n        schema={schema}\n        isCreating={isCreating}\n        prefix={schema.key}\n      />\n    </Box>\n  );\n}\n\nEmbeddedObject.grid = EmbeddedEditor.grid;\n","import { ArrowUpIcon, DeleteIcon } from \"@chakra-ui/icons\";\nimport {\n  AspectRatio,\n  Box,\n  Button,\n  Center,\n  Circle,\n  Image,\n  Spinner,\n} from \"@chakra-ui/react\";\nimport { ErrorMessage } from \"formik\";\nimport React, { useCallback, useEffect, useState } from \"react\";\nimport useRequest from \"../../../utils/useRequest\";\nimport useRequestRunner from \"../../../utils/useRequestRunner\";\n\nexport default function FileOne({ name, value, onChange }) {\n  const [dragOver, setDragOver] = useState(false);\n\n  const uploadsApi = useRequest(\"/../api/file-upload\");\n  const uploadHandler = useRequestRunner();\n\n  useEffect(() => {\n    const v = value && typeof value == \"object\" ? value.id : value;\n    if (v) uploadHandler.run(uploadsApi.get(v));\n    else uploadHandler.setResult(null);\n    //eslint-disable-next-line\n  }, [value]);\n\n  const handleDrag = useCallback(\n    async (event) => {\n      console.log(event);\n      event.preventDefault();\n      setDragOver(false);\n\n      if (\n        event.dataTransfer.items &&\n        event.dataTransfer.items.length === 1 &&\n        event.dataTransfer.items[0].kind === \"file\"\n      ) {\n        const formData = new FormData();\n        formData.append(\"file\", event.dataTransfer.files[0]);\n\n        const result = await uploadHandler.run(\n          uploadsApi.send(\"upload\", formData, \"POST\", {\n            \"Content-Type\": \"multipart/form-data\",\n          })\n        );\n        if (onChange) {\n          onChange({ target: { value: result.id, name: name } });\n        }\n      }\n    },\n    [setDragOver, name, onChange, uploadHandler, uploadsApi]\n  );\n\n  return (\n    <AspectRatio\n      bg={\"gray.800\"}\n      borderRadius={4}\n      overflow=\"hidden\"\n      borderColor=\"gray.500\"\n      ratio={16 / 9}\n    >\n      <Box>\n        {uploadHandler.result && uploadHandler.result.filename && (\n          <Center position=\"absolute\" h=\"100%\" w=\"100%\">\n            <Image src={uploadHandler.result.filename} />\n          </Center>\n        )}\n        <ErrorMessage name={name}>\n          {(msg) => (\n            <Box\n              w=\"100%\"\n              h=\"100%\"\n              bg=\"brand.800\"\n              color=\"white\"\n              p={4}\n              children={msg}\n              position=\"absolute\"\n            />\n          )}\n        </ErrorMessage>\n        {uploadHandler.isLoading && (\n          <Center position=\"absolute\" h=\"100%\" w=\"100%\">\n            <Spinner size=\"lg\" color=\"white\" />\n          </Center>\n        )}\n        {dragOver && (\n          <Center\n            position=\"absolute\"\n            h=\"100%\"\n            w=\"100%\"\n            bg={dragOver ? \"#88888866\" : null}\n          >\n            <ArrowUpIcon color=\"white\" fontSize={100} />\n          </Center>\n        )}\n        <Box\n          w=\"100%\"\n          h=\"100%\"\n          onDragOver={(event) => {\n            event.preventDefault();\n            setDragOver(true);\n          }}\n          onDragLeave={() => setDragOver(false)}\n          onDrop={handleDrag}\n          position=\"absolute\"\n          display=\"flex\"\n          flexDir=\"row-reverse\"\n        >\n          {value && (\n            <Circle size=\"1.75em\" m={1.5} overflow=\"hidden\">\n              <Button\n                colorScheme=\"brand\"\n                onClick={() =>\n                  onChange && onChange({ target: { value: null, name: name } })\n                }\n              >\n                <DeleteIcon />\n              </Button>\n            </Circle>\n          )}\n        </Box>\n      </Box>\n    </AspectRatio>\n  );\n}\n\nFileOne.grid = [1, 2];\n","import \"prism-themes/themes/prism-coldark-dark.css\";\nimport { highlight, languages } from \"prismjs/components/prism-core\";\nimport \"prismjs/components/prism-json\";\nimport React, { useEffect, useState } from \"react\";\nimport Editor from \"react-simple-code-editor\";\n\nexport default function Json({ value, formik, name, onBlur, onFocus }) {\n  const [textValue, setTextValue] = useState(JSON.stringify(value, null, 2));\n  const [hasError, setHasError] = useState(false);\n  const setValue = formik.setFieldValue;\n\n  useEffect(() => {\n    let timeout = setTimeout(() => {\n      timeout = 0;\n      try {\n        const nv = JSON.parse(textValue);\n        setValue(name, nv);\n        setHasError(false);\n      } catch (ex) {\n        setValue(name, ex);\n        setHasError(true);\n      }\n    }, 250);\n    return () => timeout && clearTimeout(timeout);\n  }, [textValue, setValue, name]);\n\n  return (\n    <Editor\n      value={textValue}\n      onValueChange={setTextValue}\n      padding={16}\n      onBlur={() => !hasError && setTextValue(JSON.stringify(value, null, 2))}\n      highlight={(code) => highlight(code || \"\", languages.json)}\n      style={{\n        fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n        fontSize: 14,\n        background: hasError ? \"#6c223d\" : \"#3c526d\",\n        flex: 1,\n        transition: \"background-color 0.25s linear\",\n      }}\n      preClassName=\"language-json\"\n    />\n  );\n}\n\nJson.grid = [1, 5];\n","import {\n  FormControl,\n  FormLabel,\n  GridItem,\n  Input,\n  Text,\n  Textarea,\n} from \"@chakra-ui/react\";\nimport { connect, ErrorMessage, Field } from \"formik\";\nimport React from \"react\";\nimport Bool from \"./Bool\";\nimport DatePicker from \"./DatePicker\";\nimport EmbeddedArray from \"./EmbeddedArray\";\nimport EmbeddedObject from \"./EmbeddedObject\";\nimport Enum from \"./Enum\";\nimport FileMulti from \"./FileMulti\";\nimport FileOne from \"./FileOne\";\nimport Json from \"./Json\";\nimport RelationOne from \"./RelationOne\";\n\nfunction ConnectSchemaField(EditComponent, addProps = null) {\n  return connect(({ schema, isCreating, ...props }) => {\n    const disabled = isCreating ? schema.auto : schema.readonly;\n    if (schema.auto && schema.readonly) return null;\n\n    const grid = (schema.grid &&\n      (Array.isArray(schema.grid) ? schema.grid : [schema.grid, 1])) ||\n      (EditComponent && EditComponent.grid) || [1, 1];\n\n    return (\n      EditComponent && (\n        <GridItem\n          colSpan={{\n            sm: 1,\n            lg: Math.min(2, grid[0]),\n            \"2xl\": Math.min(3, grid[0]),\n          }}\n          rowSpan={grid[1]}\n          minH={`${2.5 + (grid[1] - 1) * 4}em`}\n          h=\"100%\"\n        >\n          <FormControl minW=\"20%\" h=\"100%\" display=\"flex\" flexDir=\"column\">\n            <FormLabel>{schema.name}</FormLabel>\n            <Field\n              as={EditComponent}\n              name={schema.key}\n              placeholder={schema.name}\n              disabled={disabled}\n              schema={schema}\n              required={\n                !disabled && schema.required && (!schema.private || isCreating)\n              }\n              {...props}\n              {...(addProps || {})}\n            />\n            <ErrorMessage component={Text} color=\"red.500\" name={schema.key} />\n          </FormControl>\n        </GridItem>\n      )\n    );\n  });\n}\n\nexport const FieldComponentMap = {\n  default: ConnectSchemaField(Input),\n  email: ConnectSchemaField(Input, { type: \"email\" }),\n  password: ConnectSchemaField(Input, { type: \"password\" }),\n  textarea: ConnectSchemaField(Textarea, { resize: \"none\" }),\n  bool: ConnectSchemaField(Bool),\n  enum: ConnectSchemaField(Enum),\n  relation_one: ConnectSchemaField(RelationOne),\n  relation_many: false,\n  file: ConnectSchemaField(FileOne),\n  file_multi: ConnectSchemaField(FileMulti),\n  embedded_object: ConnectSchemaField(EmbeddedObject),\n  embedded_array: ConnectSchemaField(EmbeddedArray),\n  date: ConnectSchemaField(DatePicker),\n  datetime: ConnectSchemaField(DatePicker),\n  timestamp: ConnectSchemaField(DatePicker),\n  json: ConnectSchemaField(Json),\n};\n","import { Switch } from \"@chakra-ui/react\";\nimport React from \"react\";\n\nexport default function Bool({ formik, name, ...props }) {\n  console.log(\"renderbool\");\n  return (\n    <Switch\n      size=\"lg\"\n      colorScheme=\"brand\"\n      {...props}\n      log={console.log(formik)}\n      isChecked={formik.values && formik.values[name]}\n      onChange={() =>\n        formik.setFieldValue(name, !(formik.values && formik.values[name]))\n      }\n    />\n  );\n}\n","import { Select } from \"@chakra-ui/react\";\nimport React from \"react\";\n\nexport default function Enum({ schema, placeholder, ...props }) {\n  return (\n    <Select {...props}>\n      {schema.values.map((v) => (\n        <option value={v}>{v}</option>\n      ))}\n    </Select>\n  );\n}\n","import { Select, Skeleton } from \"@chakra-ui/react\";\nimport React, { useContext, useEffect, useMemo } from \"react\";\nimport useRequest from \"../../../utils/useRequest\";\nimport { SchemaContext } from \"./../../../app/SchemaBackend\";\nimport useRequestRunner from \"./../../../utils/useRequestRunner\";\n\nexport default function RelationOne({ schema, placeholder, value, ...props }) {\n  const getSchema = useContext(SchemaContext);\n  const modelSchema = useMemo(\n    () => getSchema(schema.model),\n    [getSchema, schema]\n  );\n\n  const contentHandler = useRequestRunner(\n    useRequest(\n      `/content-manager/${schema.model}${\n        value ? `?${modelSchema.primary}_sort=${value}` : \"\"\n      }`\n    ).list\n  );\n  //eslint-disable-next-line\n  useEffect(contentHandler.run, [schema]);\n\n  if (value && typeof value === \"object\") value = value[modelSchema.primary];\n\n  const entities = contentHandler.result;\n  const optionList = useMemo(\n    () =>\n      modelSchema &&\n      entities &&\n      Array.isArray(entities) &&\n      entities.map((e) => (\n        <option key={e[modelSchema.primary]} value={e[modelSchema.primary]}>\n          {e[modelSchema.display]}\n        </option>\n      )),\n    [modelSchema, entities]\n  );\n\n  if (contentHandler.isLoading) return <Skeleton h={8} />;\n\n  return (\n    <Select value={value || \"\"} {...props}>\n      <option value=\"\">-</option>\n      {optionList}\n    </Select>\n  );\n}\n","import {\n  Accordion,\n  AccordionButton,\n  AccordionIcon,\n  AccordionItem,\n  AccordionPanel,\n  Button,\n  FormControl,\n  Grid,\n} from \"@chakra-ui/react\";\nimport FileOne from \"./FileOne\";\n\nexport default function FileMulti({ formik, schema, onChange }) {\n  const name = schema.key;\n  console.log(formik);\n\n  let value = formik.values[name];\n  value = Array.isArray(value) ? value : [];\n\n  return (\n    <FormControl minW=\"20%\">\n      <Accordion allowMultiple>\n        <AccordionItem>\n          <h2>\n            <AccordionButton>\n              <AccordionIcon />\n            </AccordionButton>\n          </h2>\n          <AccordionPanel pb={4}>\n            <Grid\n              templateColumns={{\n                sm: \"repeat(1, 1fr)\",\n                lg: \"repeat(2, 1fr)\",\n                \"2xl\": \"repeat(3, 1fr)\",\n              }}\n              flex={1}\n              gap={6}\n              mb={6}\n            >\n              {value.map((v, i) => (\n                <FileOne\n                  key={i}\n                  value={v}\n                  name={`${name}[${i}]`}\n                  onChange={(event) =>\n                    formik.setFieldValue(event.target.name, event.target.value)\n                  }\n                />\n              ))}\n            </Grid>\n            <Button\n              onClick={() =>\n                formik.setFieldValue(`${name}[${value.length}]`, null)\n              }\n            >\n              New\n            </Button>\n          </AccordionPanel>\n        </AccordionItem>\n      </Accordion>\n    </FormControl>\n  );\n}\n","import { Button, Grid, HStack, VStack } from \"@chakra-ui/react\";\nimport React from \"react\";\nimport { useHistory } from \"react-router\";\nimport AlertButton from \"../AlertButton\";\nimport { FieldComponentMap } from \"./Fields\";\n\nexport default function EditorForm({\n  schema,\n  isCreating,\n  contentHandler,\n  contentApi,\n  id,\n}) {\n  const history = useHistory();\n\n  return (\n    <VStack p={4} bg=\"white\" shadow=\"md\" flex={1} alignItems=\"stretch\">\n      <Grid\n        templateColumns={{\n          sm: \"repeat(1, 1fr)\",\n          lg: \"repeat(2, 1fr)\",\n          \"2xl\": \"repeat(3, 1fr)\",\n        }}\n        flex={1}\n        gap={6}\n        mb={6}\n      >\n        {Object.keys(schema.fields).map((fn) => (\n          <SchemaField\n            key={fn}\n            schema={schema.fields[fn]}\n            isCreating={isCreating}\n          />\n        ))}\n      </Grid>\n      <HStack w=\"100%\" justifyContent=\"space-between\">\n        {!isCreating && (\n          <AlertButton\n            type=\"button\"\n            colorScheme=\"brand\"\n            headerText=\"Deleting\"\n            message=\"Are you sure? This action can not be undone!\"\n            onClick={() =>\n              contentHandler.run(async () => {\n                await contentApi.delete(id);\n                history.goBack();\n              })\n            }\n          >\n            Delete\n          </AlertButton>\n        )}\n        <Button type=\"submit\" colorScheme=\"green\">\n          Save\n        </Button>\n      </HStack>\n    </VStack>\n  );\n}\n\nfunction SchemaField(props) {\n  if (props.schema.visible === false) return null;\n  const EditComponent =\n    FieldComponentMap[props.schema.type] ?? FieldComponentMap.default;\n\n  if (EditComponent) return <EditComponent {...props} />;\n  return null;\n}\n","import { Box, FormControl, FormLabel, Text } from \"@chakra-ui/react\";\nimport { connect } from \"formik\";\nimport moment from \"moment\";\nimport React, { useMemo } from \"react\";\n\nexport default function EditorInfo({ schema }) {\n  const fields = useMemo(\n    () =>\n      Object.keys(schema.fields).filter((key) => {\n        const fs = schema.fields[key];\n        return fs.auto && fs.readonly && fs.visible !== false;\n      }),\n    [schema]\n  );\n  if (fields.length === 0) return null;\n  return (\n    <Box minW=\"350px\" p={4} bg=\"white\" shadow=\"md\">\n      <Text fontWeight=\"bold\" fontSize={20}>\n        Information\n      </Text>\n      {fields.map((f) => (\n        <InfoField\n          schema={schema.fields[f]}\n          key={f}\n          name={schema.fields[f].key}\n        />\n      ))}\n    </Box>\n  );\n}\n\nconst InfoField = connect(function ({ name, value, formik, schema, ...props }) {\n  const v = formik.values && formik.values[name];\n\n  return (\n    <FormControl>\n      <FormLabel>{schema.name}</FormLabel>\n      <Text {...props}>\n        {(() => {\n          if (v && schema.type === \"date\")\n            return moment(new Date(v)).format(\"YYYY-MM-DD\");\n          else if (v && schema.type === \"datetime\")\n            return moment(new Date(v)).format(\"YYYY-MM-DD HH:mm:ss\");\n          else if (v && schema.type === \"timestamp\")\n            return moment(new Date(v)).format(\"YYYY-MM-DD HH:mm:ss\");\n          else if (v && typeof v === \"object\") return v[schema.display];\n          else if (v != null) return v;\n          else return \"-\";\n        })()}\n      </Text>\n    </FormControl>\n  );\n});\n","import {\n  Box,\n  Button,\n  HStack,\n  Stack,\n  Text,\n  useToast,\n  VStack,\n} from \"@chakra-ui/react\";\nimport { Form, Formik } from \"formik\";\nimport { default as React, useContext, useEffect, useMemo } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useHistory } from \"react-router-dom\";\nimport GenerateYup from \"../../utils/GenerateYup\";\nimport useRequest from \"../../utils/useRequest\";\nimport { PluginContext } from \"./../../app/plugin-system/PluginContext\";\nimport useRequestRunner from \"./../../utils/useRequestRunner\";\nimport EditorForm from \"./EditorForm\";\nimport EditorInfo from \"./EditorInfo\";\n\nexport default function EntryEditor({ isCreating, schema }) {\n  const history = useHistory();\n  const { model, id } = useParams();\n  const plugins = useContext(PluginContext);\n\n  // Api communication\n  const contentApi = useRequest(`/content-manager/${model}`);\n  const contentHandler = useRequestRunner(() => contentApi.get(id), {});\n  useEffect(() => {\n    if (!isCreating) contentHandler.run();\n    //eslint-disable-next-line\n  }, [isCreating, id]);\n\n  // Toast notification handling\n  const toast = useToast();\n  useEffect(() => {\n    if (!contentHandler.error) return;\n    toast({\n      title: \"Server error\",\n      description: contentHandler.error,\n      status: \"error\",\n      duration: 9000,\n      isClosable: true,\n    });\n    contentHandler.setError(null);\n    //eslint-disable-next-line\n  }, [contentHandler.error, contentHandler.resetError, toast]);\n\n  // Collected data for editor and addons\n  const editorContext = {\n    isCreating,\n    history,\n    schema,\n    id,\n    model,\n    toast,\n    contentHandler,\n    contentApi,\n  };\n\n  return (\n    <>\n      <Box>\n        <Text fontSize={40}>\n          {contentHandler.result && !isCreating\n            ? `${contentHandler.result[schema.display]} (${schema.name})`\n            : schema.name}\n        </Text>\n        <FormikWrapper {...editorContext}>\n          <VStack py={4} flex={1} alignItems=\"stretch\" spacing={4}>\n            <HStack>\n              <Button\n                colorScheme=\"brand\"\n                onClick={() => history.goBack()}\n                variant=\"link\"\n              >\n                Back\n              </Button>\n            </HStack>\n            {Object.keys(plugins.components)\n              .filter(\n                (k) =>\n                  k.startsWith(\"EditorAddon::\") &&\n                  plugins.components[k] &&\n                  plugins.components[k].pos_before\n              )\n              .map((k) => {\n                const Component = plugins.components[k];\n                return <Component key={k} {...editorContext} />;\n              })}\n            <Stack\n              direction={{ sm: \"column\", xl: \"row\" }}\n              alignItems={{ base: \"stretch\" }}\n              spacing={4}\n            >\n              <EditorForm {...editorContext} />\n              {!isCreating && <EditorInfo {...editorContext} />}\n            </Stack>\n            {Object.keys(plugins.components)\n              .filter(\n                (k) =>\n                  k.startsWith(\"EditorAddon::\") &&\n                  plugins.components[k] &&\n                  !plugins.components[k].pos_before\n              )\n              .map((k) => {\n                const Component = plugins.components[k];\n                return <Component key={k} {...editorContext} />;\n              })}\n          </VStack>\n        </FormikWrapper>\n      </Box>\n    </>\n  );\n}\n\nfunction FormikWrapper({\n  children,\n  isCreating,\n  schema,\n  id,\n  contentHandler,\n  contentApi,\n}) {\n  const history = useHistory();\n\n  const formikInitialValues = useMemo(() => {\n    const initVals = {};\n    Object.values(schema.fields).forEach((field) => {\n      if (field.default != null && !field.auto)\n        initVals[field.key] = field.default;\n    });\n    return initVals;\n  }, [schema]);\n\n  const validationSchema = GenerateYup(schema);\n  return (\n    <Formik\n      key={contentHandler.result && contentHandler.result[schema.primary]}\n      initialValues={isCreating ? formikInitialValues : contentHandler.result}\n      enableReinitialize={true}\n      validationSchema={validationSchema}\n      onSubmit={async (data) => {\n        console.log(data);\n\n        const result = await contentHandler.run(\n          isCreating ? contentApi.create(data) : contentApi.update(data, id)\n        );\n        if (!result) return;\n        if (result[schema.primary] !== id) {\n          history.replace(\"./\" + result[schema.primary]);\n        }\n      }}\n    >\n      {(isCreating || !contentHandler.isLoading) && <Form>{children}</Form>}\n    </Formik>\n  );\n}\n","import * as yup from \"yup\";\n\nexport default function GenerateYup(schema) {\n  if (!schema) return null;\n\n  const result = {};\n\n  Object.keys(schema.fields).forEach((key) => {\n    const field = schema.fields[key];\n    let fieldSchema = null;\n\n    switch (field.type) {\n      case \"file_multi\":\n        fieldSchema = yup.array(\n          yup.lazy((value) => {\n            switch (typeof value) {\n              case \"object\":\n                return yup.object({ id: yup.number().required() });\n              default:\n                return yup.number().required();\n            }\n          })\n        );\n        break;\n      case \"json\":\n        fieldSchema = yup\n          .mixed()\n          .test(\"has-no-error\", (v) => !(v instanceof Error));\n        break;\n      default:\n        break;\n    }\n\n    if (fieldSchema) result[key] = fieldSchema;\n  });\n  return yup.object(result);\n}\n","import { ArrowLeftIcon, ArrowRightIcon } from \"@chakra-ui/icons\";\nimport { Button, HStack, IconButton } from \"@chakra-ui/react\";\nimport React from \"react\";\n\nexport default function Pagination({ page, max, onSelect, colorScheme }) {\n  page = parseInt(page);\n  const pagerCount = max < 10 ? max : 10;\n  const offset =\n    page - pagerCount / 2 < 0\n      ? 0\n      : page + pagerCount / 2 > max\n      ? max - pagerCount\n      : page - pagerCount / 2;\n  if (max === 1 && page === 1) return null;\n  return (\n    <HStack mx=\"auto\" justifyContent=\"center\" w=\"100%\" size=\"sm\">\n      <IconButton\n        colorScheme={colorScheme}\n        icon={<ArrowLeftIcon />}\n        variant={\"ghost\"}\n        onClick={() => onSelect(1)}\n        disabled={page <= 1}\n        size=\"sm\"\n      />\n      {Array.apply(null, Array(pagerCount)).map((_, e) => (\n        <Button\n          size=\"sm\"\n          colorScheme={colorScheme}\n          variant={e + offset + 1 === page ? \"solid\" : \"ghost\"}\n          onClick={() => onSelect(e + offset + 1)}\n          key={e}\n        >\n          {e + offset + 1}\n        </Button>\n      ))}\n      <IconButton\n        colorScheme={colorScheme}\n        icon={<ArrowRightIcon />}\n        variant={\"ghost\"}\n        onClick={() => onSelect(max)}\n        disabled={page >= max}\n        size=\"sm\"\n      />\n    </HStack>\n  );\n}\n","import {\n  Box,\n  Button,\n  HStack,\n  Skeleton,\n  Table,\n  Tbody,\n  Td,\n  Text,\n  Th,\n  Thead,\n  Tr,\n  VStack,\n} from \"@chakra-ui/react\";\nimport moment from \"moment\";\nimport React, { useContext, useEffect, useMemo, useState } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useHistory } from \"react-router-dom\";\nimport { PluginContext } from \"../app/plugin-system/PluginContext\";\nimport useRequest from \"../utils/useRequest\";\nimport useRequestRunner from \"../utils/useRequestRunner\";\nimport Pagination from \"./Pagination\";\n\nconst displayFormatter = {\n  timestamp: (v) =>\n    v ? moment(new Date(v)).format(\"YYYY-MM-DD HH:mm:ss\") : \"-\",\n  datetime: (v) =>\n    v ? moment(new Date(v)).format(\"YYYY-MM-DD HH:mm:ss\") : \"-\",\n  date: (v) => (v ? moment(new Date(v)).format(\"YYYY-MM-DD\") : \"-\"),\n  password: false,\n  relation_many: false,\n  file: false,\n  json: false,\n  bool: (v) => (v ? \"true\" : \"false\"),\n  default: (v, s) => {\n    if (v && typeof v === \"object\" && s.display) {\n      if (v[s.display] != null) return String(v[s.display]);\n      return \"-\";\n    }\n    if (v == null) return \"-\";\n    return String(v);\n  },\n  embedded_array: false,\n  file_multi: false,\n  relation_multi: false,\n};\n\nexport default function ListEntries({ schema }) {\n  const { model } = useParams();\n  const history = useHistory();\n  const page = new URLSearchParams(history.location.search).get(\"page\") || 1;\n\n  const contentApi = useRequest(`/content-manager/${model}`);\n  const [entryCount, setEntryCount] = useState(0);\n\n  const contentHandler = useRequestRunner(contentApi.list, []);\n\n  const plugins = useContext(PluginContext);\n\n  useEffect(() => {\n    (async () => {\n      const count = await contentHandler.runError(\n        contentHandler.runStatus(contentApi.get(\"count\"))\n      );\n      if (count == null) return;\n      setEntryCount(count);\n      contentHandler.run(\n        contentApi.list({ _limit: 100, _start: (page - 1) * 100 })\n      );\n    })();\n    //eslint-disable-next-line\n  }, [page, schema]);\n\n  const listingContext = {\n    model,\n    history,\n    page,\n    contentApi,\n    contentHandler,\n    plugins,\n  };\n\n  const names = useMemo(() => {\n    if (schema && schema.listing && Array.isArray(schema.listing))\n      return schema.listing;\n    if (schema && schema.listing) return [schema.listing];\n    return Object.keys(schema.fields).filter(\n      (n) =>\n        displayFormatter[schema.fields[n].type] !== false &&\n        !schema.fields[n].private &&\n        schema.fields[n].visible &&\n        schema.fields[n].listed\n    );\n  }, [schema]);\n\n  return (\n    <Box>\n      <Text fontSize={40}>{schema.name}</Text>\n      <Skeleton isLoaded={!contentHandler.isLoading}>\n        <VStack py={4} flex={1} alignItems=\"stretch\" spacing={4}>\n          {schema.editable && (\n            <HStack>\n              <Button\n                colorScheme=\"brand\"\n                aria-label=\"Search database\"\n                onClick={() =>\n                  history.push(history.location.pathname + \"/create\")\n                }\n                variant=\"link\"\n              >\n                New\n              </Button>\n            </HStack>\n          )}\n          {Object.keys(plugins.components)\n            .filter(\n              (k) =>\n                k.startsWith(\"ListAddon::\") &&\n                plugins.components[k] &&\n                plugins.components[k].pos_before\n            )\n            .map((k) => {\n              const Component = plugins.components[k];\n              return <Component key={k} {...listingContext} />;\n            })}\n          <VStack\n            spacing={4}\n            alignItems=\"stretch\"\n            alignSelf=\"flex-start\"\n            minW=\"100%\"\n            bg=\"white\"\n            shadow=\"md\"\n            p={4}\n            overflow=\"visible\"\n          >\n            <Pagination\n              page={page}\n              max={Math.ceil(entryCount / 100) || 1}\n              colorScheme=\"brand\"\n              onSelect={(page) => history.push(\"?page=\" + page)}\n            />\n            <Table>\n              <Thead bg=\"white\">\n                <Tr>\n                  {names.map((n) => (\n                    <Th key={n}>{n}</Th>\n                  ))}\n                </Tr>\n              </Thead>\n              <Tbody>\n                {contentHandler.result &&\n                  contentHandler.result.map((e, i) => (\n                    <Tr\n                      key={e[schema.primary] || i}\n                      onClick={() =>\n                        schema.editable &&\n                        history.push(\n                          history.location.pathname + \"/\" + e[schema.primary]\n                        )\n                      }\n                      bg=\"white\"\n                      m={1}\n                    >\n                      {names.map((n) => (\n                        <Td key={n}>\n                          {schema.fields[n] &&\n                            (\n                              displayFormatter[schema.fields[n].type] ||\n                              displayFormatter.default\n                            )(e[n], schema.fields[n])}\n                        </Td>\n                      ))}\n                    </Tr>\n                  ))}\n              </Tbody>\n            </Table>\n            <Pagination\n              page={page}\n              max={Math.ceil(entryCount / 100) || 1}\n              colorScheme=\"brand\"\n              onSelect={(page) => history.push(\"?page=\" + page)}\n            />\n          </VStack>\n          {Object.keys(plugins.components)\n            .filter(\n              (k) =>\n                k.startsWith(\"ListAddon::\") &&\n                plugins.components[k] &&\n                !plugins.components[k].pos_before\n            )\n            .map((k) => {\n              const Component = plugins.components[k];\n              return <Component key={k} {...listingContext} />;\n            })}\n        </VStack>\n      </Skeleton>\n    </Box>\n  );\n}\n","import React, { useContext, useMemo } from \"react\";\nimport { Route, Switch, useParams } from \"react-router\";\nimport { SchemaContext } from \"./../app/SchemaBackend\";\nimport EntryEditor from \"./EntryEditor\";\nimport ListEntries from \"./ListEntries\";\n\nexport default function ContentType({ match }) {\n  const { model } = useParams();\n  const getSchema = useContext(SchemaContext);\n  const schema = useMemo(() => getSchema(model), [getSchema, model]);\n\n  return (\n    schema && (\n      <Switch>\n        <Route path={`${match.path}/create`}>\n          <EntryEditor key={schema.key} isCreating={true} schema={schema} />\n        </Route>\n        <Route path={`${match.path}/:id`}>\n          <EntryEditor key={schema.key} isCreating={false} schema={schema} />\n        </Route>\n        <Route path={match.path} exact>\n          <ListEntries key={schema.key} schema={schema} />\n        </Route>\n      </Switch>\n    )\n  );\n}\n","import { useContext } from \"react\";\nimport { Route, Switch } from \"react-router\";\nimport { Redirect } from \"react-router-dom\";\nimport Login from \"../pages/Login\";\nimport { AuthConext } from \"./../auth/auth\";\nimport ContentType from \"./../components/ContentType\";\nimport { PluginContext } from \"./plugin-system/PluginContext\";\n\nexport default function PageRouting() {\n  const auth = useContext(AuthConext);\n  const plugins = useContext(PluginContext);\n\n  return (\n    <Switch>\n      <Route path=\"/login\" component={Login} />\n      {!auth.user &&\n        plugins.routes\n          .filter((r) => r && r.without_login)\n          .map((r, i) => <Route {...r} key={r.path} />)}\n      {!auth.user && (\n        <Route\n          path=\"/\"\n          render={() => <Redirect path=\"*\" to=\"/login\" />}\n        ></Route>\n      )}\n      {auth.user && (\n        <Route path=\"/content-type/:model\" component={ContentType} />\n      )}\n      {auth.user && plugins.routes.map((r, i) => <Route {...r} key={r.path} />)}\n    </Switch>\n  );\n}\n","export const basePlugin = {\n  components: {\n    \"Layout::title\": \"Phroper\",\n    \"Layout::ChakraProvider\": null,\n  },\n};\n","import { Box } from \"@chakra-ui/layout\";\nimport {\n  createRemoteComponent,\n  createRequires,\n} from \"@paciolan/remote-component\";\nimport React, {\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useState,\n} from \"react\";\nimport { resolve } from \"../../remote-component.config.js\";\nimport { LocationContext } from \"../LocationBackend.js\";\nimport useRequest from \"./../../utils/useRequest\";\nimport { basePlugin } from \"./basePlugin.js\";\nimport { PluginContext } from \"./PluginContext\";\n\nconst requires = createRequires(resolve);\nconst RemoteComponent = createRemoteComponent({ requires });\n\nexport default function PluginBackend({ children }) {\n  // plugin registering states\n  const [pluginIds, setPluginIds] = useState(null);\n  const [plugins, setPlugins] = useState([basePlugin]);\n\n  // listing available plugin ids\n  const request = useRequest(\"/plugin-handler\");\n  useEffect(() => {\n    request\n      .list()\n      .then((r) => setPluginIds(r))\n      .catch((e) => setPluginIds([]));\n    //eslint-disable-next-line\n  }, []);\n  const basePath = useContext(LocationContext);\n\n  // Function to add plugin to state\n  const registerPlugin = useCallback(\n    (v) => setPlugins((p) => [...p, v]),\n    [setPlugins]\n  );\n\n  // Function to remove plugin from state\n  const unregisterPlugin = useCallback(\n    (v) => setPlugins((p) => p.filter((p) => p !== v)),\n    [setPlugins]\n  );\n\n  // Final plugin context value based on registered plugins\n  const pluginContextValue = useMemo(() => {\n    const routes = [];\n    const menus = [];\n    const components = {};\n\n    plugins.forEach((plugin) => {\n      if (plugin.routes) plugin.routes.forEach((r) => routes.push(r));\n      if (plugin.menus) plugin.menus.forEach((m) => menus.push(m));\n      if (plugin.components)\n        Object.keys(plugin.components).forEach(\n          (k) => (components[k] = plugin.components[k])\n        );\n    });\n\n    return {\n      routes,\n      menus,\n      components,\n      registerPlugin,\n      unregisterPlugin,\n      pluginIds,\n    };\n  }, [plugins, registerPlugin, pluginIds, unregisterPlugin]);\n\n  // Manage plugin loading states\n  const [errors, setErrors] = useState(null);\n  const [loadedPlugins, setLoadedPlugins] = useState({});\n  const allPluginLoaded =\n    pluginIds &&\n    pluginIds.reduce((prev, key) => prev && loadedPlugins[key], true);\n\n  // Store rendered plugins\n  const pluginRender = useMemo(\n    () =>\n      pluginIds &&\n      pluginIds.map((id) => (\n        <RemoteComponent\n          key={id}\n          url={basePath + \"/plugin-handler/\" + id}\n          render={({ err, Component }) => {\n            if (err) {\n              console.error(\"Plugin loading error\", id, err);\n              setTimeout(() => {\n                setErrors((errors) => ({ ...(errors || {}), [id]: err }));\n              }, 0);\n              return null;\n            }\n            setTimeout(() => {\n              setLoadedPlugins((lp) => (lp[id] ? lp : { ...lp, [id]: true }));\n            }, 0);\n            return <Component id={id} />;\n          }}\n        />\n      )),\n    [pluginIds, basePath]\n  );\n\n  return (\n    <PluginContext.Provider value={pluginContextValue}>\n      <Box display=\"none\">{pluginRender}</Box>\n      {errors && (\n        <>\n          <h1>Plugin loading errors</h1>\n          {Object.keys(errors).map((k) => (\n            <React.Fragment key={k}>\n              <h2>[{k}]</h2>\n              <pre>{errors[k].stack}</pre>\n            </React.Fragment>\n          ))}\n        </>\n      )}\n      {allPluginLoaded && !errors && children}\n    </PluginContext.Provider>\n  );\n}\n","import React from \"react\";\nimport { AuthBackend } from \"../auth/auth\";\nimport Layout from \"../layout\";\nimport ChakraProvider from \"./ChakraProvider\";\nimport LocationBackend from \"./LocationBackend\";\nimport PageRouting from \"./PageRouting\";\nimport PluginBackend from \"./plugin-system/PluginBackend\";\nimport SchemaBackend from \"./SchemaBackend\";\n\nexport const AppContext = React.createContext();\n\nfunction App() {\n  return (\n    <LocationBackend>\n      <PluginBackend>\n        <ChakraProvider>\n          <AuthBackend>\n            <SchemaBackend>\n              <Layout>\n                <PageRouting />\n              </Layout>\n            </SchemaBackend>\n          </AuthBackend>\n        </ChakraProvider>\n      </PluginBackend>\n    </LocationBackend>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./app\";\nimport \"./index.css\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { useContext, useEffect } from \"react\";\nimport { PluginContext } from \"./PluginContext\";\n\nexport function usePluginRegister(plugin) {\n  const { registerPlugin, unregisterPlugin } = useContext(PluginContext);\n\n  useEffect(() => {\n    registerPlugin(plugin);\n    return () => unregisterPlugin(plugin);\n  }, [plugin, registerPlugin, unregisterPlugin]);\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\n\n/**\n * useSafeState is a wrapper hook for react useState\n * disables state updates on deattached components\n * @param {any} initialValue Initial value of useState\n * @returns state object and setState function\n */\n\nexport default function useSafeState(initialValue) {\n  const [state, setState] = useState(initialValue);\n\n  const isAttachedRef = useRef(false);\n\n  const setStateSafe = useCallback(\n    (value) => {\n      if (isAttachedRef.current) setState(value);\n    },\n    [setState, isAttachedRef]\n  );\n\n  useEffect(() => {\n    isAttachedRef.current = true;\n    return () => void (isAttachedRef.current = false);\n  }, [isAttachedRef]);\n\n  return [state, setStateSafe];\n}\n","import { useCallback, useRef } from \"react\";\nimport useSafeState from \"./useSafeState\";\n\n/**\n * Promise handler hook, that handles results, errors and pending state of promises.\n * \n * @param {() => Promise<Object>} defaultRequest default request function\n * @param {*} initialResult Initial value of result\n * \n * @typedef RequestRunnerObj\n * @type {object}\n * \n * @prop {boolean} isLoading \n * True if a watched promise is pending\n * \n * @prop {boolean} isSuccess\n * True if the watched promise is resolved succesfully\n * \n * @prop {boolean} isDisplayable\n * True if not loading and has no error\n * \n * @prop {string|null} error\n * Message of the last caught error. \n * Null if there was no error.\n * \n * @prop {Object} result\n * Result of the last watched promise.\n * \n * @prop {(fn = null) => Promise<Object>} run \n * Runs the given handler or the default handler if not provided.\n * Watches pending state, errors and result.\n * \n * @prop {(fn = null) => Promise<Object>} runError\n * Runs the given handler or the default handler if not provided. \n * Set isLoading member pased on promise status. \n * If an error occures, stores the message and returns null.\n * Stores the result if the promise resolves successfully.\n * \n * @prop {} runResult\n * Runs the given handler or the default handler if not provided.\n * Stores the result if the promise resolves successfully.\n * \n * @prop {} runStatus\n * Runs the given handler or the default handler if not provided.\n * Set isLoading member pased on promise status. \n * \n * @prop {Function} setError\n * Manually update error.\n * \n * @prop {Function} setResult\n * Manually update result.\n  \n * \n * @returns {RequestRunnerObj}\n */\n\nexport default function useRequestRunner(\n  defaultRequest = null,\n  initialResult = null\n) {\n  const [state, setState] = useSafeState({\n    error: null,\n    result: initialResult,\n    isLoading: false,\n    isSuccess: false,\n  });\n\n  const runError = useCallback(\n    async (fn = null) => {\n      try {\n        if (typeof fn === \"function\") fn = await fn();\n        if (fn instanceof Promise) fn = await fn;\n        return fn;\n      } catch (ex) {\n        setState((s) => ({ ...s, error: ex.message }));\n        return null;\n      }\n    },\n    [setState]\n  );\n\n  const runResult = useCallback(\n    async (fn = null) => {\n      try {\n        let result = null;\n        if (typeof fn === \"function\") result = await fn();\n        else result = await fn;\n        setState((s) => ({ ...s, result: result }));\n        return result;\n      } catch (ex) {\n        throw ex;\n      }\n    },\n    [setState]\n  );\n\n  const runningRef = useRef(null);\n  const runStatus = useCallback(\n    async (fn) => {\n      const promise = fn instanceof Promise ? fn : (async () => await fn())();\n      runningRef.current = promise;\n      try {\n        setState((s) => ({ ...s, isLoading: true, isSuccess: false }));\n        const result = await promise;\n        setState((s) => ({ ...s, isLoading: false, isSuccess: true }));\n        return result;\n      } catch (ex) {\n        if (runningRef.current === promise) runningRef.current = null;\n        setState((s) => ({ ...s, isLoading: false, isSuccess: false }));\n        throw ex;\n      }\n    },\n    [setState, runningRef]\n  );\n\n  const run = useCallback(\n    async (requestFn = null) => {\n      if (requestFn == null) requestFn = defaultRequest;\n      return runError(() => runStatus(() => runResult(requestFn)));\n    },\n    [defaultRequest, runResult, runError, runStatus]\n  );\n\n  return {\n    isLoading: state.isLoading,\n    result: state.result,\n    error: state.error,\n    isSuccess: state.isSuccess,\n    isDisplayable: !state.isLoading && !state.error,\n    run: run,\n    runError: runError,\n    runResult: runResult,\n    runStatus: runStatus,\n    setError: (error = null) =>\n      setState((s) => ({\n        ...s,\n        error: error instanceof Error ? error.message : error,\n      })),\n    setResult: (result = null) => setState((s) => ({ ...s, result: result })),\n  };\n}\n","import { useMemo, useState } from \"react\";\n\nconst useLocalStorage = (key, initialValue) => {\n  const _loadedState = useMemo(() => {\n    let s = initialValue;\n    try {\n      const rs = localStorage.getItem(key);\n      if (rs) s = JSON.parse(localStorage.getItem(key));\n      else localStorage.setItem(key, JSON.stringify(initialValue));\n    } catch {\n      localStorage.setItem(key, JSON.stringify(initialValue));\n    }\n    return s;\n    // eslint-disable-next-line\n  }, []);\n\n  const [state, _setState] = useState({\n    isInitialized: true,\n    value: _loadedState,\n  });\n\n  const setState = (newState) => {\n    if (!Object.is(state.value, newState)) {\n      newState =\n        typeof newState === \"function\" ? newState(state.value) : newState;\n      localStorage.setItem(key, JSON.stringify(newState));\n      _setState({ ...state, value: newState });\n    }\n  };\n\n  return [state.value, setState];\n};\n\nexport default useLocalStorage;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport useLocalStorage from \"../utils/useLocalStorage\";\nimport useRequest from \"../utils/useRequest\";\n\nexport const AuthConext = React.createContext({});\n\nexport function AuthBackend({ children }) {\n  const [authState, setAuthState] = useLocalStorage(\"auth-state\", {\n    user: null,\n    jwt: null,\n  });\n  const request = useRequest(\"/../api/auth\", authState.jwt);\n\n  // Validating token data\n  const [tokenChecked, setTokenChecked] = useState(false);\n  useEffect(() => {\n    if (!authState.jwt) {\n      setTokenChecked(true);\n      return;\n    }\n\n    request\n      .get(\"me\")\n      .then((r) =>\n        setAuthState((s) => ({ user: r ? r : null, jwt: r ? s.jwt : null }))\n      )\n      .catch((e) => setAuthState({ user: null, jwt: null }))\n      .then(() => setTokenChecked(true));\n    //eslint-disable-next-line\n  }, [!!authState.jwt]);\n\n  const logout = useCallback(\n    function () {\n      setAuthState({ user: null, jwt: null });\n    },\n    [setAuthState]\n  );\n\n  const login = async function (username, password) {\n    logout();\n    const user = await request.send(\"login\", { username, password }, \"POST\");\n    setAuthState({ user: user.user, jwt: user.jwt });\n  };\n\n  const register = async function (data) {\n    logout();\n    const user = await request.send(\n      \"register\",\n      {\n        username: data.username,\n        password: data.password,\n        name: data.name,\n        email: data.email,\n      },\n      \"POST\"\n    );\n    setAuthState({ user: user.user, jwt: user.jwt });\n  };\n\n  // Token renewal\n  /*const tokenExpiration =\n    authState.jwt && JSON.parse(atob(authState.jwt.split(\".\")[1])).exp;\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      if (!tokenExpiration) return;\n      if (tokenExpiration < +new Date()) {\n        logout();\n      } else if (\n        tokenExpiration <= +new Date() + 1000 * 120 &&\n        tokenExpiration >= +new Date()\n      ) {\n        try {\n          const response = await request.send(\"renew\", null, \"GET\");\n          setAuthState((state) => ({ ...state, jwt: response.jwt }));\n        } catch {}\n      }\n    }, 1000 * 6);\n    return () => clearInterval(interval);\n  }, [logout, request, setAuthState, tokenExpiration]);*/\n\n  return (\n    <AuthConext.Provider\n      value={{\n        user: authState.user,\n        jwt: authState.jwt,\n        login,\n        logout,\n        register,\n      }}\n    >\n      {tokenChecked && children}\n    </AuthConext.Provider>\n  );\n}\n"],"sourceRoot":""}