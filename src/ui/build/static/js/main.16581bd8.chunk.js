(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{464:function(e,t,n){e.exports={resolve:{react:n(0),axios:n(297),formik:n(42),moment:n(111),yup:n(82),"phroper-admin":n(698),"framer-motion":n(71),"react-datepicker":n(301),"react-dom":n(49),"react-router-dom":n(86),"@chakra-ui/react":n(40),"@chakra-ui/icons":n(213),"@emotion/react":n(79),"@emotion/styled":n(309)}}},59:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),c=n.n(r).a.createContext()},603:function(e,t,n){},670:function(e,t){},672:function(e,t){},692:function(e,t,n){},693:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(49),i=n.n(a),s=n(16),o=n.n(s),u=n(27),l=n(3),j=n(14),b=function(e,t){var n=Object(r.useMemo)((function(){var n=t;try{localStorage.getItem(e)?n=JSON.parse(localStorage.getItem(e)):localStorage.setItem(e,JSON.stringify(t))}catch(r){localStorage.setItem(e,JSON.stringify(t))}return n}),[]),c=Object(r.useState)({isInitialized:!0,value:n}),a=Object(l.a)(c,2),i=a[0],s=a[1];return[i.value,function(t){Object.is(i.value,t)||(t="function"===typeof t?t(i.value):t,localStorage.setItem(e,JSON.stringify(t)),s(Object(j.a)(Object(j.a)({},i),{},{value:t})))}]},d=n(297),f=n.n(d),h=n(86),m=n(1),p=c.a.createContext();function O(e){var t=e.children,n="";if(window){var r=window.location.pathname;r.endsWith("/")||(r+="/"),r.includes("/admin/")&&(n=r.split("/admin/")[0])}return n+="/admin",console.log("LocationBackend",n),Object(m.jsx)(p.Provider,{value:n,children:Object(m.jsx)(h.BrowserRouter,{basename:n,children:t})})}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(r.useContext)(v),c=Object(r.useContext)(p);e=c+e;var a=Object(r.useMemo)((function(){var r=function(){var e=Object(u.a)(o.a.mark((function e(r,c,a,i){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f()({method:a,url:r,data:c,headers:t||(null===n||void 0===n?void 0:n.jwt)?Object(j.a)({Authorization:"Bearer "+(t||(null===n||void 0===n?void 0:n.jwt))},i):Object(j.a)({},i)});case 3:return s=e.sent,e.abrupt("return",s.data);case 7:if(e.prev=7,e.t0=e.catch(0),"401"===e.t0.code&&n.logout(),!e.t0.response||!e.t0.response.data||"object"!==typeof e.t0.response.data){e.next=12;break}throw new Error(e.t0.response.data.message);case 12:throw new Error("Server is not available.");case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r,c){return e.apply(this,arguments)}}();return{list:function(){var t=Object(u.a)(o.a.mark((function t(){var n,c=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=c.length>0&&void 0!==c[0]?c[0]:null,t.abrupt("return",r(e+(n?"?page=".concat(n):""),null,"GET"));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),get:function(){var t=Object(u.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+n,null,"GET"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=Object(u.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,n,"POST"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=Object(u.a)(o.a.mark((function t(n){var c,a=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=a.length>1&&void 0!==a[1]?a[1]:null,t.abrupt("return",r(e+"/"+(null==c?n.id:c),n,"PUT"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=Object(u.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+("object"===typeof n?n.id:n),null,"DELETE"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),send:function(){var t=Object(u.a)(o.a.mark((function t(n,c){var a,i,s=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]?s[2]:"GET",i=s.length>3&&void 0!==s[3]?s[3]:{},t.abrupt("return",r(e+"/"+n,c,a,i));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),[e,n,t]);return a}var v=c.a.createContext({});function g(e){var t=e.children,n=b("auth-state",{user:null,jwt:null}),c=Object(l.a)(n,2),a=c[0],i=c[1],s=x("/../api/auth",a.jwt),j=Object(r.useCallback)((function(){i({user:null,jwt:null})}),[i]),d=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(),e.next=3,s.send("login",{username:t,password:n},"POST");case 3:r=e.sent,i({user:r.user,jwt:r.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(),e.next=3,s.send("register",{username:t.username,password:t.password,name:t.name,email:t.email},"POST");case 3:n=e.sent,i({user:n.user,jwt:n.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(v.Provider,{value:{user:a.user,jwt:a.jwt,login:d,logout:j,register:f},children:t})}var y=n(335),w=n(299),k=n(341),C=n(448),S=n(218),E=n(219),M=n(342),L=n(59);function P(e){var t=Object(r.useState)(e),n=Object(l.a)(t,2),c=n[0],a=n[1],i=Object(r.useRef)(!1),s=Object(r.useCallback)((function(e){i.current&&a(e)}),[a,i]);return Object(r.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[i]),[c,s]}function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=P({error:null,result:t,isLoading:!1,isSuccess:!1}),c=Object(l.a)(n,2),a=c[0],i=c[1],s=Object(r.useCallback)(Object(u.a)(o.a.mark((function e(){var t,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,"function"!==typeof t){e.next=6;break}return e.next=5,t();case 5:t=e.sent;case 6:if(!(t instanceof Promise)){e.next=10;break}return e.next=9,t;case 9:t=e.sent;case 10:return console.log("error",t),e.abrupt("return",t);case 14:return e.prev=14,e.t0=e.catch(1),i((function(t){return Object(j.a)(Object(j.a)({},t),{},{error:e.t0.message})})),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[1,14]])}))),[i]),b=Object(r.useCallback)(Object(u.a)(o.a.mark((function e(){var t,n,r=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:null,e.prev=1,n=null,"function"!==typeof t){e.next=9;break}return e.next=6,t();case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t;case 11:n=e.sent;case 12:return i((function(e){return Object(j.a)(Object(j.a)({},e),{},{result:n})})),e.abrupt("return",n);case 16:throw e.prev=16,e.t0=e.catch(1),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),[i]),d=Object(r.useRef)(null),f=Object(r.useCallback)(function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=t instanceof Promise?t:Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),d.current=n,e.prev=3,i((function(e){return Object(j.a)(Object(j.a)({},e),{},{isLoading:!0,isSuccess:!1})})),e.next=7,n;case 7:return r=e.sent,i((function(e){return Object(j.a)(Object(j.a)({},e),{},{isLoading:!1,isSuccess:!0})})),console.log("error",r),e.abrupt("return",r);case 13:throw e.prev=13,e.t0=e.catch(3),d.current===n&&(d.current=null),i((function(e){return Object(j.a)(Object(j.a)({},e),{},{isLoading:!1,isSuccess:!1})})),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),[i,d]),h=Object(r.useCallback)(Object(u.a)(o.a.mark((function t(){var n,r=arguments;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=r.length>0&&void 0!==r[0]?r[0]:null)&&(n=e),t.abrupt("return",s((function(){return f((function(){return b(n)}))})));case 3:case"end":return t.stop()}}),t)}))),[e,b,s,f]);return{isLoading:a.isLoading,result:a.result,error:a.error,isSuccess:a.isSuccess,isDisplayable:!a.isLoading&&!a.error,run:h,runError:s,runResult:b,runStatus:f,setError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(j.a)(Object(j.a)({},t),{},{error:e instanceof Error?e.message:e})}))},setResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(j.a)(Object(j.a)({},t),{},{result:e})}))}}}function D(e){var t,n=e.children,c=F(x("/content-schema/models").list),a=Object(r.useContext)(v),i=Object(r.useContext)(L.a);return Object(r.useEffect)(c.run,[a.user]),Object(m.jsxs)(m.Fragment,{children:[c.isLoading&&Object(m.jsx)(y.b,{w:"100vw",h:"100vh",children:Object(m.jsx)(w.a,{})}),Object(m.jsxs)(k.a,{bg:"gray.100",minH:"100vh",w:"100%",overflow:"visible",children:[Object(m.jsxs)(k.a,{position:"fixed",left:0,px:3,w:"250px",top:0,h:"100%",bg:"red.600",color:"white",overflow:"auto",children:[Object(m.jsx)(k.a,{fontSize:40,mb:6,w:"100%",textAlign:"center",children:Object(m.jsx)(h.Link,{to:"/",children:i.components["Layout::title"]})}),!a.user&&Object(m.jsxs)(C.a,{mb:6,children:[Object(m.jsx)(S.a,{mr:4}),Object(m.jsx)(C.e,{flex:1,alignItems:"flex-start",children:Object(m.jsx)(E.a,{as:h.Link,to:"/login",variant:"link",colorScheme:"white",onClick:a.logout,children:"login"})})]}),a.user&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(C.a,{mb:6,children:[Object(m.jsx)(S.a,{mr:4}),Object(m.jsxs)(C.e,{flex:1,alignItems:"flex-start",children:[Object(m.jsx)(M.a,{fontSize:20,children:a.user.username}),Object(m.jsx)(E.a,{variant:"link",colorScheme:"white",onClick:a.logout,children:"logout"})]})]}),c.isSuccess&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(M.a,{fontSize:24,mb:2,children:"Content types"}),Object(m.jsx)(C.e,{pl:4,mb:2,alignItems:"flex-start",children:null===(t=c.result)||void 0===t?void 0:t.filter((function(e){return e.visible})).map((function(e){return Object(m.jsx)(h.Link,{to:"/content-type/".concat(e.key),children:e.name},e.key)}))})]}),i.menus&&i.menus.length>0&&Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(M.a,{fontSize:24,mb:2,children:"Plugins"}),Object(m.jsx)(C.e,{pl:4,mb:2,alignItems:"flex-start",children:i.menus.map((function(e){return Object(m.jsx)(h.Link,{to:"".concat(e.to),children:e.text},e.to)}))})]})]})]}),Object(m.jsx)(k.a,{ml:250,px:4,children:n})]})]})}var A=n(343);function T(e){var t=e.children,n=Object(r.useContext)(L.a).components["Layout::ChakraProvider"]||A.a;return Object(m.jsx)(n,{children:t})}var Y=n(19),z=n(366),H=n(174),_=n(87),I=n(367),R=n(368),q=n(42),V=n(82);function W(){return Object(m.jsx)(k.a,{pt:"10vh",children:Object(m.jsxs)(z.a,{minH:10,p:0,bgColor:"gray.200",children:[Object(m.jsx)(M.a,{fontSize:32,p:2,bg:"red.500",color:"white",mb:4,children:"Login"}),Object(m.jsx)(k.a,{p:4,children:Object(m.jsx)(B,{})})]})})}function B(){var e=Object(r.useContext)(v),t=Object(Y.k)();return Object(m.jsx)(q.Formik,{validationSchema:V.object().shape({username:V.string().required("Username is required"),password:V.string().required("Password is required")}),initialValues:{username:"",password:""},onSubmit:function(){var n=Object(u.a)(o.a.mark((function n(r,c){var a,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=c.setErrors,n.prev=1,n.next=4,e.login(r.username,r.password);case 4:for(i=t.location.state;i&&i.redirect&&"/login"===i.redirect.pathname;)i=i.redirect.state;i&&i.redirect?t.push(i.redirect.pathname,i.redirect.state):t.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),a({password:n.t0.message});case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}(),children:Object(m.jsx)(q.Form,{children:Object(m.jsxs)(C.b,{spacing:4,children:[t.location.state&&t.location.state.error&&Object(m.jsxs)(H.a,{status:"error",children:[Object(m.jsx)(H.c,{}),Object(m.jsx)(H.b,{children:t.location.state.error})]}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(I.a,{children:"Username"}),Object(m.jsx)(q.Field,{as:R.a,bgColor:"white",type:"text",name:"username"}),Object(m.jsx)(q.ErrorMessage,{name:"username",component:M.a,color:"red"})]}),Object(m.jsxs)(_.a,{children:[Object(m.jsx)(I.a,{children:"Password"}),Object(m.jsx)(q.Field,{as:R.a,bgColor:"white",type:"password",name:"password"}),Object(m.jsx)(q.ErrorMessage,{name:"password",component:M.a,color:"red"})]}),Object(m.jsx)(k.a,{textAlign:"right",pt:2,children:Object(m.jsx)(q.FormikConsumer,{children:function(e){var t=e.isSubmitting;return Object(m.jsx)(E.a,{isLoading:t,type:"submit",variant:"solid",colorScheme:"red",children:"Log in"})}})})]})})})}var J=c.a.createContext();function N(e){var t=e.children,n=F(x("/content-schema/models").list,null),c=Object(r.useContext)(v);return Object(r.useEffect)(n.run,[c.user]),Object(m.jsxs)(m.Fragment,{children:[n.isLoading&&Object(m.jsx)(y.b,{w:"100vw",h:"100vh",children:Object(m.jsx)(w.a,{})}),!n.isLoading&&Object(m.jsx)(J.Provider,{value:function(e){return n.result&&n.result.find((function(t){return t.key===e}))},children:t})]})}var U=n(394);var G=n(223),K=n(72),Q=n(369),X=n(41);function Z(e){var t=e.message,n=e.children,r=e.onClick,a=e.acceptText,i=void 0===a?"Ok":a,s=e.cancelText,o=void 0===s?"Cancel":s,u=e.headerText,b=void 0===u?"":u,d=Object(K.a)(e,["message","children","onClick","acceptText","cancelText","headerText"]),f=c.a.useState(!1),h=Object(l.a)(f,2),p=h[0],O=h[1],x=function(){return O(!1)},v=c.a.useRef();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(E.a,Object(j.a)(Object(j.a)({colorScheme:"red"},d),{},{onClick:function(){return O(!0)},children:n})),Object(m.jsx)(Q.a,{isOpen:p,leastDestructiveRef:v,onClose:x,children:Object(m.jsx)(X.i,{children:Object(m.jsxs)(Q.d,{children:[b&&Object(m.jsx)(X.h,{fontSize:"lg",fontWeight:"bold",children:b}),Object(m.jsx)(X.b,{children:t}),Object(m.jsx)(X.g,{children:Object(m.jsxs)(C.a,{w:"100%",justifyContent:"space-between",children:[Object(m.jsx)(E.a,{ref:v,onClick:x,children:o}),Object(m.jsx)(E.a,{colorScheme:"red",onClick:function(){x(),r&&r.apply(void 0,arguments)},ml:3,children:i})]})})]})})})]})}var $=n(393),ee=n(374);var te=n(301),ne=n.n(te),re=(n(602),n(603),function(e){var t=e.onChange,n=e.isClearable,r=void 0!==n&&n,c=e.showPopperArrow,a=void 0!==c&&c,i=e.value,s=Object(K.a)(e,["onChange","isClearable","showPopperArrow","value"]);return Object(m.jsx)(k.a,{children:Object(m.jsx)(ne.a,Object(j.a)({type:"date",selected:"string"===typeof i?new Date(i):i,onChange:t,isClearable:r,showPopperArrow:a},s))})}),ce={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm",timestamp:"yyyy-MM-dd HH:mm:ss"};var ae=Object(q.connect)((function(e){var t=e.formik,n=e.schema,r=e.name,c=e.value;return Object(m.jsx)(re,{name:r,onChange:function(e){return t.setFieldValue(r,e)},timeFormat:"HH:mm",dateFormat:ce[n.type],showTimeSelect:"date"!==n.type,value:c})})),ie=n(20),se=n(385),oe=n(386),ue=n(387),le=n(384);function je(e){var t=e.schema,n=e.isCreating,c=e.prefix;t=Object(r.useMemo)((function(){return t&&c?Object(j.a)(Object(j.a)({},t),{},{key:"".concat(c,".").concat(t.key)}):t}),[t,c]);var a=Object(r.useMemo)((function(){var e={};return Object.keys(t.fields).forEach((function(n){e[n]=c?Object(j.a)(Object(j.a)({},t.fields[n]),{},{key:"".concat(c,".").concat(t.fields[n].key)}):t.fields[n]})),e}),[t,c]);console.log("EmbeddedEditor",a);var i=t.grid||je.grid;return Object(m.jsx)(G.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(".concat(Math.min(2,i[0]),", 1fr)"),"2xl":"repeat(".concat(Math.min(3,i[0]),", 1fr)")},flex:1,gap:6,mb:6,children:Object.keys(a).map((function(e){return Object(m.jsx)(be,{schema:a[e],isCreating:n},e)}))})}function be(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=ge[e.schema.type])&&void 0!==t?t:ge.default;return n?Object(m.jsx)(n,Object(j.a)({},e)):null}function de(e){var t=e.formik,n=e.schema,r=(e.onChange,e.isCreating);console.log("EmbeddedSchemaArray",n);var c=n.key,a=t.values[c];return a=Array.isArray(a)?a:[],Object(m.jsxs)(k.a,{pl:3,borderLeft:"1px solid",borderColor:"red.500",children:[Object(m.jsx)(le.a,{allowToggle:!0,children:a.map((function(e,i){return Object(m.jsxs)(le.d,{children:[Object(m.jsx)("h2",{children:Object(m.jsxs)(le.b,{children:[Object(m.jsxs)(C.a,{w:"100%",justify:"space-between",children:[Object(m.jsx)(k.a,{flex:"1",textAlign:"left",children:n.display&&e&&"object"===typeof e?e[n.display]:i+1}),Object(m.jsxs)(k.a,{mr:2,children:[Object(m.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ie.a)(a.slice(0,i-1)),[a[i],a[i-1]],Object(ie.a)(a.slice(i+1))))},colorScheme:"red",variant:"ghost",disabled:0===i,children:Object(m.jsx)(se.a,{})}),Object(m.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ie.a)(a.slice(0,i)),Object(ie.a)(a.slice(i+1))))},colorScheme:"red",variant:"ghost",children:Object(m.jsx)(oe.a,{})}),Object(m.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(c,[].concat(Object(ie.a)(a.slice(0,i)),[a[i+1],a[i]],Object(ie.a)(a.slice(i+2))))},colorScheme:"red",variant:"ghost",disabled:i===a.length-1,children:Object(m.jsx)(ue.a,{})})]})]}),Object(m.jsx)(le.c,{})]})}),Object(m.jsx)(le.e,{pb:4,children:Object(m.jsx)(je,{schema:n,isCreating:r,prefix:"".concat(n.key,"[").concat(i,"]")})})]},i)}))}),Object(m.jsx)(E.a,{w:"100%",colorScheme:"red",variant:"ghost",fontSize:"3xl",onClick:function(){return t.setFieldValue("".concat(c,"[").concat(a.length,"]"),null)},children:"+"})]})}function fe(e){var t=e.schema,n=e.isCreating;return Object(m.jsx)(k.a,{pl:3,flex:1,borderLeft:"1px solid",borderColor:"red.500",children:Object(m.jsx)(je,{schema:t,isCreating:n,prefix:t.key})})}je.grid=[3,1],de.grid=je.grid,fe.grid=je.grid;var he=n(388);var me=n(390),pe=n(391);function Oe(e){var t=e.name,n=e.value,c=e.onChange,a=Object(r.useState)(!1),i=Object(l.a)(a,2),s=i[0],j=i[1],b=x("/../api/file-upload"),d=F();Object(r.useEffect)((function(){var e=n&&"object"==typeof n?n.id:n;e?d.run(b.get(e)):d.setResult(null)}),[n]);var f=Object(r.useCallback)(function(){var e=Object(u.a)(o.a.mark((function e(n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),n.preventDefault(),j(!1),!n.dataTransfer.items||1!==n.dataTransfer.items.length||"file"!==n.dataTransfer.items[0].kind){e.next=10;break}return(r=new FormData).append("file",n.dataTransfer.files[0]),e.next=8,d.run(b.send("upload",r,"POST",{"Content-Type":"multipart/form-data"}));case 8:a=e.sent,c&&c({target:{value:a.id,name:t}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[j,t,c,d,b]);return Object(m.jsx)(me.a,{bg:"gray.800",borderRadius:4,overflow:"hidden",borderColor:"gray.500",ratio:16/9,children:Object(m.jsxs)(k.a,{children:[d.result&&d.result.filename&&Object(m.jsx)(y.b,{position:"absolute",h:"100%",w:"100%",children:Object(m.jsx)(pe.a,{src:d.result.filename})}),Object(m.jsx)(q.ErrorMessage,{name:t,children:function(e){return Object(m.jsx)(k.a,{w:"100%",h:"100%",bg:"red.800",color:"white",p:4,children:e,position:"absolute"})}}),d.isLoading&&Object(m.jsx)(y.b,{position:"absolute",h:"100%",w:"100%",children:Object(m.jsx)(w.a,{size:"lg",color:"white"})}),s&&Object(m.jsx)(y.b,{position:"absolute",h:"100%",w:"100%",bg:s?"#88888866":null,children:Object(m.jsx)(se.a,{color:"white",fontSize:100})}),Object(m.jsx)(k.a,{w:"100%",h:"100%",onDragOver:function(e){e.preventDefault(),j(!0)},onDragLeave:function(){return j(!1)},onDrop:f,position:"absolute",display:"flex",flexDir:"row-reverse",children:n&&Object(m.jsx)(k.b,{size:"1.75em",m:1.5,overflow:"hidden",children:Object(m.jsx)(E.a,{colorScheme:"red",onClick:function(){return c&&c({target:{value:null,name:t}})},children:Object(m.jsx)(oe.a,{})})})})]})})}Oe.grid=[1,2];var xe=n(392);function ve(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(q.connect)((function(n){var r=n.schema,c=n.isCreating,a=Object(K.a)(n,["schema","isCreating"]),i=c?r.auto:r.readonly;if(r.auto&&r.readonly)return null;var s=r.grid&&(Array.isArray(r.grid)?r.grid:[r.grid,1])||e&&e.grid||[1,1];return e&&Object(m.jsx)(G.b,{colSpan:{sm:1,lg:Math.min(2,s[0]),"2xl":Math.min(3,s[0])},rowSpan:{sm:1,lg:Math.min(2,s[1]),"2xl":Math.min(3,s[1])},h:"100%",children:Object(m.jsxs)(_.a,{minW:"20%",h:"100%",display:"flex",flexDir:"column",children:[Object(m.jsx)(I.a,{children:r.name}),Object(m.jsx)(q.Field,Object(j.a)(Object(j.a)({as:e,name:r.key,placeholder:r.name,disabled:i,schema:r,required:!i&&r.required&&(!r.private||c)},a),t||{}))]})})}))}var ge={default:ve(R.a),email:ve(R.a,{type:"email"}),password:ve(R.a,{type:"password"}),textarea:ve($.a,{resize:"none"}),bool:ve((function(e){var t=e.formik,n=e.name,r=Object(K.a)(e,["formik","name"]);return console.log("renderbool"),Object(m.jsx)(ee.a,Object(j.a)(Object(j.a)({size:"lg",colorScheme:"red"},r),{},{log:console.log(t),isChecked:t.values&&t.values[n],onChange:function(){return t.setFieldValue(n,!(t.values&&t.values[n]))}}))})),enum:ve((function(e){var t=e.schema,n=(e.placeholder,Object(K.a)(e,["schema","placeholder"]));return Object(m.jsx)(he.b,Object(j.a)(Object(j.a)({},n),{},{children:t.values.map((function(e){return Object(m.jsx)("option",{value:e,children:e})}))}))})),relation_one:ve((function(e){var t=e.schema,n=(e.placeholder,e.value),c=Object(K.a)(e,["schema","placeholder","value"]),a=Object(r.useContext)(J),i=Object(r.useMemo)((function(){return a(t.model)}),[a,t]),s=F(x("/content-manager/".concat(t.model).concat(n?"?".concat(i.primary,"_sort=").concat(n):"")).list);Object(r.useEffect)(s.run,[t]),n&&"object"===typeof n&&(n=n[t.primary]);var o=s.result,u=Object(r.useMemo)((function(){return i&&o&&Array.isArray(o)&&o.map((function(e){return Object(m.jsx)("option",{value:e[i.primary],children:e[i.display]},e[i.primary])}))}),[i,o]);return s.isLoading?Object(m.jsx)(xe.a,{h:8}):Object(m.jsxs)(he.b,Object(j.a)(Object(j.a)({value:n||""},c),{},{children:[Object(m.jsx)("option",{value:"",children:"-"}),u]}))})),relation_many:!1,file:ve(Oe),file_multi:ve((function(e){var t=e.formik,n=e.schema,r=(e.onChange,n.key);console.log(t);var c=t.values[r];return c=Array.isArray(c)?c:[],Object(m.jsx)(_.a,{minW:"20%",children:Object(m.jsx)(le.a,{allowMultiple:!0,children:Object(m.jsxs)(le.d,{children:[Object(m.jsx)("h2",{children:Object(m.jsx)(le.b,{children:Object(m.jsx)(le.c,{})})}),Object(m.jsxs)(le.e,{pb:4,children:[Object(m.jsx)(G.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:c.map((function(e,n){return Object(m.jsx)(Oe,{value:e,name:"".concat(r,"[").concat(n,"]"),onChange:function(e){return t.setFieldValue(e.target.name,e.target.value)}},n)}))}),Object(m.jsx)(E.a,{onClick:function(){return t.setFieldValue("".concat(r,"[").concat(c.length,"]"),null)},children:"New"})]})]})})})})),embedded_object:ve(fe),embedded_array:ve(de),date:ve(ae),datetime:ve(ae),timestamp:ve(ae)};function ye(e){var t=e.schema,n=e.isCreating,r=e.contentHandler,c=e.contentApi,a=e.id,i=Object(Y.k)();return Object(m.jsxs)(C.e,{p:4,bg:"white",flex:1,alignItems:"stretch",children:[Object(m.jsx)(G.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:Object.keys(t.fields).map((function(e){return Object(m.jsx)(we,{schema:t.fields[e],isCreating:n},e)}))}),Object(m.jsxs)(C.a,{w:"100%",justifyContent:"space-between",children:[!n&&Object(m.jsx)(Z,{type:"button",colorScheme:"red",headerText:"Deleting",message:"Are you sure? This action can not be undone!",onClick:function(){return r.run(Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.delete(a);case 2:i.goBack();case 3:case"end":return e.stop()}}),e)}))))},children:"Delete"}),Object(m.jsx)(E.a,{type:"submit",colorScheme:"green",children:"Save"})]})]})}function we(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=ge[e.schema.type])&&void 0!==t?t:ge.default;return n?Object(m.jsx)(n,Object(j.a)({},e)):null}var ke=n(111),Ce=n.n(ke);function Se(e){var t=e.schema;return Object(m.jsxs)(k.a,{minW:"350px",p:4,bg:"white",children:[Object(m.jsx)(M.a,{fontWeight:"bold",fontSize:20,children:"Information"}),Object.keys(t.fields).map((function(e){return Object(m.jsx)(Ee,{schema:t.fields[e],name:t.fields[e].key},e)}))]})}var Ee=Object(q.connect)((function(e){var t=e.name,n=(e.value,e.formik),r=e.schema,c=Object(K.a)(e,["name","value","formik","schema"]),a=n.values&&n.values[t];return r.auto&&r.readonly&&!1!==r.visible?Object(m.jsxs)(_.a,{children:[Object(m.jsx)(I.a,{children:r.name}),Object(m.jsx)(M.a,Object(j.a)(Object(j.a)({},c),{},{children:a&&"date"===r.type?Ce()(new Date(a)).format("YYYY-MM-DD"):a&&"datetime"===r.type||a&&"timestamp"===r.type?Ce()(new Date(a)).format("YYYY-MM-DD HH:mm:ss"):a&&"object"===typeof a?a[r.model_display]:null!=a?a:"-"}))]}):null}));function Me(e){var t=e.isCreating,n=e.schema,c=Object(Y.k)(),a=Object(Y.m)(),i=a.model,s=a.id,o=Object(r.useContext)(L.a),u=x("/content-manager/".concat(i)),l=F((function(){return u.get(s)}),{});Object(r.useEffect)((function(){t||l.run()}),[t,s]);var b=Object(U.c)();Object(r.useEffect)((function(){l.error&&(b({title:"Server error",description:l.error,status:"error",duration:9e3,isClosable:!0}),l.setError(null))}),[l.error,l.resetError,b]);var d={isCreating:t,history:c,schema:n,id:s,model:i,toast:b,contentHandler:l,contentApi:u};return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(k.a,{children:[Object(m.jsx)(M.a,{fontSize:40,mb:4,children:l.result&&!t?"".concat(l.result[n.display]," (").concat(n.name,")"):n.name}),Object(m.jsx)(Le,Object(j.a)(Object(j.a)({},d),{},{children:Object(m.jsxs)(C.e,{flex:1,alignItems:"stretch",children:[Object(m.jsx)(C.a,{mb:4,children:Object(m.jsx)(E.a,{colorScheme:"red",onClick:function(){return c.goBack()},variant:"link",children:"Back"})}),Object.keys(o.components).filter((function(e){return e.startsWith("EditorAddon::")&&o.components[e]&&o.components[e].pos_before})).map((function(e){var t=o.components[e];return Object(m.jsx)(t,Object(j.a)({},d),e)})),Object(m.jsxs)(C.b,{direction:{sm:"column",xl:"row"},alignItems:{base:"stretch"},children:[Object(m.jsx)(ye,Object(j.a)({},d)),!t&&Object(m.jsx)(Se,Object(j.a)({},d))]}),Object.keys(o.components).filter((function(e){return e.startsWith("EditorAddon::")&&o.components[e]&&!o.components[e].pos_before})).map((function(e){var t=o.components[e];return Object(m.jsx)(t,Object(j.a)({},d),e)}))]})}))]})})}function Le(e){var t=e.children,n=e.isCreating,c=e.schema,a=e.id,i=e.contentHandler,s=e.contentApi,l=Object(Y.k)(),j=Object(r.useMemo)((function(){var e={};return Object.values(c.fields).forEach((function(t){null==t.default||t.auto||(e[t.key]=t.default)})),e}),[c]),b=function(e){if(!e)return null;var t={};return Object.keys(e.fields).forEach((function(n){var r=null;switch(e.fields[n].type){case"file_multi":r=V.array(V.lazy((function(e){switch(typeof e){case"object":return V.object({id:V.number().required()});default:return V.number().required()}})))}r&&(t[n]=r)})),V.object(t)}(c);return Object(m.jsx)(q.Formik,{initialValues:n?j:i.result,enableReinitialize:!0,validationSchema:b,onSubmit:function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.run(n?s.create(t):s.update(t,a));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:n&&l.replace("./"+r[c.primary]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:(n||!i.isLoading)&&Object(m.jsx)(q.Form,{children:t})},i.result&&i.result[c.primary])}var Pe=n(399),Fe=n(397),De=n(398),Ae=n(396);function Te(e){var t=e.page,n=e.max,r=e.onSelect,c=e.colorScheme;t=parseInt(t);var a=n<10?n:10,i=t-a/2<0?0:t+a/2>n?n-a:t-a/2;return 1===n&&1===t?null:Object(m.jsxs)(C.a,{mx:"auto",justifyContent:"center",w:"100%",children:[Object(m.jsx)(Ae.a,{colorScheme:c,icon:Object(m.jsx)(Fe.a,{}),variant:"ghost",onClick:function(){return r(1)},disabled:t<=1}),Array.apply(null,Array(a)).map((function(e,n){return Object(m.jsx)(E.a,{colorScheme:c,variant:n+i+1===t?"solid":"ghost",onClick:function(){return r(n+i+1)},children:n+i+1},n)})),Object(m.jsx)(Ae.a,{colorScheme:c,icon:Object(m.jsx)(De.a,{}),variant:"ghost",onClick:function(){return r(n)},disabled:t>=n})]})}var Ye={timestamp:function(e){return e?Ce()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},datetime:function(e){return e?Ce()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},date:function(e){return e?Ce()(new Date(e)).format("YYYY-MM-DD"):"-"},password:!1,relation_many:!1,file:!1,json:!1,bool:function(e){return e?"true":"false"},default:function(e,t){return e&&"object"===typeof e&&t.display?null!=e[t.display]?String(e[t.display]):"-":null==e?"-":String(e)},embedded_array:!1,file_multi:!1,relation_multi:!1};function ze(e){var t=e.schema,n=Object(Y.m)().model,c=Object(Y.k)(),a=new URLSearchParams(c.location.search).get("page")||1,i=x("/content-manager/".concat(n)),s=Object(r.useState)(0),b=Object(l.a)(s,2),d=b[0],f=b[1],h=F(i.list,[]),p=Object(r.useContext)(L.a);Object(r.useEffect)((function(){Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.runError(h.runStatus(i.get("count")));case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:f(t),h.run(i.send("?_limit=100&_start=".concat(100*(a-1))));case 7:case"end":return e.stop()}}),e)})))()}),[a,t]);var O={model:n,history:c,page:a,contentApi:i,contentHandler:h,plugins:p},v=Object(r.useMemo)((function(){return t&&t.listing&&Array.isArray(t.listing)?t.listing:t&&t.listing?[t.listing]:Object.keys(t.fields).filter((function(e){return!1!==Ye[t.fields[e].type]&&!t.fields[e].private&&t.fields[e].visible&&t.fields[e].listed}))}),[t]);return Object(m.jsxs)(k.a,{children:[Object(m.jsx)(M.a,{fontSize:40,mb:4,children:t.name}),Object(m.jsxs)(xe.a,{isLoaded:!h.isLoading,children:[Object.keys(p.components).filter((function(e){return e.startsWith("ListAddon::")&&p.components[e]&&p.components[e].pos_before})).map((function(e){var t=p.components[e];return Object(m.jsx)(t,Object(j.a)({},O),e)})),Object(m.jsx)(Te,{page:a,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return c.push("?page="+e)}}),Object(m.jsx)(C.a,{mb:6,children:t.editable&&Object(m.jsx)(E.a,{colorScheme:"red","aria-label":"Search database",onClick:function(){return c.push(c.location.pathname+"/create")},variant:"link",children:"New"})}),Object(m.jsxs)(Pe.a,{mb:6,children:[Object(m.jsx)(Pe.g,{children:Object(m.jsx)(Pe.h,{children:v.map((function(e){return Object(m.jsx)(Pe.f,{children:e},e)}))})}),Object(m.jsx)(Pe.c,{children:h.result&&h.result.map((function(e,n){return Object(m.jsx)(Pe.h,{onClick:function(){return t.editable&&c.push(c.location.pathname+"/"+e[t.primary])},children:v.map((function(n){return Object(m.jsx)(Pe.d,{children:t.fields[n]&&(Ye[t.fields[n].type]||Ye.default)(e[n],t.fields[n])},n)}))},e[t.primary]||n)}))})]}),Object(m.jsx)(Te,{page:a,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return c.push("?page="+e)}}),Object.keys(p.components).filter((function(e){return e.startsWith("ListAddon::")&&p.components[e]&&!p.components[e].pos_before})).map((function(e){var t=p.components[e];return Object(m.jsx)(t,Object(j.a)({},O),e)}))]})]})}function He(e){var t=e.match,n=Object(Y.m)().model,c=Object(r.useContext)(J),a=Object(r.useMemo)((function(){return c(n)}),[c,n]);return a&&Object(m.jsxs)(Y.g,{children:[Object(m.jsx)(Y.d,{path:"".concat(t.path,"/create"),children:Object(m.jsx)(Me,{isCreating:!0,schema:a},a.key)}),Object(m.jsx)(Y.d,{path:"".concat(t.path,"/:id"),children:Object(m.jsx)(Me,{isCreating:!1,schema:a},a.key)}),Object(m.jsx)(Y.d,{path:t.path,exact:!0,children:Object(m.jsx)(ze,{schema:a},a.key)})]})}function _e(){var e=Object(r.useContext)(v),t=Object(r.useContext)(L.a);return Object(m.jsxs)(Y.g,{children:[Object(m.jsx)(Y.d,{path:"/login",component:W}),Object(m.jsx)(Y.d,{path:"/content-type/:model",component:He}),Object(m.jsx)(m.Fragment,{children:t.routes.map((function(e,t){return Object(r.createElement)(Y.d,Object(j.a)(Object(j.a)({},e),{},{key:e.path}))}))}),!e.user&&Object(m.jsx)(Y.d,{children:Object(m.jsx)(Y.c,{to:"/login"})})]})}var Ie=n(321),Re=n(464),qe={components:{"Layout::title":"Phroper","Layout::ChakraProvider":null}},Ve=Object(Ie.createRequires)(Re.resolve),We=Object(Ie.createRemoteComponent)({requires:Ve});function Be(e){var t=e.children,n=Object(r.useState)([]),c=Object(l.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)([qe]),o=Object(l.a)(s,2),u=o[0],j=o[1];console.log(a);var b=x("/plugin-handler");Object(r.useEffect)((function(){b.list().then((function(e){return i(e)})).catch((function(e){}))}),[]);var d=Object(r.useContext)(p),f=Object(r.useCallback)((function(e){return j((function(t){return[].concat(Object(ie.a)(t),[e])}))}),[j]),h=Object(r.useCallback)((function(e){return j((function(t){return t.filter((function(t){return t!==e}))}))}),[j]),O=Object(r.useMemo)((function(){var e=[],t=[],n={};return u.forEach((function(r){r.routes&&r.routes.forEach((function(t){return e.push(t)})),r.menus&&r.menus.forEach((function(e){return t.push(e)})),r.components&&Object.keys(r.components).forEach((function(e){return n[e]=r.components[e]}))})),{routes:e,menus:t,components:n,registerPlugin:f,unregisterPlugin:h}}),[u,f,h]);return Object(m.jsxs)(L.a.Provider,{value:O,children:[Object(m.jsx)(k.a,{display:"none",children:a.map((function(e){return Object(m.jsx)(We,{url:d+"/plugin-handler/"+e,id:e},e)}))}),t]})}var Je=function(){return Object(m.jsx)(O,{children:Object(m.jsx)(Be,{children:Object(m.jsx)(T,{children:Object(m.jsx)(g,{children:Object(m.jsx)(N,{children:Object(m.jsx)(D,{children:Object(m.jsx)(_e,{})})})})})})})},Ne=(n(692),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,706)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))});i.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(Je,{})}),document.getElementById("root")),Ne()},698:function(e,t,n){"use strict";n.r(t),n.d(t,"PluginContext",(function(){return r.a})),n.d(t,"usePluginRegister",(function(){return a}));var r=n(59),c=n(0);function a(e){var t=Object(c.useContext)(r.a),n=t.registerPlugin,a=t.unregisterPlugin;console.log("register plugin",e),Object(c.useEffect)((function(){return n(e),function(){return a(e)}}),[e,n,a])}}},[[693,1,2]]]);
//# sourceMappingURL=main.16581bd8.chunk.js.map