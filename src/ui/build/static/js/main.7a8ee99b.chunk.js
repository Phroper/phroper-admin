(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{159:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var r=n(0),c=n.n(r),a=n(89),i=n(1),s=c.a.createContext();function o(e){var t=e.children,n="";if(window){var r=window.location.pathname;r.endsWith("/")||(r+="/"),r.includes("/admin/")&&(n=r.split("/admin/")[0])}return n+="/admin",console.log("LocationBackend",n),Object(i.jsx)(s.Provider,{value:n,children:Object(i.jsx)(a.BrowserRouter,{basename:n,children:t})})}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(14),c=n(3),a=n(73),i=n(138),s=n(245),o=n(33),u=n(316),l=n(0),j=n.n(l),b=n(1);function d(e){var t=e.message,n=e.children,l=e.onClick,d=e.acceptText,f=void 0===d?"Ok":d,h=e.cancelText,O=void 0===h?"Cancel":h,m=e.headerText,p=void 0===m?"":m,x=Object(a.a)(e,["message","children","onClick","acceptText","cancelText","headerText"]),g=j.a.useState(!1),v=Object(c.a)(g,2),y=v[0],w=v[1],k=function(){return w(!1)},C=j.a.useRef();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(i.a,Object(r.a)(Object(r.a)({colorScheme:"brand"},x),{},{onClick:function(){return w(!0)},children:n})),Object(b.jsx)(s.a,{isOpen:y,leastDestructiveRef:C,onClose:k,children:Object(b.jsx)(o.i,{children:Object(b.jsxs)(s.d,{children:[p&&Object(b.jsx)(o.h,{fontSize:"lg",fontWeight:"bold",children:p}),Object(b.jsx)(o.b,{children:t}),Object(b.jsx)(o.g,{children:Object(b.jsxs)(u.a,{w:"100%",justifyContent:"space-between",children:[Object(b.jsx)(i.a,{ref:C,onClick:k,children:O}),Object(b.jsx)(i.a,{colorScheme:"brand",onClick:function(){k(),l&&l.apply(void 0,arguments)},ml:3,children:f})]})})]})})})]})}},471:function(e,t,n){e.exports={resolve:{react:n(0),axios:n(303),formik:n(39),moment:n(114),yup:n(78),"phroper-admin":n(707),"framer-motion":n(72),"react-datepicker":n(307),"react-dom":n(49),"react-router-dom":n(89),"@chakra-ui/react":n(43),"@chakra-ui/icons":n(218),"@emotion/react":n(81),"@emotion/styled":n(315)}}},59:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(16),c=n.n(r),a=n(14),i=n(27),s=n(303),o=n.n(s),u=n(0),l=n(85),j=n(159);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(u.useContext)(l.b),r=Object(u.useContext)(j.a);e=r+e;var s=Object(u.useMemo)((function(){var r=function(){var e=Object(i.a)(c.a.mark((function e(r,i,s,u,l){var j,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j={},u&&"object"==typeof u&&Object.keys(u).forEach((function(e){"boolean"===typeof u[e]?j[e]=u[e]?1:0:null===u[e]?j[e+"_null"]=1:j[e]=u[e]})),e.next=5,o()({method:s,url:r,data:i,params:j,headers:t||(null===n||void 0===n?void 0:n.jwt)?Object(a.a)({Authorization:"Bearer "+(t||(null===n||void 0===n?void 0:n.jwt))},l):Object(a.a)({},l)});case 5:return b=e.sent,e.abrupt("return",b.data);case 9:if(e.prev=9,e.t0=e.catch(0),"401"===e.t0.code&&n.logout(),!e.t0.response||!e.t0.response.data||"object"!==typeof e.t0.response.data){e.next=14;break}throw new Error(e.t0.response.data.message);case 14:throw new Error("Server is not available.");case 15:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n,r,c,a){return e.apply(this,arguments)}}();return{list:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,null,"GET",n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),get:function(){var t=Object(i.a)(c.a.mark((function t(n,a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+n,null,"GET",a));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),create:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,n,"POST"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=Object(i.a)(c.a.mark((function t(n){var a,i=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:null,t.abrupt("return",r(e+"/"+(null==a?n.id:a),n,"PUT"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=Object(i.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+("object"===typeof n?n.id:n),null,"DELETE"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),send:function(){var t=Object(i.a)(c.a.mark((function t(n,a){var i,s,o,u=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:"GET",s=u.length>3&&void 0!==u[3]?u[3]:null,o=u.length>4&&void 0!==u[4]?u[4]:{},t.abrupt("return",r(e+"/"+n,a,i,s,o));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),[e,n,t]);return s}},60:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),c=n.n(r).a.createContext()},610:function(e,t,n){},679:function(e,t){},681:function(e,t){},701:function(e,t,n){},702:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(49),i=n.n(a),s=n(85),o=n(349),u=n(316),l=n(223),j=n(138),b=n(350),d=n(89),f=n(60),h=n(343),O=n(305),m=n(59),p=n(83),x=n(1),g=c.a.createContext();function v(e){var t=e.children,n=Object(m.a)("/content-schema/models"),c=Object(p.a)(n.list,null),a=Object(r.useContext)(s.b);Object(r.useEffect)((function(){return a.jwt&&c.run()}),[a.jwt]);var i=c.isLoading||!c.error&&a.user&&!c.result;return Object(x.jsxs)(x.Fragment,{children:[i&&Object(x.jsx)(h.b,{w:"100vw",h:"100vh",children:Object(x.jsx)(O.a,{})}),!i&&Object(x.jsx)(g.Provider,{value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?c.result&&c.result.find((function(t){return t.key===e})):c.result},children:t})]})}function y(e){var t=e.children,n=Object(r.useContext)(s.b),c=Object(r.useContext)(f.a),a=Object(r.useContext)(g)();return Object(x.jsxs)(o.a,{bg:"gray.100",minH:"100%",minW:"100%",w:"fit-content",children:[Object(x.jsxs)(o.a,{position:"fixed",left:0,px:3,w:"250px",top:0,h:"100%",bg:"brand.600",color:"white",overflow:"auto",zIndex:100,shadow:"md",children:[Object(x.jsx)(o.a,{fontSize:40,mb:6,w:"100%",textAlign:"center",children:Object(x.jsx)(d.Link,{to:"/",children:c.components["Layout::title"]})}),!n.user&&Object(x.jsxs)(u.a,{mb:6,children:[Object(x.jsx)(l.a,{mr:4}),Object(x.jsx)(u.e,{flex:1,alignItems:"flex-start",children:Object(x.jsx)(j.a,{as:d.Link,to:"/login",variant:"link",colorScheme:"white",onClick:n.logout,children:"login"})})]}),n.user&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(u.a,{mb:6,children:[Object(x.jsx)(l.a,{mr:4}),Object(x.jsxs)(u.e,{flex:1,alignItems:"flex-start",children:[Object(x.jsx)(b.a,{fontSize:20,children:n.user.username}),Object(x.jsx)(j.a,{variant:"link",colorScheme:"white",onClick:n.logout,children:"logout"})]})]}),a&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{fontSize:24,mb:2,children:"Content types"}),Object(x.jsx)(u.e,{pl:4,mb:2,alignItems:"flex-start",children:null===a||void 0===a?void 0:a.filter((function(e){return e.visible})).map((function(e){return Object(x.jsx)(d.Link,{to:"/content-type/".concat(e.key),children:e.name},e.key)}))})]}),c.menus&&c.menus.length>0&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(b.a,{fontSize:24,mb:2,children:"Plugins"}),Object(x.jsx)(u.e,{pl:4,mb:2,alignItems:"flex-start",children:c.menus.map((function(e){return Object(x.jsx)(d.Link,{to:"".concat(e.to),children:e.text},e.to)}))})]})]})]}),Object(x.jsx)(o.a,{ml:250,px:4,children:t})]})}var w=n(351),k=n(353),C=Object(w.a)({colors:{brand:{50:"#FFF5F5",100:"#FED7D7",200:"#FEB2B2",300:"#FC8181",400:"#F56565",500:"#E53E3E",600:"#C53030",700:"#9B2C2C",800:"#822727",900:"#63171B"}}});function S(e){var t=e.children,n=Object(r.useContext)(f.a).components["Layout::ChakraProvider"]||k.a;return Object(x.jsx)(n,{theme:C,children:t})}var E=n(159),F=n(14),M=n(19),L=n(16),P=n.n(L),D=n(27),A=n(375),T=n(179),z=n(90),I=n(376),Y=n(377),H=n(39),_=n(78);function R(){return Object(x.jsx)(o.a,{pt:"10vh",children:Object(x.jsxs)(A.a,{minH:10,p:0,bgColor:"gray.200",children:[Object(x.jsx)(b.a,{fontSize:32,p:2,bg:"brand.500",color:"white",mb:4,children:"Login"}),Object(x.jsx)(o.a,{p:4,children:Object(x.jsx)(B,{})})]})})}function B(){var e=Object(r.useContext)(s.b),t=Object(M.k)();return Object(x.jsx)(H.Formik,{validationSchema:_.object().shape({username:_.string().required("Username is required"),password:_.string().required("Password is required")}),initialValues:{username:"",password:""},onSubmit:function(){var n=Object(D.a)(P.a.mark((function n(r,c){var a,i;return P.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=c.setErrors,n.prev=1,n.next=4,e.login(r.username,r.password);case 4:for(i=t.location.state;i&&i.redirect&&"/login"===i.redirect.pathname;)i=i.redirect.state;i&&i.redirect?t.push(i.redirect.pathname,i.redirect.state):t.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),a({password:n.t0.message});case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}(),children:Object(x.jsx)(H.Form,{children:Object(x.jsxs)(u.b,{spacing:4,children:[t.location.state&&t.location.state.error&&Object(x.jsxs)(T.a,{status:"error",children:[Object(x.jsx)(T.c,{}),Object(x.jsx)(T.b,{children:t.location.state.error})]}),Object(x.jsxs)(z.a,{children:[Object(x.jsx)(I.a,{children:"Username"}),Object(x.jsx)(H.Field,{as:Y.a,bgColor:"white",type:"text",name:"username"}),Object(x.jsx)(H.ErrorMessage,{name:"username",component:b.a,color:"red"})]}),Object(x.jsxs)(z.a,{children:[Object(x.jsx)(I.a,{children:"Password"}),Object(x.jsx)(H.Field,{as:Y.a,bgColor:"white",type:"password",name:"password"}),Object(x.jsx)(H.ErrorMessage,{name:"password",component:b.a,color:"red"})]}),Object(x.jsx)(o.a,{textAlign:"right",pt:2,children:Object(x.jsx)(H.FormikConsumer,{children:function(e){var t=e.isSubmitting;return Object(x.jsx)(j.a,{isLoading:t,type:"submit",variant:"solid",colorScheme:"brand",children:"Log in"})}})})]})})})}var q=n(402);var V=n(228),W=n(225),N=n(73),J=n(401),U=n(382);var G=n(307),K=n.n(G),Q=(n(609),n(610),function(e){var t=e.onChange,n=e.isClearable,r=void 0!==n&&n,c=e.showPopperArrow,a=void 0!==c&&c,i=e.value,s=Object(N.a)(e,["onChange","isClearable","showPopperArrow","value"]);return Object(x.jsx)(o.a,{children:Object(x.jsx)(K.a,Object(F.a)({type:"date",selected:"string"===typeof i?new Date(i):i,onChange:t,isClearable:r,showPopperArrow:a},s))})}),X={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm",timestamp:"yyyy-MM-dd HH:mm:ss"};var Z=Object(H.connect)((function(e){var t=e.formik,n=e.schema,r=e.name,c=e.value;return Object(x.jsx)(Q,{name:r,onChange:function(e){return t.setFieldValue(r,e)},timeFormat:"HH:mm",dateFormat:X[n.type],showTimeSelect:"date"!==n.type,value:c})})),$=n(20),ee=n(3),te=n(393),ne=n(394),re=n(395),ce=n(392);function ae(e){var t=e.schema,n=e.isCreating,c=e.prefix;t=Object(r.useMemo)((function(){return t&&c?Object(F.a)(Object(F.a)({},t),{},{key:"".concat(c,".").concat(t.key)}):t}),[t,c]);var a=Object(r.useMemo)((function(){var e={};return Object.keys(t.fields).forEach((function(n){e[n]=c?Object(F.a)(Object(F.a)({},t.fields[n]),{},{key:"".concat(c,".").concat(t.fields[n].key)}):t.fields[n]})),e}),[t,c]);console.log("EmbeddedEditor",a);var i=t.grid||ae.grid;return Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(".concat(Math.min(2,i[0]),", 1fr)"),"2xl":"repeat(".concat(Math.min(3,i[0]),", 1fr)")},flex:1,gap:6,mb:6,children:Object.keys(a).map((function(e){return Object(x.jsx)(ie,{schema:a[e],isCreating:n},e)}))})}function ie(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=xe[e.schema.type])&&void 0!==t?t:xe.default;return n?Object(x.jsx)(n,Object(F.a)({},e)):null}function se(e){var t=e.formik,n=e.schema,c=(e.onChange,e.isCreating);console.log("EmbeddedSchemaArray",n);var a=n.key,i=t.values[a];i=Array.isArray(i)?i:[];var s=Object(r.useState)(-1),l=Object(ee.a)(s,2),b=l[0],d=l[1];return Object(x.jsxs)(o.a,{pl:3,borderLeft:"1px solid",borderColor:"brand.500",children:[Object(x.jsx)(ce.a,{allowToggle:!0,index:b,onChange:function(e){return d(e)},children:i.map((function(e,r){return Object(x.jsxs)(ce.d,{children:[Object(x.jsx)("h2",{children:Object(x.jsxs)(ce.b,{children:[Object(x.jsxs)(u.a,{w:"100%",justify:"space-between",children:[Object(x.jsx)(o.a,{flex:"1",textAlign:"left",children:n.display&&e&&"object"===typeof e?e[n.display]:r+1}),Object(x.jsxs)(o.a,{mr:2,children:[Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object($.a)(i.slice(0,r-1)),[i[r],i[r-1]],Object($.a)(i.slice(r+1))))},colorScheme:"brand",variant:"ghost",disabled:0===r,children:Object(x.jsx)(te.a,{})}),Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object($.a)(i.slice(0,r)),Object($.a)(i.slice(r+1))))},colorScheme:"brand",variant:"ghost",children:Object(x.jsx)(ne.a,{})}),Object(x.jsx)(j.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object($.a)(i.slice(0,r)),[i[r+1],i[r]],Object($.a)(i.slice(r+2))))},colorScheme:"brand",variant:"ghost",disabled:r===i.length-1,children:Object(x.jsx)(re.a,{})})]})]}),Object(x.jsx)(ce.c,{})]})}),Object(x.jsx)(ce.e,{pb:4,children:Object(x.jsx)(ae,{schema:n,isCreating:c,prefix:"".concat(n.key,"[").concat(r,"]")})})]},r)}))}),Object(x.jsx)(j.a,{w:"100%",colorScheme:"brand",variant:"ghost",fontSize:"3xl",onClick:function(){t.setFieldValue("".concat(a,"[").concat(i.length,"]"),null),d(i.length)},children:"+"})]})}function oe(e){var t=e.schema,n=e.isCreating;return Object(x.jsx)(o.a,{pl:3,flex:1,borderLeft:"1px solid",borderColor:"brand.500",children:Object(x.jsx)(ae,{schema:t,isCreating:n,prefix:t.key})})}ae.grid=[3,1],se.grid=ae.grid,oe.grid=ae.grid;var ue=n(396);var le=n(398),je=n(399);function be(e){var t=e.name,n=e.value,c=e.onChange,a=Object(r.useState)(!1),i=Object(ee.a)(a,2),s=i[0],u=i[1],l=Object(m.a)("/../api/file-upload"),b=Object(p.a)();Object(r.useEffect)((function(){var e=n&&"object"==typeof n?n.id:n;e?b.run(l.get(e)):b.setResult(null)}),[n]);var d=Object(r.useCallback)(function(){var e=Object(D.a)(P.a.mark((function e(n){var r,a;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),n.preventDefault(),u(!1),!n.dataTransfer.items||1!==n.dataTransfer.items.length||"file"!==n.dataTransfer.items[0].kind){e.next=10;break}return(r=new FormData).append("file",n.dataTransfer.files[0]),e.next=8,b.run(l.send("upload",r,"POST",{"Content-Type":"multipart/form-data"}));case 8:a=e.sent,c&&c({target:{value:a.id,name:t}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[u,t,c,b,l]);return Object(x.jsx)(le.a,{bg:"gray.800",borderRadius:4,overflow:"hidden",borderColor:"gray.500",ratio:16/9,children:Object(x.jsxs)(o.a,{children:[b.result&&b.result.filename&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",children:Object(x.jsx)(je.a,{src:b.result.filename})}),Object(x.jsx)(H.ErrorMessage,{name:t,children:function(e){return Object(x.jsx)(o.a,{w:"100%",h:"100%",bg:"brand.800",color:"white",p:4,children:e,position:"absolute"})}}),b.isLoading&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",children:Object(x.jsx)(O.a,{size:"lg",color:"white"})}),s&&Object(x.jsx)(h.b,{position:"absolute",h:"100%",w:"100%",bg:s?"#88888866":null,children:Object(x.jsx)(te.a,{color:"white",fontSize:100})}),Object(x.jsx)(o.a,{w:"100%",h:"100%",onDragOver:function(e){e.preventDefault(),u(!0)},onDragLeave:function(){return u(!1)},onDrop:d,position:"absolute",display:"flex",flexDir:"row-reverse",children:n&&Object(x.jsx)(o.b,{size:"1.75em",m:1.5,overflow:"hidden",children:Object(x.jsx)(j.a,{colorScheme:"brand",onClick:function(){return c&&c({target:{value:null,name:t}})},children:Object(x.jsx)(ne.a,{})})})})]})})}be.grid=[1,2];n(668);var de=n(328),fe=(n(669),n(470)),he=n.n(fe);function Oe(e){var t=e.value,n=e.formik,c=e.name,a=(e.onBlur,e.onFocus,Object(r.useState)(JSON.stringify(t,null,2))),i=Object(ee.a)(a,2),s=i[0],o=i[1],u=Object(r.useState)(!1),l=Object(ee.a)(u,2),j=l[0],b=l[1],d=n.setFieldValue;return Object(r.useEffect)((function(){var e=setTimeout((function(){e=0;try{var t=JSON.parse(s);d(c,t),b(!1)}catch(n){d(c,n),b(!0)}}),250);return function(){return e&&clearTimeout(e)}}),[s,d,c]),Object(x.jsx)(he.a,{value:s,onValueChange:o,padding:16,onBlur:function(){return!j&&o(JSON.stringify(t,null,2))},highlight:function(e){return Object(de.highlight)(e||"",de.languages.json)},style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:14,background:j?"#6c223d":"#3c526d",flex:1,transition:"background-color 0.25s linear"},preClassName:"language-json"})}Oe.grid=[1,5];var me=n(400);function pe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(H.connect)((function(n){var r=n.schema,c=n.isCreating,a=Object(N.a)(n,["schema","isCreating"]),i=c?r.auto:r.readonly;if(r.auto&&r.readonly)return null;var s=r.grid&&(Array.isArray(r.grid)?r.grid:[r.grid,1])||e&&e.grid||[1,1];return e&&Object(x.jsx)(V.b,{colSpan:{sm:1,lg:Math.min(2,s[0]),"2xl":Math.min(3,s[0])},rowSpan:s[1],minH:"".concat(2.5+4*(s[1]-1),"em"),h:"100%",children:Object(x.jsxs)(z.a,{minW:"20%",h:"100%",display:"flex",flexDir:"column",children:[Object(x.jsx)(I.a,{children:r.name}),Object(x.jsx)(H.Field,Object(F.a)(Object(F.a)({as:e,name:r.key,placeholder:r.name,disabled:i,schema:r,required:!i&&r.required&&(!r.private||c)},a),t||{})),Object(x.jsx)(H.ErrorMessage,{component:b.a,color:"red.500",name:r.key})]})})}))}var xe={default:pe(Y.a),email:pe(Y.a,{type:"email"}),password:pe(Y.a,{type:"password"}),textarea:pe(J.a,{resize:"none"}),bool:pe((function(e){var t=e.formik,n=e.name,r=Object(N.a)(e,["formik","name"]);return console.log("renderbool"),Object(x.jsx)(U.a,Object(F.a)(Object(F.a)({size:"lg",colorScheme:"brand"},r),{},{log:console.log(t),isChecked:t.values&&t.values[n],onChange:function(){return t.setFieldValue(n,!(t.values&&t.values[n]))}}))})),enum:pe((function(e){var t=e.schema,n=(e.placeholder,Object(N.a)(e,["schema","placeholder"]));return Object(x.jsx)(ue.b,Object(F.a)(Object(F.a)({},n),{},{children:t.values.map((function(e){return Object(x.jsx)("option",{value:e,children:e})}))}))})),relation_one:pe((function(e){var t=e.schema,n=(e.placeholder,e.value),c=Object(N.a)(e,["schema","placeholder","value"]),a=Object(r.useContext)(g),i=Object(r.useMemo)((function(){return a(t.model)}),[a,t]),s=Object(p.a)(Object(m.a)("/content-manager/".concat(t.model).concat(n?"?".concat(i.primary,"_sort=").concat(n):"")).list);Object(r.useEffect)(s.run,[t]),n&&"object"===typeof n&&(n=n[i.primary]);var o=s.result,u=Object(r.useMemo)((function(){return i&&o&&Array.isArray(o)&&o.map((function(e){return Object(x.jsx)("option",{value:e[i.primary],children:e[i.display]},e[i.primary])}))}),[i,o]);return s.isLoading?Object(x.jsx)(me.a,{h:8}):Object(x.jsxs)(ue.b,Object(F.a)(Object(F.a)({value:n||""},c),{},{children:[Object(x.jsx)("option",{value:"",children:"-"}),u]}))})),relation_many:!1,file:pe(be),file_multi:pe((function(e){var t=e.formik,n=e.schema,r=(e.onChange,n.key);console.log(t);var c=t.values[r];return c=Array.isArray(c)?c:[],Object(x.jsx)(z.a,{minW:"20%",children:Object(x.jsx)(ce.a,{allowMultiple:!0,children:Object(x.jsxs)(ce.d,{children:[Object(x.jsx)("h2",{children:Object(x.jsx)(ce.b,{children:Object(x.jsx)(ce.c,{})})}),Object(x.jsxs)(ce.e,{pb:4,children:[Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:c.map((function(e,n){return Object(x.jsx)(be,{value:e,name:"".concat(r,"[").concat(n,"]"),onChange:function(e){return t.setFieldValue(e.target.name,e.target.value)}},n)}))}),Object(x.jsx)(j.a,{onClick:function(){return t.setFieldValue("".concat(r,"[").concat(c.length,"]"),null)},children:"New"})]})]})})})})),embedded_object:pe(oe),embedded_array:pe(se),date:pe(Z),datetime:pe(Z),timestamp:pe(Z),json:pe(Oe)};function ge(e){var t=e.schema,n=e.isCreating,r=e.contentHandler,c=e.contentApi,a=e.id,i=Object(M.k)();return Object(x.jsxs)(u.e,{p:4,bg:"white",shadow:"md",flex:1,alignItems:"stretch",children:[Object(x.jsx)(V.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:Object.keys(t.fields).map((function(e){return Object(x.jsx)(ve,{schema:t.fields[e],isCreating:n},e)}))}),Object(x.jsxs)(u.a,{w:"100%",justifyContent:"space-between",children:[!n&&Object(x.jsx)(W.a,{type:"button",colorScheme:"brand",headerText:"Deleting",message:"Are you sure? This action can not be undone!",onClick:function(){return r.run(Object(D.a)(P.a.mark((function e(){return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.delete(a);case 2:i.goBack();case 3:case"end":return e.stop()}}),e)}))))},children:"Delete"}),Object(x.jsx)(j.a,{type:"submit",colorScheme:"green",children:"Save"})]})]})}function ve(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=xe[e.schema.type])&&void 0!==t?t:xe.default;return n?Object(x.jsx)(n,Object(F.a)({},e)):null}var ye=n(114),we=n.n(ye);function ke(e){var t=e.schema,n=Object(r.useMemo)((function(){return Object.keys(t.fields).filter((function(e){var n=t.fields[e];return n.auto&&n.readonly&&!1!==n.visible}))}),[t]);return 0===n.length?null:Object(x.jsxs)(o.a,{minW:"350px",p:4,bg:"white",shadow:"md",children:[Object(x.jsx)(b.a,{fontWeight:"bold",fontSize:20,children:"Information"}),n.map((function(e){return Object(x.jsx)(Ce,{schema:t.fields[e],name:t.fields[e].key},e)}))]})}var Ce=Object(H.connect)((function(e){var t=e.name,n=(e.value,e.formik),r=e.schema,c=Object(N.a)(e,["name","value","formik","schema"]),a=n.values&&n.values[t];return Object(x.jsxs)(z.a,{children:[Object(x.jsx)(I.a,{children:r.name}),Object(x.jsx)(b.a,Object(F.a)(Object(F.a)({},c),{},{children:a&&"date"===r.type?we()(new Date(a)).format("YYYY-MM-DD"):a&&"datetime"===r.type||a&&"timestamp"===r.type?we()(new Date(a)).format("YYYY-MM-DD HH:mm:ss"):a&&"object"===typeof a?a[r.display]:null!=a?a:"-"}))]})}));function Se(e){var t=e.isCreating,n=e.schema,c=Object(M.k)(),a=Object(M.m)(),i=a.model,s=a.id,l=Object(r.useContext)(f.a),d=Object(m.a)("/content-manager/".concat(i)),h=Object(p.a)((function(){return d.get(s)}),{});Object(r.useEffect)((function(){t||h.run()}),[t,s]);var O=Object(q.c)();Object(r.useEffect)((function(){h.error&&(O({title:"Server error",description:h.error,status:"error",duration:9e3,isClosable:!0}),h.setError(null))}),[h.error,h.resetError,O]);var g={isCreating:t,history:c,schema:n,id:s,model:i,toast:O,contentHandler:h,contentApi:d};return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(o.a,{children:[Object(x.jsx)(b.a,{fontSize:40,children:h.result&&!t?"".concat(h.result[n.display]," (").concat(n.name,")"):n.name}),Object(x.jsx)(Ee,Object(F.a)(Object(F.a)({},g),{},{children:Object(x.jsxs)(u.e,{py:4,flex:1,alignItems:"stretch",spacing:4,children:[Object(x.jsx)(u.a,{children:Object(x.jsx)(j.a,{colorScheme:"brand",onClick:function(){return c.goBack()},variant:"link",children:"Back"})}),Object.keys(l.components).filter((function(e){return e.startsWith("EditorAddon::")&&l.components[e]&&l.components[e].pos_before})).map((function(e){var t=l.components[e];return Object(x.jsx)(t,Object(F.a)({},g),e)})),Object(x.jsxs)(u.b,{direction:{sm:"column",xl:"row"},alignItems:{base:"stretch"},spacing:4,children:[Object(x.jsx)(ge,Object(F.a)({},g)),!t&&Object(x.jsx)(ke,Object(F.a)({},g))]}),Object.keys(l.components).filter((function(e){return e.startsWith("EditorAddon::")&&l.components[e]&&!l.components[e].pos_before})).map((function(e){var t=l.components[e];return Object(x.jsx)(t,Object(F.a)({},g),e)}))]})}))]})})}function Ee(e){var t=e.children,n=e.isCreating,c=e.schema,a=e.id,i=e.contentHandler,s=e.contentApi,o=Object(M.k)(),u=Object(r.useMemo)((function(){var e={};return Object.values(c.fields).forEach((function(t){null==t.default||t.auto||(e[t.key]=t.default)})),e}),[c]),l=function(e){if(!e)return null;var t={};return Object.keys(e.fields).forEach((function(n){var r=null;switch(e.fields[n].type){case"file_multi":r=_.array(_.lazy((function(e){switch(typeof e){case"object":return _.object({id:_.number().required()});default:return _.number().required()}})));break;case"json":r=_.mixed().test("has-no-error",(function(e){return!(e instanceof Error)}))}r&&(t[n]=r)})),_.object(t)}(c);return Object(x.jsx)(H.Formik,{initialValues:n?u:i.result,enableReinitialize:!0,validationSchema:l,onSubmit:function(){var e=Object(D.a)(P.a.mark((function e(t){var r;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.run(n?s.create(t):s.update(t,a));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:r[c.primary]!==a&&o.replace("./"+r[c.primary]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:(n||!i.isLoading)&&Object(x.jsx)(H.Form,{children:t})},i.result&&i.result[c.primary])}var Fe=n(407),Me=n(405),Le=n(406),Pe=n(404);function De(e){var t=e.page,n=e.max,r=e.onSelect,c=e.colorScheme;t=parseInt(t);var a=n<10?n:10,i=t-a/2<0?0:t+a/2>n?n-a:t-a/2;return 1===n&&1===t?null:Object(x.jsxs)(u.a,{mx:"auto",justifyContent:"center",w:"100%",size:"sm",children:[Object(x.jsx)(Pe.a,{colorScheme:c,icon:Object(x.jsx)(Me.a,{}),variant:"ghost",onClick:function(){return r(1)},disabled:t<=1,size:"sm"}),Array.apply(null,Array(a)).map((function(e,n){return Object(x.jsx)(j.a,{size:"sm",colorScheme:c,variant:n+i+1===t?"solid":"ghost",onClick:function(){return r(n+i+1)},children:n+i+1},n)})),Object(x.jsx)(Pe.a,{colorScheme:c,icon:Object(x.jsx)(Le.a,{}),variant:"ghost",onClick:function(){return r(n)},disabled:t>=n,size:"sm"})]})}var Ae={timestamp:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},datetime:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},date:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD"):"-"},password:!1,relation_many:!1,file:!1,json:!1,bool:function(e){return e?"true":"false"},default:function(e,t){return e&&"object"===typeof e&&t.display?null!=e[t.display]?String(e[t.display]):"-":null==e?"-":String(e)},embedded_array:!1,file_multi:!1,relation_multi:!1};function Te(e){var t=e.schema,n=Object(M.m)().model,c=Object(M.k)(),a=new URLSearchParams(c.location.search).get("page")||1,i=Object(m.a)("/content-manager/".concat(n)),s=Object(r.useState)(0),l=Object(ee.a)(s,2),d=l[0],h=l[1],O=Object(p.a)(i.list,[]),g=Object(r.useContext)(f.a);Object(r.useEffect)((function(){Object(D.a)(P.a.mark((function e(){var t;return P.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.runError(O.runStatus(i.get("count")));case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:h(t),O.run(i.list({_limit:100,_start:100*(a-1)}));case 7:case"end":return e.stop()}}),e)})))()}),[a,t]);var v={model:n,history:c,page:a,contentApi:i,contentHandler:O,plugins:g},y=Object(r.useMemo)((function(){return t&&t.listing&&Array.isArray(t.listing)?t.listing:t&&t.listing?[t.listing]:Object.keys(t.fields).filter((function(e){return!1!==Ae[t.fields[e].type]&&!t.fields[e].private&&t.fields[e].visible&&t.fields[e].listed}))}),[t]);return Object(x.jsxs)(o.a,{children:[Object(x.jsx)(b.a,{fontSize:40,children:t.name}),Object(x.jsx)(me.a,{isLoaded:!O.isLoading,children:Object(x.jsxs)(u.e,{py:4,flex:1,alignItems:"stretch",spacing:4,children:[t.editable&&Object(x.jsx)(u.a,{children:Object(x.jsx)(j.a,{colorScheme:"brand","aria-label":"Search database",onClick:function(){return c.push(c.location.pathname+"/create")},variant:"link",children:"New"})}),Object.keys(g.components).filter((function(e){return e.startsWith("ListAddon::")&&g.components[e]&&g.components[e].pos_before})).map((function(e){var t=g.components[e];return Object(x.jsx)(t,Object(F.a)({},v),e)})),Object(x.jsxs)(u.e,{spacing:4,alignItems:"stretch",alignSelf:"flex-start",minW:"100%",bg:"white",shadow:"md",p:4,overflow:"visible",children:[Object(x.jsx)(De,{page:a,max:Math.ceil(d/100)||1,colorScheme:"brand",onSelect:function(e){return c.push("?page="+e)}}),Object(x.jsxs)(Fe.a,{children:[Object(x.jsx)(Fe.g,{bg:"white",children:Object(x.jsx)(Fe.h,{children:y.map((function(e){return Object(x.jsx)(Fe.f,{children:e},e)}))})}),Object(x.jsx)(Fe.c,{children:O.result&&O.result.map((function(e,n){return Object(x.jsx)(Fe.h,{onClick:function(){return t.editable&&c.push(c.location.pathname+"/"+e[t.primary])},bg:"white",m:1,children:y.map((function(n){return Object(x.jsx)(Fe.d,{children:t.fields[n]&&(Ae[t.fields[n].type]||Ae.default)(e[n],t.fields[n])},n)}))},e[t.primary]||n)}))})]}),Object(x.jsx)(De,{page:a,max:Math.ceil(d/100)||1,colorScheme:"brand",onSelect:function(e){return c.push("?page="+e)}})]}),Object.keys(g.components).filter((function(e){return e.startsWith("ListAddon::")&&g.components[e]&&!g.components[e].pos_before})).map((function(e){var t=g.components[e];return Object(x.jsx)(t,Object(F.a)({},v),e)}))]})})]})}function ze(e){var t=e.match,n=Object(M.m)().model,c=Object(r.useContext)(g),a=Object(r.useMemo)((function(){return c(n)}),[c,n]);return a&&Object(x.jsxs)(M.g,{children:[Object(x.jsx)(M.d,{path:"".concat(t.path,"/create"),children:Object(x.jsx)(Se,{isCreating:!0,schema:a},a.key)}),Object(x.jsx)(M.d,{path:"".concat(t.path,"/:id"),children:Object(x.jsx)(Se,{isCreating:!1,schema:a},a.key)}),Object(x.jsx)(M.d,{path:t.path,exact:!0,children:Object(x.jsx)(Te,{schema:a},a.key)})]})}function Ie(){var e=Object(r.useContext)(s.b),t=Object(r.useContext)(f.a);return Object(x.jsxs)(M.g,{children:[Object(x.jsx)(M.d,{path:"/login",component:R}),!e.user&&t.routes.filter((function(e){return e&&e.without_login})).map((function(e,t){return Object(r.createElement)(M.d,Object(F.a)(Object(F.a)({},e),{},{key:e.path}))})),!e.user&&Object(x.jsx)(M.d,{path:"/",render:function(){return Object(x.jsx)(M.c,{path:"*",to:"/login"})}}),e.user&&Object(x.jsx)(M.d,{path:"/content-type/:model",component:ze}),e.user&&t.routes.map((function(e,t){return Object(r.createElement)(M.d,Object(F.a)(Object(F.a)({},e),{},{key:e.path}))}))]})}var Ye=n(9),He=n(329),_e=n(471),Re={components:{"Layout::title":"Phroper","Layout::ChakraProvider":null}},Be=Object(He.createRequires)(_e.resolve),qe=Object(He.createRemoteComponent)({requires:Be});function Ve(e){var t=e.children,n=Object(r.useState)(null),a=Object(ee.a)(n,2),i=a[0],s=a[1],u=Object(r.useState)([Re]),l=Object(ee.a)(u,2),j=l[0],b=l[1],d=Object(m.a)("/plugin-handler");Object(r.useEffect)((function(){d.list().then((function(e){return s(e)})).catch((function(e){return s([])}))}),[]);var h=Object(r.useContext)(E.a),O=Object(r.useCallback)((function(e){return b((function(t){return[].concat(Object($.a)(t),[e])}))}),[b]),p=Object(r.useCallback)((function(e){return b((function(t){return t.filter((function(t){return t!==e}))}))}),[b]),g=Object(r.useMemo)((function(){var e=[],t=[],n={};return j.forEach((function(r){r.routes&&r.routes.forEach((function(t){return e.push(t)})),r.menus&&r.menus.forEach((function(e){return t.push(e)})),r.components&&Object.keys(r.components).forEach((function(e){return n[e]=r.components[e]}))})),{routes:e,menus:t,components:n,registerPlugin:O,unregisterPlugin:p,pluginIds:i}}),[j,O,i,p]),v=Object(r.useState)(null),y=Object(ee.a)(v,2),w=y[0],k=y[1],C=Object(r.useState)({}),S=Object(ee.a)(C,2),M=S[0],L=S[1],P=i&&i.reduce((function(e,t){return e&&M[t]}),!0),D=Object(r.useMemo)((function(){return i&&i.map((function(e){return Object(x.jsx)(qe,{url:h+"/plugin-handler/"+e,render:function(t){var n=t.err,r=t.Component;return n?(console.error("Plugin loading error",e,n),setTimeout((function(){k((function(t){return Object(F.a)(Object(F.a)({},t||{}),{},Object(Ye.a)({},e,n))}))}),0),null):(setTimeout((function(){L((function(t){return t[e]?t:Object(F.a)(Object(F.a)({},t),{},Object(Ye.a)({},e,!0))}))}),0),Object(x.jsx)(r,{id:e}))}},e)}))}),[i,h]);return Object(x.jsxs)(f.a.Provider,{value:g,children:[Object(x.jsx)(o.a,{display:"none",children:D}),w&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("h1",{children:"Plugin loading errors"}),Object.keys(w).map((function(e){return Object(x.jsxs)(c.a.Fragment,{children:[Object(x.jsxs)("h2",{children:["[",e,"]"]}),Object(x.jsx)("pre",{children:w[e].stack})]},e)}))]}),P&&!w&&t]})}var We=function(){return Object(x.jsx)(E.b,{children:Object(x.jsx)(Ve,{children:Object(x.jsx)(S,{children:Object(x.jsx)(s.a,{children:Object(x.jsx)(v,{children:Object(x.jsx)(y,{children:Object(x.jsx)(Ie,{})})})})})})})},Ne=(n(701),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,715)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))});i.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(We,{})}),document.getElementById("root")),Ne()},707:function(e,t,n){"use strict";n.r(t),n.d(t,"PluginContext",(function(){return i.a})),n.d(t,"usePluginRegister",(function(){return o})),n.d(t,"useRequest",(function(){return c.a})),n.d(t,"useRequestRunner",(function(){return a.a})),n.d(t,"AlertButton",(function(){return r.a}));var r=n(225),c=n(59),a=n(83),i=n(60),s=n(0);function o(e){var t=Object(s.useContext)(i.a),n=t.registerPlugin,r=t.unregisterPlugin;Object(s.useEffect)((function(){return n(e),function(){return r(e)}}),[e,n,r])}},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(16),c=n.n(r),a=n(14),i=n(27),s=n(3),o=n(0);function u(e){var t=Object(o.useState)(e),n=Object(s.a)(t,2),r=n[0],c=n[1],a=Object(o.useRef)(!1),i=Object(o.useCallback)((function(e){a.current&&c(e)}),[c,a]);return Object(o.useEffect)((function(){return a.current=!0,function(){a.current=!1}}),[a]),[r,i]}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=u({error:null,result:t,isLoading:!1,isSuccess:!1}),r=Object(s.a)(n,2),l=r[0],j=r[1],b=Object(o.useCallback)(Object(i.a)(c.a.mark((function e(){var t,n=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,"function"!==typeof t){e.next=6;break}return e.next=5,t();case 5:t=e.sent;case 6:if(!(t instanceof Promise)){e.next=10;break}return e.next=9,t;case 9:t=e.sent;case 10:return e.abrupt("return",t);case 13:return e.prev=13,e.t0=e.catch(1),j((function(t){return Object(a.a)(Object(a.a)({},t),{},{error:e.t0.message})})),e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),[j]),d=Object(o.useCallback)(Object(i.a)(c.a.mark((function e(){var t,n,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:null,e.prev=1,n=null,"function"!==typeof t){e.next=9;break}return e.next=6,t();case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t;case 11:n=e.sent;case 12:return j((function(e){return Object(a.a)(Object(a.a)({},e),{},{result:n})})),e.abrupt("return",n);case 16:throw e.prev=16,e.t0=e.catch(1),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),[j]),f=Object(o.useRef)(null),h=Object(o.useCallback)(function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t instanceof Promise?t:Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),f.current=n,e.prev=2,j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!0,isSuccess:!1})})),e.next=6,n;case 6:return r=e.sent,j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,isSuccess:!0})})),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(2),f.current===n&&(f.current=null),j((function(e){return Object(a.a)(Object(a.a)({},e),{},{isLoading:!1,isSuccess:!1})})),e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),[j,f]),O=Object(o.useCallback)(Object(i.a)(c.a.mark((function t(){var n,r=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=r.length>0&&void 0!==r[0]?r[0]:null)&&(n=e),t.abrupt("return",b((function(){return h((function(){return d(n)}))})));case 3:case"end":return t.stop()}}),t)}))),[e,d,b,h]);return{isLoading:l.isLoading,result:l.result,error:l.error,isSuccess:l.isSuccess,isDisplayable:!l.isLoading&&!l.error,run:O,runError:b,runResult:d,runStatus:h,setError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return j((function(t){return Object(a.a)(Object(a.a)({},t),{},{error:e instanceof Error?e.message:e})}))},setResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return j((function(t){return Object(a.a)(Object(a.a)({},t),{},{result:e})}))}}}},85:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(16),c=n.n(r),a=n(27),i=n(3),s=n(0),o=n.n(s),u=n(14),l=function(e,t){var n=Object(s.useMemo)((function(){var n=t;try{localStorage.getItem(e)?n=JSON.parse(localStorage.getItem(e)):localStorage.setItem(e,JSON.stringify(t))}catch(r){localStorage.setItem(e,JSON.stringify(t))}return n}),[]),r=Object(s.useState)({isInitialized:!0,value:n}),c=Object(i.a)(r,2),a=c[0],o=c[1];return[a.value,function(t){Object.is(a.value,t)||(t="function"===typeof t?t(a.value):t,localStorage.setItem(e,JSON.stringify(t)),o(Object(u.a)(Object(u.a)({},a),{},{value:t})))}]},j=n(59),b=n(1),d=o.a.createContext({});function f(e){var t=e.children,n=l("auth-state",{user:null,jwt:null}),r=Object(i.a)(n,2),o=r[0],u=r[1],f=Object(j.a)("/../api/auth",o.jwt),h=Object(s.useState)(!1),O=Object(i.a)(h,2),m=O[0],p=O[1];Object(s.useEffect)((function(){o.jwt?f.get("me").then((function(e){return u((function(t){return{user:e||null,jwt:e?t.jwt:null}}))})).catch((function(e){return u({user:null,jwt:null})})).then((function(){return p(!0)})):p(!0)}),[!!o.jwt]);var x=Object(s.useCallback)((function(){u({user:null,jwt:null})}),[u]),g=function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(),e.next=3,f.send("login",{username:t,password:n},"POST");case 3:r=e.sent,u({user:r.user,jwt:r.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(a.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(),e.next=3,f.send("register",{username:t.username,password:t.password,name:t.name,email:t.email},"POST");case 3:n=e.sent,u({user:n.user,jwt:n.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(b.jsx)(d.Provider,{value:{user:o.user,jwt:o.jwt,login:g,logout:x,register:v},children:m&&t})}}},[[702,1,2]]]);
//# sourceMappingURL=main.7a8ee99b.chunk.js.map