(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{279:function(e,t,n){},379:function(e,t,n){},437:function(e,t,n){},438:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(39),i=n.n(c),s=n(484),o=n(11),l=n.n(o),u=n(21),j=n(6),d=n(10),b=function(e,t){var n=Object(r.useMemo)((function(){var n=t;try{localStorage.getItem(e)?n=JSON.parse(localStorage.getItem(e)):localStorage.setItem(e,JSON.stringify(t))}catch(r){localStorage.setItem(e,JSON.stringify(t))}return n}),[]),a=Object(r.useState)({isInitialized:!0,value:n}),c=Object(j.a)(a,2),i=c[0],s=c[1];return[i.value,function(t){Object.is(i.value,t)||(t="function"===typeof t?t(i.value):t,localStorage.setItem(e,JSON.stringify(t)),s(Object(d.a)(Object(d.a)({},i),{},{value:t})))}]},f=n(225),h=n.n(f),p=n(77),O=n(1),m=a.a.createContext();function x(e){var t=e.children,n="";if(window){var r=window.location.pathname;r.endsWith("/")||(r+="/"),r.includes("/admin/")&&(n=r.split("/admin/")[0])}return n+="/admin",console.log("LocationBackend",n),Object(O.jsx)(m.Provider,{value:n,children:Object(O.jsx)(p.a,{basename:n,children:t})})}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(r.useContext)(g),a=Object(r.useContext)(m);e=a+e;var c=Object(r.useMemo)((function(){var r=function(){var e=Object(u.a)(l.a.mark((function e(r,a,c,i){var s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h()({method:c,url:r,data:a,headers:t||(null===n||void 0===n?void 0:n.jwt)?Object(d.a)({Authorization:"Bearer "+(t||(null===n||void 0===n?void 0:n.jwt))},i):Object(d.a)({},i)});case 3:return s=e.sent,e.abrupt("return",s.data);case 7:if(e.prev=7,e.t0=e.catch(0),"401"===e.t0.code&&n.logout(),!e.t0.response||!e.t0.response.data||"object"!==typeof e.t0.response.data){e.next=12;break}throw new Error(e.t0.response.data.message);case 12:throw new Error("Server is not available.");case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,r,a){return e.apply(this,arguments)}}();return{list:function(){var t=Object(u.a)(l.a.mark((function t(){var n,a=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:null,t.abrupt("return",r(e+(n?"?page=".concat(n):""),null,"GET"));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),get:function(){var t=Object(u.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+n,null,"GET"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),create:function(){var t=Object(u.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e,n,"POST"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),update:function(){var t=Object(u.a)(l.a.mark((function t(n){var a,c=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:null,t.abrupt("return",r(e+"/"+(null==a?n.id:a),n,"PUT"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),delete:function(){var t=Object(u.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r(e+"/"+("object"===typeof n?n.id:n),null,"DELETE"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),send:function(){var t=Object(u.a)(l.a.mark((function t(n,a){var c,i,s=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=s.length>2&&void 0!==s[2]?s[2]:"GET",i=s.length>3&&void 0!==s[3]?s[3]:{},t.abrupt("return",r(e+"/"+n,a,c,i));case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}}),[e,n,t]);return c}var g=a.a.createContext({});function y(e){var t=e.children,n=b("auth-state",{user:null,jwt:null}),a=Object(j.a)(n,2),c=a[0],i=a[1],s=v("/../api/auth",c.jwt),o=Object(r.useCallback)((function(){i({user:null,jwt:null})}),[i]),d=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.next=3,s.send("login",{username:t,password:n},"POST");case 3:r=e.sent,i({user:r.user,jwt:r.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(),e.next=3,s.send("register",{username:t.username,password:t.password,name:t.name,email:t.email},"POST");case 3:n=e.sent,i({user:n.user,jwt:n.jwt});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsx)(g.Provider,{value:{user:c.user,jwt:c.jwt,login:d,logout:o,register:f},children:t})}var w=n(454),k=n(455),C=n(456),S=n(485),M=n(457),D=n(458),E=n(240);function L(e){var t=Object(r.useState)(e),n=Object(j.a)(t,2),a=n[0],c=n[1],i=Object(r.useRef)(!1),s=Object(r.useCallback)((function(e){i.current&&c(e)}),[c,i]);return Object(r.useEffect)((function(){return i.current=!0,function(){i.current=!1}}),[i]),[a,s]}function T(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=L({error:null,result:t,isLoading:!1,isSuccess:!1}),a=Object(j.a)(n,2),c=a[0],i=a[1],s=Object(r.useCallback)(Object(u.a)(l.a.mark((function e(){var t,n=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:null,e.prev=1,"function"!==typeof t){e.next=6;break}return e.next=5,t();case 5:t=e.sent;case 6:if(!(t instanceof Promise)){e.next=10;break}return e.next=9,t;case 9:t=e.sent;case 10:return console.log("error",t),e.abrupt("return",t);case 14:return e.prev=14,e.t0=e.catch(1),i((function(t){return Object(d.a)(Object(d.a)({},t),{},{error:e.t0.message})})),e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[1,14]])}))),[i]),o=Object(r.useCallback)(Object(u.a)(l.a.mark((function e(){var t,n,r=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:null,e.prev=1,n=null,"function"!==typeof t){e.next=9;break}return e.next=6,t();case 6:n=e.sent,e.next=12;break;case 9:return e.next=11,t;case 11:n=e.sent;case 12:return i((function(e){return Object(d.a)(Object(d.a)({},e),{},{result:n})})),e.abrupt("return",n);case 16:throw e.prev=16,e.t0=e.catch(1),e.t0;case 19:case"end":return e.stop()}}),e,null,[[1,16]])}))),[i]),b=Object(r.useRef)(null),f=Object(r.useCallback)(function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n=t instanceof Promise?t:Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))(),b.current=n,e.prev=3,i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!0,isSuccess:!1})})),e.next=7,n;case 7:return r=e.sent,i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!1,isSuccess:!0})})),console.log("error",r),e.abrupt("return",r);case 13:throw e.prev=13,e.t0=e.catch(3),b.current===n&&(b.current=null),i((function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!1,isSuccess:!1})})),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}(),[i,b]),h=Object(r.useCallback)(Object(u.a)(l.a.mark((function t(){var n,r=arguments;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==(n=r.length>0&&void 0!==r[0]?r[0]:null)&&(n=e),t.abrupt("return",s((function(){return f((function(){return o(n)}))})));case 3:case"end":return t.stop()}}),t)}))),[e,o,s,f]);return{isLoading:c.isLoading,result:c.result,error:c.error,isSuccess:c.isSuccess,isDisplayable:!c.isLoading&&!c.error,run:h,runError:s,runResult:o,runStatus:f,setError:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(d.a)(Object(d.a)({},t),{},{error:e instanceof Error?e.message:e})}))},setResult:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return i((function(t){return Object(d.a)(Object(d.a)({},t),{},{result:e})}))}}}function A(e){var t,n=e.children,a=T(v("/content-schema/models").list),c=Object(r.useContext)(g);return Object(r.useEffect)(a.run,[c.user]),Object(O.jsxs)(O.Fragment,{children:[a.isLoading&&Object(O.jsx)(w.a,{w:"100vw",h:"100vh",children:Object(O.jsx)(k.a,{})}),Object(O.jsxs)(C.a,{bg:"gray.100",minH:"100vh",w:"100%",overflow:"visible",children:[Object(O.jsxs)(C.a,{position:"fixed",left:0,px:3,w:"250px",top:0,minH:"100%",bg:"red.600",color:"white",children:[Object(O.jsx)(C.a,{fontSize:40,mb:6,w:"100%",textAlign:"center",children:Object(O.jsx)(p.b,{to:"/",children:"Phroper"})}),c.user&&Object(O.jsxs)(S.a,{mb:6,children:[Object(O.jsx)(M.a,{mr:4}),Object(O.jsxs)(S.c,{flex:1,alignItems:"flex-start",children:[Object(O.jsx)(D.a,{fontSize:20,children:c.user.username}),Object(O.jsx)(E.a,{variant:"link",colorScheme:"white",onClick:c.logout,children:"logout"})]})]}),a.isSuccess&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(D.a,{fontSize:24,mb:2,children:"Content types"}),Object(O.jsx)(S.c,{pl:4,alignItems:"flex-start",children:null===(t=a.result)||void 0===t?void 0:t.filter((function(e){return e.visible})).map((function(e){return Object(O.jsx)(p.b,{to:"/content-type/".concat(e.key),children:e.name},e.key)}))})]})]}),Object(O.jsx)(C.a,{ml:250,px:4,children:n})]})]})}n(279);var P=n(14),F=n(459),Y=n(486),H=n(97),z=n(460),_=n(461),I=n(30),R=n(61);function V(){return Object(O.jsx)(C.a,{pt:"10vh",children:Object(O.jsxs)(F.a,{minH:10,p:0,bgColor:"gray.200",children:[Object(O.jsx)(D.a,{fontSize:32,p:2,bg:"red.500",color:"white",mb:4,children:"Login"}),Object(O.jsx)(C.a,{p:4,children:Object(O.jsx)(q,{})})]})})}function q(){var e=Object(r.useContext)(g),t=Object(P.g)();return Object(O.jsx)(I.d,{validationSchema:R.d().shape({username:R.e().required("Username is required"),password:R.e().required("Password is required")}),initialValues:{username:"",password:""},onSubmit:function(){var n=Object(u.a)(l.a.mark((function n(r,a){var c,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a.setErrors,n.prev=1,n.next=4,e.login(r.username,r.password);case 4:for(i=t.location.state;i&&i.redirect&&"/login"===i.redirect.pathname;)i=i.redirect.state;i&&i.redirect?t.push(i.redirect.pathname,i.redirect.state):t.push("/"),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),c({password:n.t0.message});case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e,t){return n.apply(this,arguments)}}(),children:Object(O.jsx)(I.c,{children:Object(O.jsxs)(S.b,{spacing:4,children:[t.location.state&&t.location.state.error&&Object(O.jsxs)(Y.a,{status:"error",children:[Object(O.jsx)(Y.c,{}),Object(O.jsx)(Y.b,{children:t.location.state.error})]}),Object(O.jsxs)(H.a,{children:[Object(O.jsx)(z.a,{children:"Username"}),Object(O.jsx)(I.b,{as:_.a,bgColor:"white",type:"text",name:"username"}),Object(O.jsx)(I.a,{name:"username",component:D.a,color:"red"})]}),Object(O.jsxs)(H.a,{children:[Object(O.jsx)(z.a,{children:"Password"}),Object(O.jsx)(I.b,{as:_.a,bgColor:"white",type:"password",name:"password"}),Object(O.jsx)(I.a,{name:"password",component:D.a,color:"red"})]}),Object(O.jsx)(C.a,{textAlign:"right",pt:2,children:Object(O.jsx)(I.e,{children:function(e){var t=e.isSubmitting;return Object(O.jsx)(E.a,{isLoading:t,type:"submit",variant:"solid",colorScheme:"red",children:"Log in"})}})})]})})})}var B=a.a.createContext();function J(e){var t=e.children,n=T(v("/content-schema/models").list,null),a=Object(r.useContext)(g);return Object(r.useEffect)(n.run,[a.user]),Object(O.jsxs)(O.Fragment,{children:[n.isLoading&&Object(O.jsx)(w.a,{w:"100vw",h:"100vh",children:Object(O.jsx)(k.a,{})}),!n.isLoading&&Object(O.jsx)(B.Provider,{value:function(e){return n.result&&n.result.find((function(t){return t.key===e}))},children:t})]})}var N=n(480);var W=n(467),U=n(43),G=n(462),K=n(69);function Q(e){var t=e.message,n=e.children,r=e.onClick,c=e.acceptText,i=void 0===c?"Ok":c,s=e.cancelText,o=void 0===s?"Cancel":s,l=e.headerText,u=void 0===l?"":l,b=Object(U.a)(e,["message","children","onClick","acceptText","cancelText","headerText"]),f=a.a.useState(!1),h=Object(j.a)(f,2),p=h[0],m=h[1],x=function(){return m(!1)},v=a.a.useRef();return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(E.a,Object(d.a)(Object(d.a)({colorScheme:"red"},b),{},{onClick:function(){return m(!0)},children:n})),Object(O.jsx)(G.a,{isOpen:p,leastDestructiveRef:v,onClose:x,children:Object(O.jsx)(K.f,{children:Object(O.jsxs)(G.b,{children:[u&&Object(O.jsx)(K.e,{fontSize:"lg",fontWeight:"bold",children:u}),Object(O.jsx)(K.b,{children:t}),Object(O.jsx)(K.d,{children:Object(O.jsxs)(S.a,{w:"100%",justifyContent:"space-between",children:[Object(O.jsx)(E.a,{ref:v,onClick:x,children:o}),Object(O.jsx)(E.a,{colorScheme:"red",onClick:function(){x(),r&&r.apply(void 0,arguments)},ml:3,children:i})]})})]})})})]})}var X=n(474),Z=n(487);var $=n(233),ee=n.n($),te=(n(378),n(379),function(e){var t=e.onChange,n=e.isClearable,r=void 0!==n&&n,a=e.showPopperArrow,c=void 0!==a&&a,i=e.value,s=Object(U.a)(e,["onChange","isClearable","showPopperArrow","value"]);return Object(O.jsx)(C.a,{children:Object(O.jsx)(ee.a,Object(d.a)({type:"date",selected:"string"===typeof i?new Date(i):i,onChange:t,isClearable:r,showPopperArrow:c},s))})}),ne={date:"yyyy-MM-dd",datetime:"yyyy-MM-dd HH:mm",timestamp:"yyyy-MM-dd HH:mm:ss"};var re=Object(I.f)((function(e){var t=e.formik,n=e.schema,r=e.name,a=e.value;return Object(O.jsx)(te,{name:r,onChange:function(e){return t.setFieldValue(r,e)},timeFormat:"HH:mm",dateFormat:ne[n.type],showTimeSelect:"date"!==n.type,value:a})})),ae=n(17),ce=n(468),ie=n(469),se=n(470),oe=n(481);function le(e){var t=e.schema,n=e.isCreating,a=e.prefix;t=Object(r.useMemo)((function(){return t&&a?Object(d.a)(Object(d.a)({},t),{},{key:"".concat(a,".").concat(t.key)}):t}),[t,a]);var c=Object(r.useMemo)((function(){var e={};return Object.keys(t.fields).forEach((function(n){e[n]=a?Object(d.a)(Object(d.a)({},t.fields[n]),{},{key:"".concat(a,".").concat(t.fields[n].key)}):t.fields[n]})),e}),[t,a]);console.log("EmbeddedEditor",c);var i=t.grid||le.grid;return Object(O.jsx)(W.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(".concat(Math.min(2,i[0]),", 1fr)"),"2xl":"repeat(".concat(Math.min(3,i[0]),", 1fr)")},flex:1,gap:6,mb:6,children:Object.keys(c).map((function(e){return Object(O.jsx)(ue,{schema:c[e],isCreating:n},e)}))})}function ue(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=xe[e.schema.type])&&void 0!==t?t:xe.default;return n?Object(O.jsx)(n,Object(d.a)({},e)):null}function je(e){var t=e.formik,n=e.schema,r=(e.onChange,e.isCreating);console.log("EmbeddedSchemaArray",n);var a=n.key,c=t.values[a];return c=Array.isArray(c)?c:[],Object(O.jsxs)(C.a,{pl:3,borderLeft:"1px solid",borderColor:"red.500",children:[Object(O.jsx)(oe.a,{allowToggle:!0,children:c.map((function(e,i){return Object(O.jsxs)(oe.d,{children:[Object(O.jsx)("h2",{children:Object(O.jsxs)(oe.b,{children:[Object(O.jsxs)(S.a,{w:"100%",justify:"space-between",children:[Object(O.jsx)(C.a,{flex:"1",textAlign:"left",children:n.display&&e&&"object"===typeof e?e[n.display]:i+1}),Object(O.jsxs)(C.a,{mr:2,children:[Object(O.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object(ae.a)(c.slice(0,i-1)),[c[i],c[i-1]],Object(ae.a)(c.slice(i+1))))},colorScheme:"red",variant:"ghost",disabled:0===i,children:Object(O.jsx)(ce.a,{})}),Object(O.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object(ae.a)(c.slice(0,i)),Object(ae.a)(c.slice(i+1))))},colorScheme:"red",variant:"ghost",children:Object(O.jsx)(ie.a,{})}),Object(O.jsx)(E.a,{w:"1em",h:"1em",onClick:function(e){e.stopPropagation(),t.setFieldValue(a,[].concat(Object(ae.a)(c.slice(0,i)),[c[i+1],c[i]],Object(ae.a)(c.slice(i+2))))},colorScheme:"red",variant:"ghost",disabled:i===c.length-1,children:Object(O.jsx)(se.a,{})})]})]}),Object(O.jsx)(oe.c,{})]})}),Object(O.jsx)(oe.e,{pb:4,children:Object(O.jsx)(le,{schema:n,isCreating:r,prefix:"".concat(n.key,"[").concat(i,"]")})})]},i)}))}),Object(O.jsx)(E.a,{w:"100%",colorScheme:"red",variant:"ghost",fontSize:"3xl",onClick:function(){return t.setFieldValue("".concat(a,"[").concat(c.length,"]"),null)},children:"+"})]})}function de(e){var t=e.schema,n=e.isCreating;return Object(O.jsx)(C.a,{pl:3,flex:1,borderLeft:"1px solid",borderColor:"red.500",children:Object(O.jsx)(le,{schema:t,isCreating:n,prefix:t.key})})}le.grid=[3,1],je.grid=le.grid,de.grid=le.grid;var be=n(471);var fe=n(472),he=n(473);function pe(e){var t=e.name,n=e.value,a=e.onChange,c=Object(r.useState)(!1),i=Object(j.a)(c,2),s=i[0],o=i[1],d=v("/../api/file-upload"),b=T();Object(r.useEffect)((function(){var e=n&&"object"==typeof n?n.id:n;e?b.run(d.get(e)):b.setResult(null)}),[n]);var f=Object(r.useCallback)(function(){var e=Object(u.a)(l.a.mark((function e(n){var r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(n),n.preventDefault(),o(!1),!n.dataTransfer.items||1!==n.dataTransfer.items.length||"file"!==n.dataTransfer.items[0].kind){e.next=10;break}return(r=new FormData).append("file",n.dataTransfer.files[0]),e.next=8,b.run(d.send("upload",r,"POST",{"Content-Type":"multipart/form-data"}));case 8:c=e.sent,a&&a({target:{value:c.id,name:t}});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o,t,a,b,d]);return Object(O.jsx)(fe.a,{bg:"gray.800",borderRadius:4,overflow:"hidden",borderColor:"gray.500",ratio:16/9,children:Object(O.jsxs)(C.a,{children:[b.result&&b.result.filename&&Object(O.jsx)(w.a,{position:"absolute",h:"100%",w:"100%",children:Object(O.jsx)(he.a,{src:b.result.filename})}),Object(O.jsx)(I.a,{name:t,children:function(e){return Object(O.jsx)(C.a,{w:"100%",h:"100%",bg:"red.800",color:"white",p:4,children:e,position:"absolute"})}}),b.isLoading&&Object(O.jsx)(w.a,{position:"absolute",h:"100%",w:"100%",children:Object(O.jsx)(k.a,{size:"lg",color:"white"})}),s&&Object(O.jsx)(w.a,{position:"absolute",h:"100%",w:"100%",bg:s?"#88888866":null,children:Object(O.jsx)(ce.a,{color:"white",fontSize:100})}),Object(O.jsx)(C.a,{w:"100%",h:"100%",onDragOver:function(e){e.preventDefault(),o(!0)},onDragLeave:function(){return o(!1)},onDrop:f,position:"absolute",display:"flex",flexDir:"row-reverse",children:n&&Object(O.jsx)(C.b,{size:"1.75em",m:1.5,overflow:"hidden",children:Object(O.jsx)(E.a,{colorScheme:"red",onClick:function(){return a&&a({target:{value:null,name:t}})},children:Object(O.jsx)(ie.a,{})})})})]})})}pe.grid=[1,2];var Oe=n(482);function me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(I.f)((function(n){var r=n.schema,a=n.isCreating,c=Object(U.a)(n,["schema","isCreating"]),i=a?r.auto:r.readonly;if(r.auto&&r.readonly)return null;var s=r.grid&&(Array.isArray(r.grid)?r.grid:[r.grid,1])||e&&e.grid||[1,1];return e&&Object(O.jsx)(W.b,{colSpan:{sm:1,lg:Math.min(2,s[0]),"2xl":Math.min(3,s[0])},rowSpan:{sm:1,lg:Math.min(2,s[1]),"2xl":Math.min(3,s[1])},h:"100%",children:Object(O.jsxs)(H.a,{minW:"20%",h:"100%",display:"flex",flexDir:"column",children:[Object(O.jsx)(z.a,{children:r.name}),Object(O.jsx)(I.b,Object(d.a)(Object(d.a)({as:e,name:r.key,placeholder:r.name,disabled:i,schema:r,required:!i&&r.required&&(!r.private||a)},c),t||{}))]})})}))}var xe={default:me(_.a),email:me(_.a,{type:"email"}),password:me(_.a,{type:"password"}),textarea:me(X.a,{resize:"none"}),bool:me((function(e){var t=e.formik,n=e.name,r=Object(U.a)(e,["formik","name"]);return console.log("renderbool"),Object(O.jsx)(Z.a,Object(d.a)(Object(d.a)({size:"lg",colorScheme:"red"},r),{},{log:console.log(t),isChecked:t.values&&t.values[n],onChange:function(){return t.setFieldValue(n,!(t.values&&t.values[n]))}}))})),enum:me((function(e){var t=e.schema,n=(e.placeholder,Object(U.a)(e,["schema","placeholder"]));return Object(O.jsx)(be.a,Object(d.a)(Object(d.a)({},n),{},{children:t.values.map((function(e){return Object(O.jsx)("option",{value:e,children:e})}))}))})),relation_one:me((function(e){var t=e.schema,n=(e.placeholder,e.value),a=Object(U.a)(e,["schema","placeholder","value"]),c=Object(r.useContext)(B),i=Object(r.useMemo)((function(){return c(t.model)}),[c,t]),s=T(v("/content-manager/".concat(t.model).concat(n?"?".concat(i.primary,"_sort=").concat(n):"")).list);Object(r.useEffect)(s.run,[t]),n&&"object"===typeof n&&(n=n[t.primary]);var o=s.result,l=Object(r.useMemo)((function(){return i&&o&&Array.isArray(o)&&o.map((function(e){return Object(O.jsx)("option",{value:e[i.primary],children:e[i.display]},e[i.primary])}))}),[i,o]);return s.isLoading?Object(O.jsx)(Oe.a,{h:8}):Object(O.jsxs)(be.a,Object(d.a)(Object(d.a)({value:n||""},a),{},{children:[Object(O.jsx)("option",{value:"",children:"-"}),l]}))})),relation_many:!1,file:me(pe),file_multi:me((function(e){var t=e.formik,n=e.schema,r=(e.onChange,n.key);console.log(t);var a=t.values[r];return a=Array.isArray(a)?a:[],Object(O.jsx)(H.a,{minW:"20%",children:Object(O.jsx)(oe.a,{allowMultiple:!0,children:Object(O.jsxs)(oe.d,{children:[Object(O.jsx)("h2",{children:Object(O.jsx)(oe.b,{children:Object(O.jsx)(oe.c,{})})}),Object(O.jsxs)(oe.e,{pb:4,children:[Object(O.jsx)(W.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:a.map((function(e,n){return Object(O.jsx)(pe,{value:e,name:"".concat(r,"[").concat(n,"]"),onChange:function(e){return t.setFieldValue(e.target.name,e.target.value)}},n)}))}),Object(O.jsx)(E.a,{onClick:function(){return t.setFieldValue("".concat(r,"[").concat(a.length,"]"),null)},children:"New"})]})]})})})})),embedded_object:me(de),embedded_array:me(je),date:me(re),datetime:me(re),timestamp:me(re)};function ve(e){var t=e.schema,n=e.isCreating,r=e.contentHandler,a=e.contentApi,c=e.id,i=Object(P.g)();return Object(O.jsxs)(C.a,{p:4,bg:"white",flex:1,children:[Object(O.jsx)(W.a,{templateColumns:{sm:"repeat(1, 1fr)",lg:"repeat(2, 1fr)","2xl":"repeat(3, 1fr)"},flex:1,gap:6,mb:6,children:Object.keys(t.fields).map((function(e){return Object(O.jsx)(ge,{schema:t.fields[e],isCreating:n},e)}))}),Object(O.jsxs)(S.a,{w:"100%",justifyContent:"space-between",children:[!n&&Object(O.jsx)(Q,{type:"button",colorScheme:"red",headerText:"Deleting",message:"Are you sure? This action can not be undone!",onClick:function(){return r.run(Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.delete(c);case 2:i.goBack();case 3:case"end":return e.stop()}}),e)}))))},children:"Delete"}),Object(O.jsx)(E.a,{type:"submit",colorScheme:"green",children:"Save"})]})]})}function ge(e){var t;if(!1===e.schema.visible)return null;var n=null!==(t=xe[e.schema.type])&&void 0!==t?t:xe.default;return n?Object(O.jsx)(n,Object(d.a)({},e)):null}var ye=n(81),we=n.n(ye);function ke(e){var t=e.schema;return Object(O.jsxs)(C.a,{minW:"350px",p:4,bg:"white",children:[Object(O.jsx)(D.a,{fontWeight:"bold",fontSize:20,children:"Information"}),Object.keys(t.fields).map((function(e){return Object(O.jsx)(Ce,{schema:t.fields[e],name:t.fields[e].key},e)}))]})}var Ce=Object(I.f)((function(e){var t=e.name,n=(e.value,e.formik),r=e.schema,a=Object(U.a)(e,["name","value","formik","schema"]),c=n.values&&n.values[t];return r.auto&&r.readonly&&!1!==r.visible?Object(O.jsxs)(H.a,{children:[Object(O.jsx)(z.a,{children:r.name}),Object(O.jsx)(D.a,Object(d.a)(Object(d.a)({},a),{},{children:c&&"date"===r.type?we()(new Date(c)).format("YYYY-MM-DD"):c&&"datetime"===r.type||c&&"timestamp"===r.type?we()(new Date(c)).format("YYYY-MM-DD HH:mm:ss"):c&&"object"===typeof c?c[r.model_display]:null!=c?c:"-"}))]}):null}));function Se(e){var t=e.isCreating,n=e.schema,a=Object(P.h)(),c=a.model,i=a.id,s=Object(P.g)(),o=v("/content-manager/".concat(c)),l=Object(N.a)(),u=T((function(){return o.get(i)}),[]);Object(r.useEffect)((function(){u.error&&(l({title:"Server error",description:u.error,status:"error",duration:9e3,isClosable:!0}),u.setError(null))}),[u.error,u.resetError,l]),Object(r.useEffect)((function(){t||u.run()}),[t,i]);var j={isCreating:t,history:s,schema:n,id:i,contentHandler:u,contentApi:o};return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(C.a,{children:[Object(O.jsx)(D.a,{fontSize:40,mb:4,children:u.result&&!t?"".concat(u.result[n.display]," (").concat(n.name,")"):n.name}),Object(O.jsxs)(Me,Object(d.a)(Object(d.a)({},j),{},{children:[Object(O.jsx)(S.a,{mb:6,children:Object(O.jsx)(E.a,{colorScheme:"red",onClick:function(){return s.goBack()},variant:"link",children:"Back"})}),Object(O.jsxs)(S.b,{flex:1,direction:{sm:"column",xl:"row"},alignItems:{sm:"stretch",xl:"flex-start"},children:[Object(O.jsx)(ve,Object(d.a)({},j)),!t&&Object(O.jsx)(ke,Object(d.a)({},j))]})]}))]})})}function Me(e){var t=e.children,n=e.isCreating,a=e.schema,c=e.id,i=e.contentHandler,s=e.contentApi,o=Object(P.g)(),j=Object(r.useMemo)((function(){var e={};return Object.values(a.fields).forEach((function(t){null==t.default||t.auto||(e[t.key]=t.default)})),e}),[a]),d=function(e){if(!e)return null;var t={};return Object.keys(e.fields).forEach((function(n){var r=null;switch(e.fields[n].type){case"file_multi":r=R.a(R.b((function(e){switch(typeof e){case"object":return R.d({id:R.c().required()});default:return R.c().required()}})))}r&&(t[n]=r)})),R.d(t)}(a);return Object(O.jsx)(I.d,{initialValues:n?j:i.result,enableReinitialize:!0,validationSchema:d,onSubmit:function(){var e=Object(u.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,i.run(n?s.create(t):s.update(t,c));case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return");case 6:n&&o.replace("./"+r[a.primary]);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:(n||!i.isLoading)&&Object(O.jsx)(I.c,{children:t})},i.result&&i.result[a.primary])}var De=n(478),Ee=n(476),Le=n(477),Te=n(475);function Ae(e){var t=e.page,n=e.max,r=e.onSelect,a=e.colorScheme;t=parseInt(t);var c=n<10?n:10,i=t-c/2<0?0:t+c/2>n?n-c:t-c/2;return 1===n&&1===t?null:Object(O.jsxs)(S.a,{mx:"auto",justifyContent:"center",w:"100%",children:[Object(O.jsx)(Te.a,{colorScheme:a,icon:Object(O.jsx)(Ee.a,{}),variant:"ghost",onClick:function(){return r(1)},disabled:t<=1}),Array.apply(null,Array(c)).map((function(e,n){return Object(O.jsx)(E.a,{colorScheme:a,variant:n+i+1===t?"solid":"ghost",onClick:function(){return r(n+i+1)},children:n+i+1},n)})),Object(O.jsx)(Te.a,{colorScheme:a,icon:Object(O.jsx)(Le.a,{}),variant:"ghost",onClick:function(){return r(n)},disabled:t>=n})]})}var Pe={timestamp:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},datetime:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD HH:mm:ss"):"-"},date:function(e){return e?we()(new Date(e)).format("YYYY-MM-DD"):"-"},password:!1,relation_many:!1,file:!1,json:!1,bool:function(e){return e?"true":"false"},default:function(e,t){return e&&"object"===typeof e&&t.display?null!=e[t.display]?String(e[t.display]):"-":null==e?"-":String(e)},embedded_array:!1,file_multi:!1,relation_multi:!1};function Fe(e){var t=e.schema,n=Object(P.h)().model,a=Object(P.g)(),c=new URLSearchParams(a.location.search).get("page")||1,i=v("/content-manager/".concat(n)),s=Object(r.useState)(0),o=Object(j.a)(s,2),d=o[0],b=o[1],f=T(i.list,[]);Object(r.useEffect)((function(){Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.runError(f.runStatus(i.get("count")));case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:b(t),f.run(i.send("?_limit=100&_start=".concat(100*(c-1))));case 7:case"end":return e.stop()}}),e)})))()}),[c,t]);var h=Object(r.useMemo)((function(){return t&&t.listing&&Array.isArray(t.listing)?t.listing:t&&t.listing?[t.listing]:Object.keys(t.fields).filter((function(e){return!1!==Pe[t.fields[e].type]&&!t.fields[e].private&&t.fields[e].visible&&t.fields[e].listed}))}),[t]);return Object(O.jsxs)(C.a,{children:[Object(O.jsx)(D.a,{fontSize:40,mb:4,children:t.name}),Object(O.jsxs)(Oe.a,{isLoaded:!f.isLoading,children:[Object(O.jsx)(Ae,{page:c,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return a.push("?page="+e)}}),Object(O.jsx)(S.a,{mb:6,children:t.editable&&Object(O.jsx)(E.a,{colorScheme:"red","aria-label":"Search database",onClick:function(){return a.push(a.location.pathname+"/create")},variant:"link",children:"New"})}),Object(O.jsxs)(De.a,{mb:6,children:[Object(O.jsx)(De.e,{children:Object(O.jsx)(De.f,{children:h.map((function(e){return Object(O.jsx)(De.d,{children:e},e)}))})}),Object(O.jsx)(De.b,{children:f.result&&f.result.map((function(e,n){return Object(O.jsx)(De.f,{onClick:function(){return t.editable&&a.push(a.location.pathname+"/"+e[t.primary])},children:h.map((function(n){return Object(O.jsx)(De.c,{children:t.fields[n]&&(Pe[t.fields[n].type]||Pe.default)(e[n],t.fields[n])},n)}))},e[t.primary]||n)}))})]}),Object(O.jsx)(Ae,{page:c,max:Math.ceil(d/100)||1,colorScheme:"red",onSelect:function(e){return a.push("?page="+e)}})]})]})}function Ye(e){var t=e.match,n=Object(P.h)().model,a=Object(r.useContext)(B),c=Object(r.useMemo)((function(){return a(n)}),[a,n]);return c&&Object(O.jsxs)(P.d,{children:[Object(O.jsx)(P.b,{path:"".concat(t.path,"/create"),children:Object(O.jsx)(Se,{isCreating:!0,schema:c},c.key)}),Object(O.jsx)(P.b,{path:"".concat(t.path,"/:id"),children:Object(O.jsx)(Se,{isCreating:!1,schema:c},c.key)}),Object(O.jsx)(P.b,{path:t.path,exact:!0,children:Object(O.jsx)(Fe,{schema:c},c.key)})]})}function He(){var e=Object(r.useContext)(g);return Object(O.jsxs)(P.d,{children:[Object(O.jsx)(P.b,{path:"/login",component:V}),!e.user&&Object(O.jsx)(P.b,{children:Object(O.jsx)(P.a,{to:"/login"})}),Object(O.jsx)(P.b,{path:"/content-type/:model",component:Ye})]})}var ze=function(){return Object(O.jsx)(x,{children:Object(O.jsx)(s.a,{children:Object(O.jsx)(y,{children:Object(O.jsx)(J,{children:Object(O.jsx)(A,{children:Object(O.jsx)(He,{})})})})})})},_e=(n(437),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,488)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))});i.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(ze,{})}),document.getElementById("root")),_e()}},[[438,1,2]]]);
//# sourceMappingURL=main.41f79d63.chunk.js.map